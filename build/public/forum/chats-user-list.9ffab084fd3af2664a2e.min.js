"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[56227,99127,34271,1091,49897],{72513:(v,y,c)=>{var g,_;g=[c(49897)],_=function(u){const h={};let i=0;h.init=function(r,a){const s=a.find('[component="chat/user/list"]');if(!s.length)return;const l=a.find('[component="chat/messages/pinned/container"]');a.find('[component="chat/user/list/btn"]').on("click",()=>{s.toggleClass("hidden"),s.hasClass("hidden")?p():(l.addClass("hidden"),d(r,s))}),$(window).off("action:ajaxify.start",p).one("action:ajaxify.start",p),h.addInfiniteScrollHandler(r,s,async(f,t)=>{f.append(await app.parseAndTranslate("partials/chats/user-list","users",t))})};function d(r,a){i&&clearInterval(i),i=setInterval(()=>{m(r,a)},5e3)}function p(){i&&(clearInterval(i),i=0)}async function m(r,a){if(ajaxify.data.template.chats&&app.isFocused&&a.scrollTop()===0&&!a.hasClass("hidden")){const s=await u.get(`/chats/${r}/users`,{start:0});a.find('[data-bs-toggle="tooltip"]').tooltip("dispose"),a.html(await app.parseAndTranslate("partials/chats/user-list","users",s)),a.find('[data-bs-toggle="tooltip"]').tooltip()}}return h.addInfiniteScrollHandler=function(r,a,s){a.on("scroll",utils.debounce(async()=>{const l=(a[0].scrollHeight-a.height())*.85;if(a.scrollTop()>l){const f=a.find("[data-index]").last().attr("data-index"),t=await u.get(`/chats/${r}/users`,{start:parseInt(f,10)+1});t&&t.users.length&&s(a,t)}},200))},h.addSearchHandler=function(r,a,s){a.on("keyup",utils.debounce(async()=>{const l=a.val(),f=await u.get(`/search/chats/${r}/users`,{query:l});s(f)},200))},h}.apply(y,g),_!==void 0&&(v.exports=_)},49897:(v,y,c)=>{c.r(y),c.d(y,{del:()=>f,get:()=>m,head:()=>r,patch:()=>s,post:()=>a,put:()=>l});var g=c(91749),_=c.n(g),u=c(40027),h=c.n(u);const i=config.relative_path+"/api/v3";async function d(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:i+t.url,typeof n=="function"){p(t).then(e=>n(null,e),e=>n(e));return}try{return await p(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again.")return(0,u.confirm)("[[error:api.reauth-required]]",w=>{w&&ajaxify.go("login")});throw e}}async function p(t){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(n,t),{headers:w}=e,O=w.get("content-type"),x=O&&O.startsWith("application/json");let o;if(t.method!=="head"&&(x?o=await e.json():o=await e.text()),!e.ok)throw o?new Error(x?o.status.message:o):new Error(e.statusText);return x&&o&&o.hasOwnProperty("status")&&o.hasOwnProperty("response")?o.response:o}function m(t,n,e){return d({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function r(t,n,e){return d({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},e)}function a(t,n,e){return d({url:t,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function s(t,n,e){return d({url:t,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function l(t,n,e){return d({url:t,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function f(t,n,e){return d({url:t,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
