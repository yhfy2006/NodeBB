"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[77597,25285],{31799:(m,h,c)=>{var y,g;y=[c(22410),c(24962),c(96352),c(47682),c(43349),c(65348),c(91749),c(29930),c(49897)],g=function(p,u,d,C,f,e,a,s,t){const i={};$(window).on("action:ajaxify.start",function(o,l){String(l.url).startsWith("category/")||d.disable()}),i.init=function(){const o=ajaxify.data.cid;app.enterRoom("category_"+o),u.addShareHandlers(ajaxify.data.name),C.init("category",j),f.handleSort("categoryTopicSort","category/"+ajaxify.data.slug),config.usePagination?d.disable():d.init('[component="category/topic"]',ajaxify.data.topic_count,i.toTop,i.toBottom),r(),x(o),A(),e.init($('[component="category-selector"]'),{privilege:"find",parentCid:ajaxify.data.cid,onSelect:function(l){ajaxify.go("/category/"+l.cid)}}),a.fire("action:topics.loaded",{topics:ajaxify.data.topics}),a.fire("action:category.loaded",{cid:ajaxify.data.cid})};function r(){let o=ajaxify.data.topicIndex;o&&utils.isNumber(o)&&(o=Math.max(0,parseInt(o,10)),o&&window.location.search.indexOf("page=")===-1&&d.scrollToElement($('[component="category/topic"][data-index="'+o+'"]'),!0,0))}function x(o){$('[component="category/watching"], [component="category/tracking"], [component="category/ignoring"], [component="category/notwatching"]').on("click",function(){const n=$(this).attr("data-state");t.put(`/categories/${o}/watch`,{state:n},S=>{if(S)return s.error(S);$('[component="category/watching/menu"]').toggleClass("hidden",n!=="watching"),$('[component="category/watching/check"]').toggleClass("fa-check",n==="watching"),$('[component="category/tracking/menu"]').toggleClass("hidden",n!=="tracking"),$('[component="category/tracking/check"]').toggleClass("fa-check",n==="tracking"),$('[component="category/notwatching/menu"]').toggleClass("hidden",n!=="notwatching"),$('[component="category/notwatching/check"]').toggleClass("fa-check",n==="notwatching"),$('[component="category/ignoring/menu"]').toggleClass("hidden",n!=="ignoring"),$('[component="category/ignoring/check"]').toggleClass("fa-check",n==="ignoring"),s.success("[[category:"+n+".message]]")})})}function A(){$('[component="category/load-more-subcategories"]').on("click",async function(){const o=$(this),{categories:l}=await t.get(`/categories/${ajaxify.data.cid}/children?start=${ajaxify.data.nextSubCategoryStart}`);if(o.toggleClass("hidden",!l.length||l.length<ajaxify.data.subCategoriesPerPage),!!l.length)return app.parseAndTranslate("category","children",{children:l},function(n){n.find(".timeago").timeago(),$('[component="category/subcategory/container"]').append(n),ajaxify.data.nextSubCategoryStart+=ajaxify.data.subCategoriesPerPage,ajaxify.data.subCategoriesLeft-=l.length,o.toggleClass("hidden",ajaxify.data.subCategoriesLeft<=0).translateText("[[category:x-more-categories, "+ajaxify.data.subCategoriesLeft+"]]")}),!1})}i.toTop=function(){d.scrollTop(0)},i.toBottom=async()=>{const{count:o}=await t.get(`/categories/${ajaxify.data.category.cid}/count`);d.scrollBottom(o-1)};function j(o,l,n){n=n||function(){},a.fire("action:topics.loading");const S=utils.params();p.loadMore(`/categories/${ajaxify.data.cid}/topics`,{after:o,direction:l,query:S,categoryTopicSort:S.sort||config.categoryTopicSort},function(E,b){a.fire("action:topics.loaded",{topics:E.topics}),n(E,b)})}return i}.apply(h,y),g!==void 0&&(m.exports=g)},65348:(m,h,c)=>{var y,g;y=[c(96349),c(40027),c(91749),c(17459)],g=function(p,u,d,C){const f={};return f.init=function(e,a){if(!e||!e.length)return;a=a||{};const s=a.onSelect||function(){};a.states=a.states||["watching","tracking","notwatching","ignoring"],a.template=a.template||"partials/category/selector-dropdown-left",d.fire("action:category.selector.options",{el:e,options:a}),p.init(e,a);const t={el:e,selectedCategory:null};e.on("click","[data-cid]",function(){const r=$(this);return r.hasClass("disabled")?!1:(t.selectCategory(r.attr("data-cid")),s(t.selectedCategory))});let i=t.el.find('[component="category-selector-selected"]').html();return C.translate(i,r=>{i=r}),t.selectCategory=function(r){const x=t.el.find('[data-cid="'+r+'"]');t.selectedCategory={cid:r,name:x.attr("data-name")},x.length?t.el.find('[component="category-selector-selected"]').html(x.find('[component="category-markup"]').html()):t.el.find('[component="category-selector-selected"]').html(i)},t.getSelectedCategory=function(){return t.selectedCategory},t.getSelectedCid=function(){return t.selectedCategory?t.selectedCategory.cid:0},a.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(a.template,{selectedCategory:a.selectedCategory},function(r){t.el.find('[component="category-selector-selected"]').html(r.find('[component="category-selector-selected"]').html())}),t},f.modal=function(e){e=e||{},e.onSelect=e.onSelect||function(){},e.onSubmit=e.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:e.message},function(a){const s=u.dialog({title:e.title||"[[modules:composer.select-category]]",message:a,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:i}}}),t=f.init(s.find('[component="category-selector"]'),e);function i(r){return r.preventDefault(),t.selectedCategory&&(e.onSubmit(t.selectedCategory),s.modal("hide")),!1}e.openOnLoad&&s.on("shown.bs.modal",function(){s.find(".dropdown-toggle").dropdown("toggle")}),s.find("form").on("submit",i)})},f}.apply(h,y),g!==void 0&&(m.exports=g)},43349:(m,h,c)=>{var y,g;y=[c(52473)],g=function(p){const u={};return u.handleSort=function(d,C){const f=p.get("thread/sort");f.find("i").removeClass("fa-check");const e=utils.params().sort||config[d];f.find('a[data-sort="'+e+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a[data-sort]').on("click",'[component="thread/sort"] a[data-sort]',function(){const s=$(this).attr("data-sort"),t=utils.params();t.sort=s;const i=decodeURIComponent($.param(t));ajaxify.go(C+(i?"?"+i:""))})},u}.apply(h,y),g!==void 0&&(m.exports=g)}}]);
