"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[89034,99127,19992,34271,1091,26174,49897],{97014:(L,x,i)=>{var h,m;h=[i(91749),i(17459),i(64061)],m=function(d,y){const l={_capsState:!1};return l.init=function(){const o=$("#login-error-notify"),u=$("#login"),v=$("#login-form");u.on("click",async function(p){p.preventDefault();const w=$("#username").val(),C=$("#password").val();if(o.addClass("hidden").find("p").text(""),!w||!C){o.find("p").translateText("[[error:invalid-username-or-password]]"),o.removeClass("hidden");return}if(!u.hasClass("disabled")){u.addClass("disabled");try{if((await d.fire("filter:app.login",{username:w,password:C,cancel:!1})).cancel){u.removeClass("disabled");return}}catch(c){o.find("p").translateText(c.message),o.removeClass("hidden"),u.removeClass("disabled");return}d.fire("action:app.login"),v.ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},beforeSend:function(){app.flags._login=!0},success:function(c){d.fire("action:app.loggedIn",c);const E=utils.urlToLocation(c.next).pathname,e=utils.params({url:c.next});e.loggedin=!0,delete e.register;const t=decodeURIComponent($.param(e));window.location.href=E+"?"+t},error:function(c){let E=c.responseText;const e=c.responseJSON;c.status===403&&c.responseText==="Forbidden"?window.location.href=config.relative_path+"/login?error=csrf-invalid":e&&e.hasOwnProperty("banned_until")&&(E=e.banned_until?y.compile("error:user-banned-reason-until",new Date(e.banned_until).toLocaleString(),e.reason):"[[error:user-banned-reason, "+e.reason+"]]"),o.find("p").translateText(E),o.removeClass("hidden"),u.removeClass("disabled"),$("#password:focus").length&&$("#password").select()}})}}),l.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),$("#content #username").val()?$("#content #password").val("").focus():$("#content #username").focus(),$("#content #noscript").val("false")},l.capsLockCheck=(o,u)=>{const v=p=>{u.classList[p?"remove":"add"]("hidden"),u.parentNode.classList[p?"add":"remove"]("has-warning")};o&&(o.addEventListener("keyup",function(p){if(l._capsState&&p.key==="CapsLock"){v(!1),l._capsState=!l._capsState;return}l._capsState=p.getModifierState&&p.getModifierState("CapsLock"),v(l._capsState)}),l._capsState&&v(!0))},l}.apply(x,h),m!==void 0&&(L.exports=m)},10034:(L,x,i)=>{var h,m;h=[i(17459),i(13230),i(49897),i(40027),i(97014),i(7065),i(64061)],m=function(d,y,l,o,u,v){const p={};let w=!1;const C="";p.init=function(){const a=$("#username"),r=$("#password"),n=$("#password-confirm"),f=$("#register");D(),$("#content #noscript").val("false");const g=utils.params();g.token&&$("#token").val(g.token),a.on("keyup",function(){$("#yourUsername").text(this.value.length>0?y(this.value):"username")}),a.on("blur",function(){a.val().length&&c(a.val())}),r.on("blur",function(){r.val().length&&E(r.val(),n.val())}),n.on("blur",function(){n.val().length&&e(r.val(),n.val())});function A(S){w=!1,$('[aria-invalid="true"]').removeAttr("aria-invalid"),E(r.val(),n.val()),e(r.val(),n.val()),c(a.val(),S)}u.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),f.on("click",function(S){const P=$(this),b=$("#register-error-notify");b.addClass("hidden"),S.preventDefault(),A(function(){w||(P.addClass("disabled"),P.parents("form").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},success:function(_){if(P.removeClass("disabled"),!!_)if(_.next){const k=utils.urlToLocation(_.next).pathname,T=utils.params({url:_.next});T.registered=!0;const I=decodeURIComponent($.param(T));window.location.href=k+"?"+I}else _.message&&d.translate(_.message,function(k){o.alert(k),ajaxify.go("/")})},error:function(_){d.translate(_.responseText,config.defaultLang,function(k){_.status===403&&_.responseText==="Forbidden"?window.location.href=config.relative_path+"/register?error=csrf-invalid":(b.find("p").text(k),b.removeClass("hidden"),P.removeClass("disabled"))})}}))})}),$("#username").trigger("focus")};function c(a,r){r=r||function(){};const n=$("#username-notify");n.text("");const f=$("#username"),g=y(a);a.length<ajaxify.data.minimumUsernameLength||g.length<ajaxify.data.minimumUsernameLength?t(f,n,"[[error:username-too-short]]"):a.length>ajaxify.data.maximumUsernameLength?t(f,n,"[[error:username-too-long]]"):!utils.isUserNameValid(a)||!g?t(f,n,"[[error:invalid-username]]"):Promise.allSettled([l.head(`/users/bySlug/${g}`,{}),l.head(`/groups/${a}`,{})]).then(A=>{A.every(S=>S.status==="rejected")?s(f,n,C):t(f,n,"[[error:username-taken]]"),r()})}function E(a,r){const n=$("#password"),f=$("#password-notify"),g=$("#password-confirm-notify");f.text(""),g.text("");try{if(utils.assertPasswordValidity(a,v),a===$("#username").val())throw new Error("[[user:password-same-as-username]]");s(n,f,C)}catch(A){t(n,f,A.message)}a!==r&&r!==""&&t(n,g,"[[user:change-password-error-match]]")}function e(a,r){const n=$("#password-confirm"),f=$("#password-notify"),g=$("#password-confirm-notify");g.text(""),!(!a||f.hasClass("alert-error"))&&(a!==r?t(n,g,"[[user:change-password-error-match]]"):s(n,g,C))}function t(a,r,n){d.translate(n,function(f){a.attr("aria-invalid","true"),r.html(f),r.parent().removeClass("register-success").addClass("register-danger"),r.show()}),w=!0}function s(a,r,n){d.translate(n,function(f){a.removeAttr("aria-invalid"),r.html(f),r.parent().removeClass("register-danger").addClass("register-success"),r.show()})}function D(){if(!app.user.uid&&config.defaultLang!==config.userLang){const a=$('[component="register/local"]'),r=$('<input type="hidden" name="userLang" value="'+config.userLang+'" />');a.append(r)}}return p}.apply(x,h),m!==void 0&&(L.exports=m)},49897:(L,x,i)=>{i.r(x),i.d(x,{del:()=>E,get:()=>v,head:()=>p,patch:()=>C,post:()=>w,put:()=>c});var h=i(91749),m=i.n(h),d=i(40027),y=i.n(d);const l=config.relative_path+"/api/v3";async function o(e,t){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:l+e.url,typeof t=="function"){u(e).then(s=>t(null,s),s=>t(s));return}try{return await u(e)}catch(s){if(s.message==="A valid login session was not found. Please log in and try again.")return(0,d.confirm)("[[error:api.reauth-required]]",D=>{D&&ajaxify.go("login")});throw s}}async function u(e){const{url:t}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,h.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const s=await fetch(t,e),{headers:D}=s,a=D.get("content-type"),r=a&&a.startsWith("application/json");let n;if(e.method!=="head"&&(r?n=await s.json():n=await s.text()),!s.ok)throw n?new Error(r?n.status.message:n):new Error(s.statusText);return r&&n&&n.hasOwnProperty("status")&&n.hasOwnProperty("response")?n.response:n}function v(e,t,s){return o({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},s)}function p(e,t,s){return o({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},s)}function w(e,t,s){return o({url:e,method:"post",data:t,headers:{"x-csrf-token":config.csrf_token}},s)}function C(e,t,s){return o({url:e,method:"patch",data:t,headers:{"x-csrf-token":config.csrf_token}},s)}function c(e,t,s){return o({url:e,method:"put",data:t,headers:{"x-csrf-token":config.csrf_token}},s)}function E(e,t,s){return o({url:e,method:"delete",data:t,headers:{"x-csrf-token":config.csrf_token}},s)}},13230:(L,x,i)=>{var h,m,d;(function(y){m=[i(53050)],h=y,d=typeof h=="function"?h.apply(x,m):h,d!==void 0&&(L.exports=d)})(function(y){const l=y("[^\\p{L}\\s\\d\\-_]","g"),o=/[^\w\s\d\-_]/g,u=/^\s+|\s+$/g,v=/\s+/g,p=/-+/g,w=/-$/g,C=/^-/g,c=/^[\w\d\s.,\-@]+$/;return function(e,t){return e?(e=String(e).replace(u,""),c.test(e)?e=e.replace(o,"-"):e=y.replace(e,l,"-"),e=t?e:e.toLocaleLowerCase(),e=e.replace(v,"-"),e=e.replace(p,"-"),e=e.replace(w,""),e=e.replace(C,""),e):""}})}}]);
