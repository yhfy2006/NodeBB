"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[67109,99127,34271,69185,86198,1091,49897],{89067:(A,m,s)=>{var g,d;g=[s(65348)],d=function(p){const C={};return C.init=function(){app.enterRoom("categories"),p.init($('[component="category-selector"]'),{privilege:"find",onSelect:function(E){ajaxify.go("/category/"+E.cid)}})},C}.apply(m,g),d!==void 0&&(A.exports=d)},49897:(A,m,s)=>{s.r(m),s.d(m,{del:()=>l,get:()=>e,head:()=>c,patch:()=>a,post:()=>f,put:()=>h});var g=s(91749),d=s.n(g),p=s(40027),C=s.n(p);const E=config.relative_path+"/api/v3";async function u(t,r){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:E+t.url,typeof r=="function"){o(t).then(n=>r(null,n),n=>r(n));return}try{return await o(t)}catch(n){if(n.message==="A valid login session was not found. Please log in and try again.")return(0,p.confirm)("[[error:api.reauth-required]]",i=>{i&&ajaxify.go("login")});throw n}}async function o(t){const{url:r}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const n=await fetch(r,t),{headers:i}=n,w=i.get("content-type"),_=w&&w.startsWith("application/json");let y;if(t.method!=="head"&&(_?y=await n.json():y=await n.text()),!n.ok)throw y?new Error(_?y.status.message:y):new Error(n.statusText);return _&&y&&y.hasOwnProperty("status")&&y.hasOwnProperty("response")?y.response:y}function e(t,r,n){return u({url:t+(r&&Object.keys(r).length?"?"+$.param(r):"")},n)}function c(t,r,n){return u({url:t+(r&&Object.keys(r).length?"?"+$.param(r):""),method:"head"},n)}function f(t,r,n){return u({url:t,method:"post",data:r,headers:{"x-csrf-token":config.csrf_token}},n)}function a(t,r,n){return u({url:t,method:"patch",data:r,headers:{"x-csrf-token":config.csrf_token}},n)}function h(t,r,n){return u({url:t,method:"put",data:r,headers:{"x-csrf-token":config.csrf_token}},n)}function l(t,r,n){return u({url:t,method:"delete",data:r,headers:{"x-csrf-token":config.csrf_token}},n)}},96349:(A,m,s)=>{var g,d;g=[s(29930),s(89336),s(49897)],d=function(p,C,E){const u={};return u.init=function(o,e){let c=null;e=e||{},e.privilege=e.privilege||"topics:read",e.states=e.states||["watching","tracking","notwatching","ignoring"],e.cacheList=e.hasOwnProperty("cacheList")?e.cacheList:!0;let f=[];Array.isArray(e.localCategories)&&(f=e.localCategories.map(r=>({...r}))),e.selectedCids=e.selectedCids||ajaxify.data.selectedCids||[];const a=o.find('[component="category-selector-search"]');if(!a.length)return;const h=a.parent('[component="category/dropdown"]').length>0||a.parent('[component="category-selector"]').length>0;o.on("show.bs.dropdown",function(){h&&(o.find(".dropdown-toggle").css({visibility:"hidden"}),a.removeClass("hidden"),a.css({"z-index":o.find(".dropdown-toggle").css("z-index")+1}));function r(){const n=a.find("input").val();n.length>1||!n&&!c?l(n,function(i){c=e.cacheList&&(c||i),t(i)}):!n&&c&&t(c)}a.on("click",function(n){n.preventDefault(),n.stopPropagation()}),a.find("input").val("").on("keyup",utils.debounce(r,300)),r()}),o.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||a.find("input").focus()}),o.on("hide.bs.dropdown",function(){h&&(o.find(".dropdown-toggle").css({visibility:"inherit"}),a.addClass("hidden")),a.off("click"),a.find("input").off("keyup")});function l(r,n){E.get("/search/categories",{search:r,query:utils.params(),parentCid:e.parentCid||0,selectedCids:e.selectedCids,privilege:e.privilege,states:e.states,showLinks:e.showLinks},function(i,{categories:w}){if(i)return p.error(i);n(f.concat(w))})}function t(r){const n=e.selectedCids.map(String);r.forEach(function(i){i.selected=n.includes(String(i.cid))}),app.parseAndTranslate(e.template,{categoryItems:r.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(i){o.find('[component="category/list"]').html(i.find('[component="category/list"]').html()),o.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!r.length);const w=C.Dropdown.getInstance(o.find(".dropdown-toggle").get(0));w&&w.update()})}},u}.apply(m,g),d!==void 0&&(A.exports=d)},65348:(A,m,s)=>{var g,d;g=[s(96349),s(40027),s(91749),s(17459)],d=function(p,C,E,u){const o={};return o.init=function(e,c){if(!e||!e.length)return;c=c||{};const f=c.onSelect||function(){};c.states=c.states||["watching","tracking","notwatching","ignoring"],c.template=c.template||"partials/category/selector-dropdown-left",E.fire("action:category.selector.options",{el:e,options:c}),p.init(e,c);const a={el:e,selectedCategory:null};e.on("click","[data-cid]",function(){const l=$(this);return l.hasClass("disabled")?!1:(a.selectCategory(l.attr("data-cid")),f(a.selectedCategory))});let h=a.el.find('[component="category-selector-selected"]').html();return u.translate(h,l=>{h=l}),a.selectCategory=function(l){const t=a.el.find('[data-cid="'+l+'"]');a.selectedCategory={cid:l,name:t.attr("data-name")},t.length?a.el.find('[component="category-selector-selected"]').html(t.find('[component="category-markup"]').html()):a.el.find('[component="category-selector-selected"]').html(h)},a.getSelectedCategory=function(){return a.selectedCategory},a.getSelectedCid=function(){return a.selectedCategory?a.selectedCategory.cid:0},c.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(c.template,{selectedCategory:c.selectedCategory},function(l){a.el.find('[component="category-selector-selected"]').html(l.find('[component="category-selector-selected"]').html())}),a},o.modal=function(e){e=e||{},e.onSelect=e.onSelect||function(){},e.onSubmit=e.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:e.message},function(c){const f=C.dialog({title:e.title||"[[modules:composer.select-category]]",message:c,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:h}}}),a=o.init(f.find('[component="category-selector"]'),e);function h(l){return l.preventDefault(),a.selectedCategory&&(e.onSubmit(a.selectedCategory),f.modal("hide")),!1}e.openOnLoad&&f.on("shown.bs.modal",function(){f.find(".dropdown-toggle").dropdown("toggle")}),f.find("form").on("submit",h)})},o}.apply(m,g),d!==void 0&&(A.exports=d)}}]);
