"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[19992],{97014:(m,g,c)=>{var f,l;f=[c(91749),c(17459),c(64061)],l=function(d,h){const n={_capsState:!1};return n.init=function(){const s=$("#login-error-notify"),a=$("#login"),r=$("#login-form");a.on("click",async function(o){o.preventDefault();const p=$("#username").val(),u=$("#password").val();if(s.addClass("hidden").find("p").text(""),!p||!u){s.find("p").translateText("[[error:invalid-username-or-password]]"),s.removeClass("hidden");return}if(!a.hasClass("disabled")){a.addClass("disabled");try{if((await d.fire("filter:app.login",{username:p,password:u,cancel:!1})).cancel){a.removeClass("disabled");return}}catch(e){s.find("p").translateText(e.message),s.removeClass("hidden"),a.removeClass("disabled");return}d.fire("action:app.login"),r.ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},beforeSend:function(){app.flags._login=!0},success:function(e){d.fire("action:app.loggedIn",e);const i=utils.urlToLocation(e.next).pathname,t=utils.params({url:e.next});t.loggedin=!0,delete t.register;const v=decodeURIComponent($.param(t));window.location.href=i+"?"+v},error:function(e){let i=e.responseText;const t=e.responseJSON;e.status===403&&e.responseText==="Forbidden"?window.location.href=config.relative_path+"/login?error=csrf-invalid":t&&t.hasOwnProperty("banned_until")&&(i=t.banned_until?h.compile("error:user-banned-reason-until",new Date(t.banned_until).toLocaleString(),t.reason):"[[error:user-banned-reason, "+t.reason+"]]"),s.find("p").translateText(i),s.removeClass("hidden"),a.removeClass("disabled"),$("#password:focus").length&&$("#password").select()}})}}),n.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),$("#content #username").val()?$("#content #password").val("").focus():$("#content #username").focus(),$("#content #noscript").val("false")},n.capsLockCheck=(s,a)=>{const r=o=>{a.classList[o?"remove":"add"]("hidden"),a.parentNode.classList[o?"add":"remove"]("has-warning")};s&&(s.addEventListener("keyup",function(o){if(n._capsState&&o.key==="CapsLock"){r(!1),n._capsState=!n._capsState;return}n._capsState=o.getModifierState&&o.getModifierState("CapsLock"),r(n._capsState)}),n._capsState&&r(!0))},n}.apply(g,f),l!==void 0&&(m.exports=l)}}]);
