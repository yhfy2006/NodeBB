"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[45490,99127,82858,34271,1091,49897],{37130:(T,y,i)=>{var g,m;g=[i(22410),i(81335),i(49897),i(40027),i(29930)],m=function(E,w,x,l,h){const c={};return c.init=function(){E.init(c.loadMoreGroups),$('button[data-action="new"]').on("click",function(){l.prompt("[[groups:new-group.group-name]]",function(n){n&&n.length&&x.post("/groups",{name:n}).then(f=>{ajaxify.go("groups/"+f.slug)}).catch(h.error)})});const a=utils.params();$("#search-sort").val(a.sort||"alpha"),$("#search-text").on("keyup",c.search),$("#search-button").on("click",c.search),$("#search-sort").on("change",function(){ajaxify.go("groups?sort="+$("#search-sort").val())})},c.loadMoreGroups=function(a){a<0||E.loadMore("/groups",{sort:$("#search-sort").val(),after:$('[component="groups/container"]').attr("data-nextstart")},function(n,f){n&&n.groups.length?w.render("partials/groups/list",{groups:n.groups}).then(function(p){$("#groups-list").append(p),f()}):f(),n&&n.nextStart&&$('[component="groups/container"]').attr("data-nextstart",n.nextStart)})},c.search=function(){const a=$("#groups-list"),n=$("#search-text"),f=$("#search-sort");return socket.emit("groups.search",{query:n.val(),options:{sort:f.val(),filterHidden:!0,showMembers:!0,hideEphemeralGroups:!0}},function(p,v){if(p)return h.error(p);v=v.filter(function(t){return t.name!=="registered-users"&&t.name!=="guests"}),w.render("partials/groups/list",{groups:v}).then(function(t){a.empty().append(t)})}),!1},c}.apply(y,g),m!==void 0&&(T.exports=m)},22410:(T,y,i)=>{var g,m;g=[i(91749),i(29930),i(49897)],m=function(E,w,x){const l={};let h,c=0,a=!1,n,f=0;l.init=function(t,o){const e=$("body");typeof t=="function"?(h=t,n=e):(h=o,n=t||e),c=$(window).scrollTop(),$(window).off("scroll",p).on("scroll",p),e.height()<=$(window).height()&&h(1)};function p(){f&&clearTimeout(f),f=setTimeout(function(){f=0,v()},60)}function v(){const t=utils.findBootstrapEnvironment(),o=(t==="xs"||t==="sm")&&$("html").hasClass("composing");if(a||o||app.flags._glance)return;const e=$(window).scrollTop(),r=$(window).height(),u=n.height()-r,d=n.offset()?n.offset().top:0,s=100*(e-d)/(u<=0?r:u),M=15,A=85,D=e>c?1:-1;(s<M&&e<c||s>A&&e>c||s<0&&D>0&&u<0)&&h(D),c=e}return l.loadMore=function(t,o,e){if(a)return;a=!0;const r={method:t,data:o};E.fire("action:infinitescroll.loadmore",r),(r.method.startsWith("/")?x.get:socket.emit)(r.method,r.data,function(d,s){if(d)return a=!1,w.error(d);e(s,function(){a=!1})})},l.loadMoreXhr=function(t,o){if(a)return;a=!0;const e=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),r={url:e,data:t};E.fire("action:infinitescroll.loadmore.xhr",r),$.get(e,t,function(u){o(u,function(){a=!1})}).fail(function(u){a=!1,w.error(String(u.responseJSON||"[[error:no-connection]]"))})},l.removeExtra=function(t,o,e){let r=$();if(t.length<=e)return r;const u=t.length-e;if(o>0){const d=$(document).height(),s=$(window).scrollTop();r=t.slice(0,u).remove(),$(window).scrollTop(s+($(document).height()-d))}else r=t.slice(t.length-u).remove();return r},l}.apply(y,g),m!==void 0&&(T.exports=m)},49897:(T,y,i)=>{i.r(y),i.d(y,{del:()=>v,get:()=>c,head:()=>a,patch:()=>f,post:()=>n,put:()=>p});var g=i(91749),m=i.n(g),E=i(40027),w=i.n(E);const x=config.relative_path+"/api/v3";async function l(t,o){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:x+t.url,typeof o=="function"){h(t).then(e=>o(null,e),e=>o(e));return}try{return await h(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again.")return(0,E.confirm)("[[error:api.reauth-required]]",r=>{r&&ajaxify.go("login")});throw e}}async function h(t){const{url:o}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(o,t),{headers:r}=e,u=r.get("content-type"),d=u&&u.startsWith("application/json");let s;if(t.method!=="head"&&(d?s=await e.json():s=await e.text()),!e.ok)throw s?new Error(d?s.status.message:s):new Error(e.statusText);return d&&s&&s.hasOwnProperty("status")&&s.hasOwnProperty("response")?s.response:s}function c(t,o,e){return l({url:t+(o&&Object.keys(o).length?"?"+$.param(o):"")},e)}function a(t,o,e){return l({url:t+(o&&Object.keys(o).length?"?"+$.param(o):""),method:"head"},e)}function n(t,o,e){return l({url:t,method:"post",data:o,headers:{"x-csrf-token":config.csrf_token}},e)}function f(t,o,e){return l({url:t,method:"patch",data:o,headers:{"x-csrf-token":config.csrf_token}},e)}function p(t,o,e){return l({url:t,method:"put",data:o,headers:{"x-csrf-token":config.csrf_token}},e)}function v(t,o,e){return l({url:t,method:"delete",data:o,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
