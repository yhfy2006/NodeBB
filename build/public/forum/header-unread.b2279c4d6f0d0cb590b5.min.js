"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[68326],{19046:(f,l,w)=>{var c,u;c=[w(91749)],u=function(h){const s={},g={ignoring:1,notwatching:2,watching:3};s.initUnreadTopics=function(){const e=app.user.unreadData;function t(i){if(i&&i.posts&&i.posts.length&&e){const a=i.posts[0];if(parseInt(a.uid,10)===parseInt(app.user.uid,10)||!a.topic.isFollowing&&a.categoryWatchState!==g.watching)return;const n=a.topic.tid;(!e[""][n]||!e.new[n]||!e.watched[n]||!e.unreplied[n])&&d(n),e[""][n]||(o(""),e[""][n]=!0),a.isMain&&parseInt(a.uid,10)!==parseInt(app.user.uid,10)&&!e.new[n]&&(o("new"),e.new[n]=!0),parseInt(a.topic.postcount,10)<=1&&!e.unreplied[n]&&(o("unreplied"),e.unreplied[n]=!0),a.topic.isFollowing&&!e.watched[n]&&(o("watched"),e.watched[n]=!0)}}function o(i){const a="/unread"+(i?"?filter="+i:""),n=1+parseInt($('a[href="'+config.relative_path+a+'"].navigation-link i').attr("data-content"),10);r(a,n)}function d(i){$('[data-tid="'+i+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(){ajaxify.data.template.topic&&["","new","watched","unreplied"].forEach(function(i){delete e[i][ajaxify.data.tid]})}),socket.removeListener("event:new_post",t),socket.on("event:new_post",t),socket.removeListener("event:unread.updateCount",p),socket.on("event:unread.updateCount",p)};function p(e){r("/unread",e.unreadTopicCount),r("/unread?filter=new",e.unreadNewTopicCount),r("/unread?filter=watched",e.unreadWatchedTopicCount),r("/unread?filter=unreplied",e.unreadUnrepliedTopicCount)}function r(e,t){if(!utils.isNumber(t))return;t=Math.max(0,t);const o=t>99?"99+":t,d=$('a[href="'+config.relative_path+e+'"].navigation-link');d.find("i").toggleClass("unread-count",t>0).attr("data-content",o),d.find('[component="navigation/count"]').toggleClass("hidden",t<=0).text(t),$('#mobile-menu [data-unread-url="'+e+'"]').attr("data-content",o),$('[component="unread/count"][data-unread-url="'+e+'"]').toggleClass("hidden",t<=0).text(o),h.fire("action:unread.updateCount",{url:e,count:t})}return s.updateUnreadTopicCount=r,s}.apply(l,c),u!==void 0&&(f.exports=u)}}]);
