"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[63154,99127,34271,1091,49897],{34342:(D,g,i)=>{var f,m;f=[i(52473),i(17459),i(49897),i(91749),i(40027),i(29930),i(89336)],m=function(d,O,v,c,E,h,p){const l={};let u={};l.addVoteHandler=function(){u={},d.get("topic").on("mouseenter",'[data-pid] [component="post/vote-count"]',T),d.get("topic").on("mouseleave",'[data-pid] [component="post/vote-count"]',y)};function y(){const n=$(this),t=n.parents("[data-pid]").attr("data-pid"),r=p.Tooltip.getInstance(this);r&&(r.dispose(),n.attr("title","")),u[t]=!1}function T(){const n=$(this),r=n.parent().parents("[data-pid]").attr("data-pid");u[r]=!0;const o=p.Tooltip.getInstance(this);o&&(o.dispose(),n.attr("title","")),socket.emit("posts.getUpvoters",[r],function(s,a){if(s)return h.error(s);u[r]&&a.length&&e(n,a[0])})}function e(n,t){function r(s){n.attr("title",s),new p.Tooltip(n,{container:"#content",html:!0}).show()}let o=t.usernames.filter(s=>s!=="[[global:former-user]]");o.length&&(o.length+t.otherCount>t.cutoff?(o=o.join(", ").replace(/,/g,"|"),O.translate("[[topic:users-and-others, "+o+", "+t.otherCount+"]]",function(s){s=s.replace(/\|/g,","),r(s)})):(o=o.join(", "),r(o)))}return l.toggleVote=function(n,t,r){const o=n.closest("[data-pid]"),a=o.find(t).length?"del":"put",A=o.attr("data-pid");return v[a](`/posts/${A}/vote`,{delta:r},function(P){if(P){if(!app.user.uid){ajaxify.go("login");return}return h.error(P)}c.fire("action:post.toggleVote",{pid:A,delta:r,unvote:a==="del"})}),!1},l.showVotes=function(n){socket.emit("posts.getVoters",{pid:n,cid:ajaxify.data.cid},function(t,r){if(t)return t.message==="[[error:no-privileges]]"?void 0:h.error(t);app.parseAndTranslate("modals/votes",r,function(o){const s=E.dialog({title:"[[global:voters]]",message:o,className:"vote-modal",show:!0,onEscape:!0,backdrop:!0});s.on("click",function(){s.modal("hide")})})})},l}.apply(g,f),m!==void 0&&(D.exports=m)},49897:(D,g,i)=>{i.r(g),i.d(g,{del:()=>T,get:()=>h,head:()=>p,patch:()=>u,post:()=>l,put:()=>y});var f=i(91749),m=i.n(f),d=i(40027),O=i.n(d);const v=config.relative_path+"/api/v3";async function c(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:v+e.url,typeof n=="function"){E(e).then(t=>n(null,t),t=>n(t));return}try{return await E(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again.")return(0,d.confirm)("[[error:api.reauth-required]]",r=>{r&&ajaxify.go("login")});throw t}}async function E(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,f.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const t=await fetch(n,e),{headers:r}=t,o=r.get("content-type"),s=o&&o.startsWith("application/json");let a;if(e.method!=="head"&&(s?a=await t.json():a=await t.text()),!t.ok)throw a?new Error(s?a.status.message:a):new Error(t.statusText);return s&&a&&a.hasOwnProperty("status")&&a.hasOwnProperty("response")?a.response:a}function h(e,n,t){return c({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},t)}function p(e,n,t){return c({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},t)}function l(e,n,t){return c({url:e,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function u(e,n,t){return c({url:e,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function y(e,n,t){return c({url:e,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function T(e,n,t){return c({url:e,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}}}]);
