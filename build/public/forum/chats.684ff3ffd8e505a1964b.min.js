"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[61462,99127,56418,34271,1091,49897,26832],{26832:(A,l,o)=>{var f,u;f=[o(29930),o(49897),o(92619)],u=function(d,P,m){const s={};s.init=function(){Promise.all([o.e(6411),o.e(54516),o.e(60419),o.e(16255)]).then(function(){var r=[o(38636)];(function(i){$('[component="chat/nav-wrapper"]').on("click",'[component="chat/recent/room"], [component="chat/public/room"]',function(a){a.stopPropagation(),a.preventDefault();const h=this.getAttribute("data-roomid");i.switchChat(h)}).on("click",".mark-read",function(a){a.stopPropagation();const h=this.closest("[data-roomid]");m.toggleReadState(h)}),$('[component="chat/recent"]').on("scroll",utils.debounce(function(){const a=$(this),h=(a[0].scrollHeight-a.height())*.9;a.scrollTop()>h&&g()},100))}).apply(null,r)}).catch(o.oe)};async function g(){const r=$('[component="chat/recent"]');r.attr("loading")||(r.attr("loading",1),P.get("/chats",{uid:ajaxify.data.uid,after:r.attr("data-nextstart")}).then(({rooms:i,nextStart:a})=>{i.length?p({rooms:i,nextStart:a},function(){r.removeAttr("loading"),r.attr("data-nextstart",a)}):r.removeAttr("loading")}).catch(d.error))}function p(r,i){if(!r.rooms.length)return i();r.loadingMore=!0,app.parseAndTranslate("chats","rooms",r,function(a){$('[component="chat/recent"]').append(a),a.find(".timeago").timeago(),i()})}return s}.apply(l,f),u!==void 0&&(A.exports=u)},49897:(A,l,o)=>{o.r(l),o.d(l,{del:()=>v,get:()=>p,head:()=>r,patch:()=>a,post:()=>i,put:()=>h});var f=o(91749),u=o.n(f),d=o(40027),P=o.n(d);const m=config.relative_path+"/api/v3";async function s(t,e){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:m+t.url,typeof e=="function"){g(t).then(n=>e(null,n),n=>e(n));return}try{return await g(t)}catch(n){if(n.message==="A valid login session was not found. Please log in and try again.")return(0,d.confirm)("[[error:api.reauth-required]]",E=>{E&&ajaxify.go("login")});throw n}}async function g(t){const{url:e}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,f.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const n=await fetch(e,t),{headers:E}=n,D=E.get("content-type"),y=D&&D.startsWith("application/json");let c;if(t.method!=="head"&&(y?c=await n.json():c=await n.text()),!n.ok)throw c?new Error(y?c.status.message:c):new Error(n.statusText);return y&&c&&c.hasOwnProperty("status")&&c.hasOwnProperty("response")?c.response:c}function p(t,e,n){return s({url:t+(e&&Object.keys(e).length?"?"+$.param(e):"")},n)}function r(t,e,n){return s({url:t+(e&&Object.keys(e).length?"?"+$.param(e):""),method:"head"},n)}function i(t,e,n){return s({url:t,method:"post",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function a(t,e,n){return s({url:t,method:"patch",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function h(t,e,n){return s({url:t,method:"put",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function v(t,e,n){return s({url:t,method:"delete",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}}}]);
