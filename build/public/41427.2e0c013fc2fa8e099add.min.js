"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[41427,61861,99127,34590,13201,98813,68326,87549,34271,1091,25432,15794,92717,87212,33069,49897],{86174:(E,w,l)=>{var g,d;g=[l(19046),l(71949),l(11599),l(29930)],d=function(m,p,a,u){const v={};v.prepareDOM=function(){app.user.uid>0&&m.initUnreadTopics(),p.prepareDOM(),a.prepareDOM(),c(),h(),y()};function c(){$('[component="header/usercontrol"] [data-status]').off("click").on("click",function(n){const s=$(this).attr("data-status");socket.emit("user.setStatus",s,function(i){if(i)return u.error(i);$('[data-uid="'+app.user.uid+'"] [component="user/status"], [component="header/profilelink"] [component="user/status"]').removeClass("away online dnd offline").addClass(s),$('[component="header/usercontrol"] [data-status]').each(function(){$(this).toggleClass("selected",$(this).attr("data-status")===s)}),app.user.status=s}),n.preventDefault()})}function h(){const n=utils.findBootstrapEnvironment();n==="xs"||n==="sm"||utils.isTouchDevice()||$("#header-menu #main-nav").tooltip({selector:".nav-item",placement:"bottom",trigger:"hover",container:"body",animation:!1})}function y(){$("body").on("click",'[component="user/logout"]',function(){return l.e(20739).then(function(){var n=[l(75427)];(function(s){s()}).apply(null,n)}).catch(l.oe),!1})}return v}.apply(w,g),d!==void 0&&(E.exports=d)},11599:(E,w,l)=>{var g,d;g=[l(52473),l(91749),l(49897)],d=function(m,p,a){const u={};u.prepareDOM=function(){const n=$('[component="chat/dropdown"]');n.length&&(n.on("show.bs.dropdown",s=>{y("loadChatsDropdown",$(s.target).parent().find('[component="chat/list"]'))}),n.each((s,i)=>{const t=$(i).parent().find(".dropdown-menu");t.hasClass("show")&&y("loadChatsDropdown",t.find('[component="chat/list"]'))}),socket.removeListener("event:chats.receive",v),socket.on("event:chats.receive",v),socket.removeListener("event:chats.typing",c),socket.on("event:chats.typing",c),socket.removeListener("event:chats.roomRename",h),socket.on("event:chats.roomRename",h),socket.on("event:unread.updateChatCount",async function(s){if(s){const[f,S]=await app.require(["chat","forum/chats"]);if(f.isFromBlockedUser(s.fromUid)||f.isLookingAtRoom(s.roomId)||app.user.uid===parseInt(s.fromUid,10))return;S.markChatPageElUnread(s)}let{count:i}=await a.get("/chats/unread");const t=m.get("chat/icon");i=Math.max(0,i),t.toggleClass("fa-comment",i>0).toggleClass("fa-comment-o",i<=0);const r=i>99?"99+":i;m.get("chat/icon").toggleClass("unread-count",i>0).attr("data-content",r),m.get("chat/count").toggleClass("hidden",i<=0).text(r),p.fire("action:chat.updateCount",{count:i})}))};function v(n){y("onChatMessageReceived",n)}function c(n){y("onUserTyping",n)}function h(n){y("onRoomRename",n)}async function y(n,s){(await app.require("chat"))[n](s)}return u}.apply(w,g),d!==void 0&&(E.exports=d)},71949:(E,w,l)=>{var g;g=function(){const d={};d.prepareDOM=function(){const u=$('[component="notifications"] [data-bs-toggle="dropdown"]');u.length&&(u.on("show.bs.dropdown",v=>{a("loadNotifications",$(v.target).parent().find('[component="notifications/list"]'))}),u.each((v,c)=>{const h=$(c).parent().find(".dropdown-menu");h.hasClass("show")&&a("loadNotifications",h.find('[component="notifications/list"]'))}),socket.removeListener("event:new_notification",m),socket.on("event:new_notification",m),socket.removeListener("event:notifications.updateCount",p),socket.on("event:notifications.updateCount",p))};function m(u){a("onNewNotification",u)}function p(u){a("updateNotifCount",u)}function a(u,v){Promise.all([l.e(65928),l.e(81307)]).then(function(){var c=[l(36849)];(function(h){h[u](v)}).apply(null,c)}).catch(l.oe)}return d}.call(w,l,w,E),g!==void 0&&(E.exports=g)},19046:(E,w,l)=>{var g,d;g=[l(91749)],d=function(m){const p={},a={ignoring:1,notwatching:2,watching:3};p.initUnreadTopics=function(){const c=app.user.unreadData;function h(s){if(s&&s.posts&&s.posts.length&&c){const i=s.posts[0];if(parseInt(i.uid,10)===parseInt(app.user.uid,10)||!i.topic.isFollowing&&i.categoryWatchState!==a.watching)return;const t=i.topic.tid;(!c[""][t]||!c.new[t]||!c.watched[t]||!c.unreplied[t])&&n(t),c[""][t]||(y(""),c[""][t]=!0),i.isMain&&parseInt(i.uid,10)!==parseInt(app.user.uid,10)&&!c.new[t]&&(y("new"),c.new[t]=!0),parseInt(i.topic.postcount,10)<=1&&!c.unreplied[t]&&(y("unreplied"),c.unreplied[t]=!0),i.topic.isFollowing&&!c.watched[t]&&(y("watched"),c.watched[t]=!0)}}function y(s){const i="/unread"+(s?"?filter="+s:""),t=1+parseInt($('a[href="'+config.relative_path+i+'"].navigation-link i').attr("data-content"),10);v(i,t)}function n(s){$('[data-tid="'+s+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(){ajaxify.data.template.topic&&["","new","watched","unreplied"].forEach(function(s){delete c[s][ajaxify.data.tid]})}),socket.removeListener("event:new_post",h),socket.on("event:new_post",h),socket.removeListener("event:unread.updateCount",u),socket.on("event:unread.updateCount",u)};function u(c){v("/unread",c.unreadTopicCount),v("/unread?filter=new",c.unreadNewTopicCount),v("/unread?filter=watched",c.unreadWatchedTopicCount),v("/unread?filter=unreplied",c.unreadUnrepliedTopicCount)}function v(c,h){if(!utils.isNumber(h))return;h=Math.max(0,h);const y=h>99?"99+":h,n=$('a[href="'+config.relative_path+c+'"].navigation-link');n.find("i").toggleClass("unread-count",h>0).attr("data-content",y),n.find('[component="navigation/count"]').toggleClass("hidden",h<=0).text(h),$('#mobile-menu [data-unread-url="'+c+'"]').attr("data-content",y),$('[component="unread/count"][data-unread-url="'+c+'"]').toggleClass("hidden",h<=0).text(y),m.fire("action:unread.updateCount",{url:c,count:h})}return p.updateUnreadTopicCount=v,p}.apply(w,g),d!==void 0&&(E.exports=d)},25967:(E,w,l)=>{var g,d;g=[l(40027)],d=function(m){const p={};return p.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return m.prompt("[[global:enter-page-number]]",function(a){p.loadPage(a)}),!1})},p.loadPage=function(a,u){if(u=u||function(){},a=parseInt(a,10),!utils.isNumber(a)||a<1||a>ajaxify.data.pagination.pageCount)return;const v=utils.params();v.page=a;const c=window.location.pathname+"?"+$.param(v);ajaxify.go(c,u)},p.nextPage=function(a){p.loadPage(ajaxify.data.pagination.currentPage+1,a)},p.previousPage=function(a){p.loadPage(ajaxify.data.pagination.currentPage-1,a)},p}.apply(w,g),d!==void 0&&(E.exports=d)},49897:(E,w,l)=>{l.r(w),l.d(w,{del:()=>i,get:()=>c,head:()=>h,patch:()=>n,post:()=>y,put:()=>s});var g=l(91749),d=l.n(g),m=l(40027),p=l.n(m);const a=config.relative_path+"/api/v3";async function u(t,r){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:a+t.url,typeof r=="function"){v(t).then(f=>r(null,f),f=>r(f));return}try{return await v(t)}catch(f){if(f.message==="A valid login session was not found. Please log in and try again.")return(0,m.confirm)("[[error:api.reauth-required]]",S=>{S&&ajaxify.go("login")});throw f}}async function v(t){const{url:r}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const f=await fetch(r,t),{headers:S}=f,x=S.get("content-type"),I=x&&x.startsWith("application/json");let k;if(t.method!=="head"&&(I?k=await f.json():k=await f.text()),!f.ok)throw k?new Error(I?k.status.message:k):new Error(f.statusText);return I&&k&&k.hasOwnProperty("status")&&k.hasOwnProperty("response")?k.response:k}function c(t,r,f){return u({url:t+(r&&Object.keys(r).length?"?"+$.param(r):"")},f)}function h(t,r,f){return u({url:t+(r&&Object.keys(r).length?"?"+$.param(r):""),method:"head"},f)}function y(t,r,f){return u({url:t,method:"post",data:r,headers:{"x-csrf-token":config.csrf_token}},f)}function n(t,r,f){return u({url:t,method:"patch",data:r,headers:{"x-csrf-token":config.csrf_token}},f)}function s(t,r,f){return u({url:t,method:"put",data:r,headers:{"x-csrf-token":config.csrf_token}},f)}function i(t,r,f){return u({url:t,method:"delete",data:r,headers:{"x-csrf-token":config.csrf_token}},f)}},29869:E=>{E.exports=function(w,l,g){l.setGlobal("true",!0),l.setGlobal("false",!1);const d=24*60*60*1e3,m={displayMenuItem:a,buildMetaTag:u,buildLinkTag:v,stringify:c,escape:h,stripTags:y,buildCategoryIcon:n,buildCategoryLabel:s,generateCategoryBackground:i,generateChildrenCategories:t,generateTopicClass:r,membershipBtn:f,spawnPrivilegeStates:S,localeToHTML:x,renderTopicImage:I,renderDigestAvatar:k,userAgentIcons:D,buildAvatar:M,increment:T,generateRepliedTo:B,generateWrote:N,isoTimeToLocaleString:F,shouldHideReplyContainer:O,humanReadableNumber:K,formattedNumber:j,register:H,__escape:p};function p(e){return e}function a(e,o){const C=e.navigation[o];return!(!C||C.route.match("/users")&&e.user&&!e.user.privileges["view:users"]||C.route.match("/tags")&&e.user&&!e.user.privileges["view:tags"]||C.route.match("/groups")&&e.user&&!e.user.privileges["view:groups"])}function u(e){const o=e.name?'name="'+e.name+'" ':"",C=e.property?'property="'+e.property+'" ':"",A=e.content?'content="'+e.content.replace(/\n/g," ")+'" ':"";return"<meta "+o+C+A+`/>
	`}function v(e){const o=["link","rel","as","type","href","sizes","title","crossorigin"],[C,A,b,R,P,L,_,W]=o.map(U=>e[U]?`${U}="${e[U]}" `:"");return"<link "+C+A+b+R+L+_+P+W+`/>
	`}function c(e){return JSON.stringify(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function h(e){return w.escapeHTML(e)}function y(e){return w.stripHTMLTags(e)}function n(e,o,C){return e?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${C}" style="${i(e)} width:${o}; height: ${o}; font-size: ${parseInt(o,10)/2}px;">${e.icon?`<i class="fa fa-fw ${e.icon}"></i>`:""}</span>`:""}function s(e,o="a",C=""){if(!e)return"";const A=o==="a"?`href="${g}/category/${e.slug}"`:"";return`<${o} ${A} class="badge px-1 text-truncate text-decoration-none ${C}" style="color: ${e.color};background-color: ${e.bgColor};border-color: ${e.bgColor}!important; max-width: 70vw;">
			${e.icon&&e.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${e.icon}"></i>`:""}
			${e.name}
		</${o}>`}function i(e){if(!e)return"";const o=[];return e.bgColor&&(o.push("background-color: "+e.bgColor),o.push(`border-color: ${e.bgColor}!important`)),e.color&&o.push("color: "+e.color),e.backgroundImage&&(o.push("background-image: url("+e.backgroundImage+")"),e.imageClass&&o.push("background-size: "+e.imageClass)),o.join("; ")+";"}function t(e){let o="";return!e||!e.children||!e.children.length||(e.children.forEach(function(C){if(C&&!C.isSection){const A=C.link?C.link:g+"/category/"+C.slug;o+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+i(C)+'"><i class="fa fa-fw '+C.icon+'"></i></div><a href="'+A+'"><small>'+C.name+"</small></a></span>"}}),o=o&&'<span class="category-children">'+o+"</span>"),o}function r(e){return["locked","pinned","deleted","unread","scheduled"].filter(C=>!!e[C]).join(" ")}function f(e,o=""){return e.isMember&&e.name!=="administrators"?`<button class="btn btn-danger ${o}" data-action="leave" data-group="${e.displayName}" ${e.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:e.isPending&&e.name!=="administrators"?`<button class="btn btn-warning disabled ${o}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:e.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${e.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${e.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!e.disableJoinRequests&&e.name!=="administrators"?`<button class="btn btn-success ${o}" data-action="join" data-group="${e.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function S(e,o,C){const A=[];for(const b in o)o.hasOwnProperty(b)&&A.push({name:b,state:o[b],type:C[b]});return A.map(function(b){const R=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],P=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],L=["groups:moderate"],_=e==="guests"&&(R.includes(b.name)||b.name.startsWith("groups:admin:"))||e==="spiders"&&!P.includes(b.name)||e==="Global Moderators"&&L.includes(b.name);return`
				<td data-privilege="${b.name}" data-value="${b.state}" data-type="${b.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none" autocomplete="off" type="checkbox"${b.state?" checked":""}${_?' disabled="disabled"':""} />
					</div>
				</td>
			`}).join("")}function x(e,o){return e=e||o||"en-GB",e.replace("_","-")}function I(e){return e.thumb?'<img src="'+e.thumb+'" class="img-circle user-img" title="'+e.user.username+'" />':'<img component="user/picture" data-uid="'+e.user.uid+'" src="'+e.user.picture+'" class="user-img" title="'+e.user.username+'" />'}function k(e){return e.teaser?e.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.teaser.user.picture+'" title="'+e.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.teaser.user["icon:text"]+"</div>":e.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.user.picture+'" title="'+e.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.user["icon:text"]+"</div>"}function D(e){let o="";switch(e.platform){case"Linux":o+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":o+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":o+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":o+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":o+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":o+='<i class="fa fa-fw fa-mobile"></i>';break;default:o+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(e.browser){case"Chrome":o+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":o+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":o+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":o+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":o+='<i class="fa fa-fw fa-edge"></i>';break;default:o+='<i class="fa fa-fw fa-question-circle"></i>';break}return o}function M(e,o,C,A,b){e||(e=this);const R=new Map([["alt",e.username],["title",e.username],["data-uid",e.uid],["loading","lazy"],["aria-label",`[[aria:user-avatar-for, ${e.username}]]`]]),P=[`--avatar-size: ${o};`],L=W=>Array.from(W).reduce((U,[z,Y])=>(U+=` ${z}="${Y}"`,U),"");A=A||"",R.set("class",`avatar ${A}${C?" avatar-rounded":""}`);let _="";return e.picture&&(R.set("component",b||"avatar/picture"),_+="<img "+L(R)+' src="'+e.picture+'" style="'+P.join(" ")+'" onError="this.remove();" itemprop="image" />'),R.set("component",b||"avatar/icon"),P.push("background-color: "+e["icon:bgColor"]+";"),_+="<span "+L(R)+' style="'+P.join(" ")+'">'+e["icon:text"]+"</span>",_}function T(e,o){return String(e+parseInt(o,10))}function B(e,o){const C=e.parent&&e.parent.displayname?e.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${e.timestamp<Date.now()-o*d?"on":"ago"}, ${e.toPid}, ${g}/post/${e.toPid}, ${C}, ${g}/post/${e.pid}, ${e.timestampISO}]]`}function N(e,o){return`[[topic:wrote-${e.timestamp<Date.now()-o*d?"on":"ago"}, ${g}/post/${e.pid}, ${e.timestampISO}]]`}function F(e,o="en-GB"){return new Date(e).toLocaleString([o],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function O(e){return!!(e.replies.count<=0||e.replies.hasSingleImmediateReply)}function K(e,o=1){return w.makeNumberHumanReadable(e,o)}function j(e){return w.addCommas(e)}function H(){Object.keys(m).forEach(function(e){l.registerHelper(e,m[e])})}return m}},30076:(E,w,l)=>{var g,d;const m=l(29869);g=[l(77918),l(81335)],d=function(p,a){return m(p,a,config.relative_path)}.apply(w,g),d!==void 0&&(E.exports=d)},10870:(E,w,l)=>{var g,d;g=[l(40027),l(17459),l(68636),l(29930),l(91749)],d=function(m,p,a,u,v){const c={};let h,y;c.show=function(){v.one("action:ajaxify.end",()=>{s(),n(),c.showEmailConfirmWarning()})},c.showEmailConfirmWarning=function(i){if(!config.emailPrompt||!app.user.uid||parseInt(a.getItem("email-confirm-dismiss"),10)===1)return;const t={alert_id:"email_confirm",type:"warning",timeout:0,closefn:()=>{a.setItem("email-confirm-dismiss",1)}};!app.user.email&&!app.user.isEmailConfirmSent?(t.message="[[error:no-email-to-confirm]]",t.clickfn=function(){u.remove("email_confirm"),ajaxify.go("user/"+app.user.userslug+"/edit/email")},u.alert(t)):!app.user["email:confirmed"]&&!app.user.isEmailConfirmSent?(t.message=i||"[[error:email-not-confirmed]]",t.clickfn=function(){u.remove("email_confirm"),ajaxify.go("/me/edit/email")},u.alert(t)):!app.user["email:confirmed"]&&app.user.isEmailConfirmSent&&(t.message="[[error:email-not-confirmed-email-sent]]",u.alert(t))};function n(){!config.cookies.enabled||!navigator.cookieEnabled||app.inAdmin||a.getItem("cookieconsent")==="1"||(config.cookies.message=p.unescape(config.cookies.message),config.cookies.dismiss=p.unescape(config.cookies.dismiss),config.cookies.link=p.unescape(config.cookies.link),config.cookies.link_url=p.unescape(config.cookies.link_url),app.parseAndTranslate("partials/cookie-consent",config.cookies,function(i){$(document.body).append(i),$(document.body).addClass("cookie-consent-open");const t=$(".cookie-consent");t.find("button").on("click",function(){a.setItem("cookieconsent","1"),t.remove(),$(document.body).removeClass("cookie-consent-open")})}))}function s(){const i=utils.params({full:!0});h=i.has("loggedin"),y=i.get("register"),h&&(u.alert({type:"success",title:"[[global:welcome-back]] "+app.user.username+"!",message:"[[global:you-have-successfully-logged-in]]",timeout:5e3}),i.delete("loggedin")),y&&(m.alert({message:utils.escapeHTML(decodeURIComponent(y))}),i.delete("register")),i.has("lang")&&i.get("lang")===config.defaultLang&&(console.info(`The "lang" parameter was passed in to set the language to "${i.get("lang")}", but that is already the forum default language.`),i.delete("lang"));const t=i.toString();ajaxify.updateHistory(ajaxify.currentPage+(t?`?${t}`:"")+document.location.hash,!0)}return c.showInvalidSession=function(){m.alert({title:"[[error:invalid-session]]",message:"[[error:invalid-session-text]]",closeButton:!1,callback:function(){window.location.reload()}})},c.showSessionMismatch=function(){m.alert({title:"[[error:session-mismatch]]",message:"[[error:session-mismatch-text]]",closeButton:!1,callback:function(){window.location.reload()}})},c}.apply(w,g),d!==void 0&&(E.exports=d)},69749:(E,w,l)=>{var g,d;g=[l(17459),l(68636),l(91749),l(29930),l(89336)],d=function(m,p,a,u,v){const c={current:{}};c.init=function(n){if(!config.searchEnabled)return;n=n||{in:config.searchDefaultInQuick||"titles"},$('[component="search/form"]').each((i,t)=>{h($(t),n)})};function h(n,s){const i=n.find('[component="search/button"]'),t=n.find('[component="search/fields"]'),r=t.find('input[name="query"]'),f=t.find("#quick-search-container");t.hasClass("hidden")&&r.off("blur").on("blur",function(){setTimeout(function(){r.is(":focus")||(t.addClass("hidden"),i.removeClass("hidden"))},200)}),r.off("focus");const x={inputEl:r,resultEl:f};c.enableQuickSearch({searchOptions:s,searchElements:x}),i.off("click").on("click",function(I){return!config.loggedIn&&!app.user.privileges["search:content"]?(u.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(I.stopPropagation(),c.showAndFocusInput(n),!1)}),n.off("submit").on("submit",function(){const I=$(this).find('input[name="query"]'),k=c.getSearchPreferences();return k.term=I.val(),k.in=s.in,a.fire("action:search.submit",{searchOptions:k,searchElements:x}),c.query(k,function(){I.val(""),r.trigger("blur")}),!1})}c.enableQuickSearch=function(n){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const s=Object.assign({in:config.searchDefaultInQuick||"titles"},n.searchOptions),i=n.searchElements.resultEl,t=n.searchElements.inputEl;let r=t.val();const f=i.find(".filter-category");function S(){ajaxify.data.template.category&&ajaxify.data.cid&&m.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(D){const M=$("<div></div>").html(D).text();f.find(".name").text(M)}),f.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function x(){n.searchOptions=Object.assign({},s),n.searchOptions.term=t.val(),S(),ajaxify.data.template.category&&ajaxify.data.cid&&f.find('input[type="checkbox"]').is(":checked")&&(n.searchOptions.categories=[ajaxify.data.cid],n.searchOptions.searchChildren=!0),n.hideDuringSearch||(i.removeClass("hidden").find(".quick-search-results-container").html(""),i.find(".loading-indicator").removeClass("hidden")),a.fire("action:search.quick.start",n),n.searchOptions.searchOnly=1,c.api(n.searchOptions,function(D){if(i.find(".loading-indicator").addClass("hidden"),!D.posts||n.hideOnNoMatches&&!D.posts.length)return i.addClass("hidden").find(".quick-search-results-container").html("");D.posts.forEach(function(M){const T=$("<div>"+M.content+"</div>").text(),B=t.val().toLowerCase().replace(/^in:topic-\d+/,""),N=Math.max(0,T.toLowerCase().indexOf(B)-40);M.snippet=utils.escapeHTML((N>0?"...":"")+T.slice(N,N+80)+(T.length-N>80?"...":""))}),app.parseAndTranslate("partials/quick-search-results",D,function(M){M.length&&M.find(".timeago").timeago(),i.toggleClass("hidden",!M.length||!t.is(":focus")).find(".quick-search-results-container").html(M.length?M:"");const T=i.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");c.highlightMatches(n.searchOptions.term,T),a.fire("action:search.quick.complete",{data:D,options:n})})})}i.find('.filter-category input[type="checkbox"]').on("change",function(){t.focus(),x()}),t.off("keyup").on("keyup",utils.debounce(function(){if(t.val().length<3){i.addClass("hidden"),r=t.val();return}if(t.val()!==r){if(r=t.val(),!t.is(":focus"))return i.addClass("hidden");x()}},500));let I=!1;i.on("mousedown",".quick-search-results > *",function(){$(window).one("mouseup",function(){i.addClass("hidden")}),I=!0}),t.on("blur",function(){setTimeout(function(){!t.is(":focus")&&!I&&!i.hasClass("hidden")&&i.addClass("hidden")},200)});let k=!1;a.on("action:ajaxify.end",function(){ajaxify.isCold()||(k=!0)}),t.on("focus",function(){I=!1;const D=t.val();r=D,D&&i.find("#quick-search-results").children().length&&(S(),k?(x(),k=!1):i.removeClass("hidden"),t[0].setSelectionRange(D.startsWith("in:topic")?D.indexOf(" ")+1:0,D.length))}),t.off("refresh").on("refresh",function(){x()})},c.showAndFocusInput=function(n){const s=n.parents(".dropdown-menu");if(s.length){const i=s.siblings("[data-bs-toggle]"),t=v.Dropdown.getOrCreateInstance(i[0]);t&&t.show()}else n.find('[component="search/fields"]').removeClass("hidden"),n.find('[component="search/button"]').addClass("hidden"),n.find('[component="search/fields"] input[name="query"]').trigger("focus")},c.query=function(n,s){s=s||function(){},ajaxify.go("search?"+y(n),s)},c.api=function(n,s){const i=config.relative_path+"/api/search?"+y(n);n.hasOwnProperty("searchOnly")&&delete n.searchOnly;const t=config.relative_path+"/search?"+y(n);$.get(i,function(r){r.url=t,s(r)})};function y(n){const s=n.in||"titles";let i=n.term.replace(/^[ ?#]*/,"");try{i=encodeURIComponent(i)}catch{return u.error("[[error:invalid-search-term]]")}const t={...n,term:i,in:s};return a.fire("action:search.createQueryString",{query:t,data:n}),decodeURIComponent($.param(t))}return c.getSearchPreferences=function(){try{return JSON.parse(p.getItem("search-preferences")||"{}")}catch{return{}}},c.highlightMatches=function(n,s){if(!n||!s.length)return;n=utils.escapeHTML(n.replace(/^"/,"").replace(/"$/,"").trim());const i=n.split(" ").filter(r=>r.length>1).map(function(r){return utils.escapeRegexChars(r)}).join("|"),t=new RegExp("("+i+")","gi");s.each(function(){const r=$(this),f=[];r.find("*").each(function(){$(this).after("<!-- "+f.length+" -->"),f.push($("<div></div>").append($(this)))}),r.html(r.html().replace(t,function(S,x){return'<strong class="search-match fw-bold text-decoration-underline">'+x+"</strong>"})),f.forEach(function(S,x){r.html(r.html().replace("<!-- "+x+" -->",function(){return S.html()}))})}),$(".search-result-text").find("img:not(.not-responsive)").addClass("img-fluid")},c}.apply(w,g),d!==void 0&&(E.exports=d)},68636:(E,w,l)=>{var g;g=function(){function d(){this._store={},this._keys=[]}d.prototype.isMock=!0,d.prototype.setItem=function(a,u){a=String(a),this._keys.indexOf(a)===-1&&this._keys.push(a),this._store[a]=u},d.prototype.getItem=function(a){return a=String(a),this._keys.indexOf(a)===-1?null:this._store[a]},d.prototype.removeItem=function(a){a=String(a),this._keys=this._keys.filter(function(u){return u!==a}),this._store[a]=null},d.prototype.clear=function(){this._keys=[],this._store={}},d.prototype.key=function(a){return a=parseInt(a,10)||0,this._keys[a]},Object.defineProperty&&Object.defineProperty(d.prototype,"length",{get:function(){return this._keys.length}});let m;const p=Date.now().toString();try{if(m=window.localStorage,m.setItem(p,p),m.getItem(p)!==p)throw Error("localStorage behaved unexpectedly");return m.removeItem(p),m}catch(a){console.warn(a),console.warn("localStorage failed, falling back on sessionStorage");try{if(m=window.sessionStorage,m.setItem(p,p),m.getItem(p)!==p)throw Error("sessionStorage behaved unexpectedly");return m.removeItem(p),m}catch(u){return console.warn(u),console.warn("sessionStorage failed, falling back on memory storage"),new d}}}.call(w,l,w,E),g!==void 0&&(E.exports=g)},14063:(E,w,l)=>{E=l.nmd(E);var g,d;g=[l(17459),l(91749)],d=function(m,p){const a={};let u=!1;a.init=function(){if(a.taskbar=$('[component="taskbar"]'),a.tasklist=a.taskbar.find("ul"),!a.taskbar.length||!a.tasklist.length){u=!0;return}a.taskbar.on("click","li",async function(){const n=$(this),s=n.attr("data-module"),i=n.attr("data-uuid"),t=await app.require(s);return n.hasClass("active")?t.minimize(i):(c(),t.load(i),a.toggleNew(i,!1),a.tasklist.removeClass("active"),n.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){a.closeAll()})},a.close=async function(n,s){if(u)return;if(a.tasklist.find('[data-module="'+E+'"][data-uuid="'+s+'"]').length){const t=await app.require(n);t&&typeof t.close=="function"&&t.close(s)}},a.closeAll=function(n){if(u)return;let s="[data-uuid]";n&&(s='[data-module="'+n+'"]'+s),a.tasklist.find(s).each(function(i,t){a.close(n||t.getAttribute("data-module"),t.getAttribute("data-uuid"))})},a.discard=function(n,s){if(u)return;a.tasklist.find('[data-module="'+n+'"][data-uuid="'+s+'"]').remove(),v()},a.push=function(n,s,i,t){if(t=t||function(){},u)return t();const r=a.tasklist.find('li[data-uuid="'+s+'"]'),f={module:n,uuid:s,options:i,element:r};p.fire("filter:taskbar.push",f),!r.length&&f.module?h(f,t):t(r)},a.get=function(n){return u?[]:$('[data-module="'+n+'"]').map(function(i,t){return $(t).data()})},a.minimize=function(n,s){if(u)return;a.tasklist.find('[data-module="'+n+'"][data-uuid="'+s+'"]').toggleClass("active",!1)},a.toggleNew=function(n,s,i){if(u)return;a.tasklist.find('[data-uuid="'+n+'"]').toggleClass("new",s),i||p.fire("action:taskbar.toggleNew",n)},a.updateActive=function(n){if(u)return;const s=a.tasklist.find("li");s.removeClass("active"),s.filter('[data-uuid="'+n+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+n+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},a.isActive=function(n){return u?!1:a.tasklist.find('li[data-uuid="'+n+'"]').hasClass("active")};function v(){if(u)return;a.tasklist.find("li").length>0?a.taskbar.attr("data-active","1"):a.taskbar.removeAttr("data-active")}function c(){u||a.tasklist.find(".active").removeClass("active")}function h(n,s){if(u)return s();m.translate(n.options.title,function(i){const t=$("<div></div>").text(i||"NodeBB Task").html(),r=$("<li></li>").addClass(n.options.className).html('<a href="#"'+(n.options.image?` style="background-image: url('`+n.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(n.options.icon?'<i class="fa '+n.options.icon+'"></i> ':"")+'<span aria-label="'+t+'" component="taskbar/title">'+t+"</span></a>").attr({title:t,"data-module":n.module,"data-uuid":n.uuid}).addClass(n.options.state!==void 0?n.options.state:"active");(!n.options.state||n.options.state==="active")&&c(),a.tasklist.append(r),v(),n.element=r,r.data(n),p.fire("action:taskbar.pushed",n),s(r)})}const y=function(n,s,i){switch(s){case"title":n.find('[component="taskbar/title"]').text(i);break;case"icon":n.find("i").attr("class","fa fa-"+i);break;case"image":n.find("a").css("background-image",i?'url("'+i.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":n.find("a").css("background-color",i);break;case"color":n.find("a").css("color",i);break}};return a.update=function(n,s,i){if(u)return;const t=a.tasklist.find('[data-module="'+n+'"][data-uuid="'+s+'"]');if(!t.length)return;const r=t.data();Object.keys(i).forEach(function(f){r[f]=i[f],y(t,f,i[f])}),t.data(r)},a}.apply(w,g),d!==void 0&&(E.exports=d)}}]);
