(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[11484,6232,18732,87212,33069,98463],{449:(b,w,u)=>{b.exports=u(91943)},89596:(b,w,u)=>{b.exports=u(62590)},99594:(b,w,u)=>{b.exports=u(57904)},68636:(b,w,u)=>{"use strict";var h;h=function(){function p(){this._store={},this._keys=[]}p.prototype.isMock=!0,p.prototype.setItem=function(e,o){e=String(e),this._keys.indexOf(e)===-1&&this._keys.push(e),this._store[e]=o},p.prototype.getItem=function(e){return e=String(e),this._keys.indexOf(e)===-1?null:this._store[e]},p.prototype.removeItem=function(e){e=String(e),this._keys=this._keys.filter(function(o){return o!==e}),this._store[e]=null},p.prototype.clear=function(){this._keys=[],this._store={}},p.prototype.key=function(e){return e=parseInt(e,10)||0,this._keys[e]},Object.defineProperty&&Object.defineProperty(p.prototype,"length",{get:function(){return this._keys.length}});let g;const s=Date.now().toString();try{if(g=window.localStorage,g.setItem(s,s),g.getItem(s)!==s)throw Error("localStorage behaved unexpectedly");return g.removeItem(s),g}catch(e){console.warn(e),console.warn("localStorage failed, falling back on sessionStorage");try{if(g=window.sessionStorage,g.setItem(s,s),g.getItem(s)!==s)throw Error("sessionStorage behaved unexpectedly");return g.removeItem(s),g}catch(o){return console.warn(o),console.warn("sessionStorage failed, falling back on memory storage"),new p}}}.call(w,u,w,b),h!==void 0&&(b.exports=h)},14063:(b,w,u)=>{"use strict";b=u.nmd(b);var h,p;h=[u(17459),u(91749)],p=function(g,s){const e={};let o=!1;e.init=function(){if(e.taskbar=$('[component="taskbar"]'),e.tasklist=e.taskbar.find("ul"),!e.taskbar.length||!e.tasklist.length){o=!0;return}e.taskbar.on("click","li",async function(){const t=$(this),n=t.attr("data-module"),r=t.attr("data-uuid"),l=await app.require(n);return t.hasClass("active")?l.minimize(r):(i(),l.load(r),e.toggleNew(r,!1),e.tasklist.removeClass("active"),t.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){e.closeAll()})},e.close=async function(t,n){if(o)return;if(e.tasklist.find('[data-module="'+b+'"][data-uuid="'+n+'"]').length){const l=await app.require(t);l&&typeof l.close=="function"&&l.close(n)}},e.closeAll=function(t){if(o)return;let n="[data-uuid]";t&&(n='[data-module="'+t+'"]'+n),e.tasklist.find(n).each(function(r,l){e.close(t||l.getAttribute("data-module"),l.getAttribute("data-uuid"))})},e.discard=function(t,n){if(o)return;e.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]').remove(),m()},e.push=function(t,n,r,l){if(l=l||function(){},o)return l();const c=e.tasklist.find('li[data-uuid="'+n+'"]'),f={module:t,uuid:n,options:r,element:c};s.fire("filter:taskbar.push",f),!c.length&&f.module?a(f,l):l(c)},e.get=function(t){return o?[]:$('[data-module="'+t+'"]').map(function(r,l){return $(l).data()})},e.minimize=function(t,n){if(o)return;e.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},e.toggleNew=function(t,n,r){if(o)return;e.tasklist.find('[data-uuid="'+t+'"]').toggleClass("new",n),r||s.fire("action:taskbar.toggleNew",t)},e.updateActive=function(t){if(o)return;const n=e.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+t+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},e.isActive=function(t){return o?!1:e.tasklist.find('li[data-uuid="'+t+'"]').hasClass("active")};function m(){if(o)return;e.tasklist.find("li").length>0?e.taskbar.attr("data-active","1"):e.taskbar.removeAttr("data-active")}function i(){o||e.tasklist.find(".active").removeClass("active")}function a(t,n){if(o)return n();g.translate(t.options.title,function(r){const l=$("<div></div>").text(r||"NodeBB Task").html(),c=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?` style="background-image: url('`+t.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span aria-label="'+l+'" component="taskbar/title">'+l+"</span></a>").attr({title:l,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==void 0?t.options.state:"active");(!t.options.state||t.options.state==="active")&&i(),e.tasklist.append(c),m(),t.element=c,c.data(t),s.fire("action:taskbar.pushed",t),n(c)})}const d=function(t,n,r){switch(n){case"title":t.find('[component="taskbar/title"]').text(r);break;case"icon":t.find("i").attr("class","fa fa-"+r);break;case"image":t.find("a").css("background-image",r?'url("'+r.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":t.find("a").css("background-color",r);break;case"color":t.find("a").css("color",r);break}};return e.update=function(t,n,r){if(o)return;const l=e.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]');if(!l.length)return;const c=l.data();Object.keys(r).forEach(function(f){c[f]=r[f],d(l,f,r[f])}),l.data(c)},e}.apply(w,h),p!==void 0&&(b.exports=p)},36159:(b,w,u)=>{"use strict";var h,p;h=[u(49897),u(40027),u(29930),u(24187),u(81335),u(17459),u(65285)],p=function(g,s,e,o,m,i){const a={};return a.get=d=>g.get(`/topics/${d}/thumbs`,{}),a.getByPid=d=>g.get(`/posts/${d}`,{}).then(t=>a.get(t.tid)),a.delete=(d,t)=>g.del(`/topics/${d}/thumbs`,{path:t}),a.deleteAll=d=>{a.get(d).then(t=>{Promise.all(t.map(n=>a.delete(d,n.url)))})},a.upload=d=>new Promise(t=>{o.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${d}/thumbs`},function(n){t(n)})}),a.modal={},a.modal.open=function(d){const{id:t,pid:n}=d;let{modal:r}=d,l;return new Promise(c=>{Promise.all([a.get(t),n?a.getByPid(n):[]]).then(f=>new Promise(E=>{const F=f.reduce((D,v)=>D.concat(v));l=F.length,E(F)})).then(f=>m.render("modals/topic-thumbs",{thumbs:f})).then(f=>{r?i.translate(f,function(E){r.find(".bootbox-body").html(E),a.modal.handleSort({modal:r,numThumbs:l})}):(r=s.dialog({title:"[[modules:thumbs.modal.title]]",message:f,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(a.upload(t).then(()=>{a.modal.open({...d,modal:r}),Promise.all([u.e(54516),u.e(99166),u.e(47061),u.e(49775)]).then(function(){var E=[u(71431)];(F=>{F.updateThumbCount(t,$(`[component="composer"][data-uuid="${t}"]`)),c()}).apply(null,E)}).catch(u.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),a.modal.handleDelete({...d,modal:r}),a.modal.handleSort({modal:r,numThumbs:l}))})})},a.modal.handleDelete=d=>{d.modal.get(0).addEventListener("click",n=>{n.target.closest('button[data-action="remove"]')&&s.confirm("[[modules:thumbs.modal.confirm-remove]]",r=>{if(!r)return;const l=n.target.closest("[data-id]").getAttribute("data-id"),c=n.target.closest("[data-path]").getAttribute("data-path");g.del(`/topics/${l}/thumbs`,{path:c}).then(()=>{a.modal.open(d)}).catch(e.error)})})},a.modal.handleSort=({modal:d,numThumbs:t})=>{if(t>1){const n=d.find(".topic-thumbs-modal");n.sortable({items:"[data-id]"}),n.on("sortupdate",a.modal.handleSortChange)}},a.modal.handleSortChange=(d,t)=>{const n=t.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(n).forEach((r,l)=>{const c=r.getAttribute("data-id");let f=r.getAttribute("data-path");f=f.replace(new RegExp(`^${config.upload_url}`),""),g.put(`/topics/${c}/thumbs/order`,{path:f,order:l}).catch(e.error)})},a}.apply(w,h),p!==void 0&&(b.exports=p)},24187:(b,w,u)=>{"use strict";var h,p;h=[u(64061)],p=function(){const g={};g.show=function(i,a){const d=i.hasOwnProperty("fileSize")&&i.fileSize!==void 0?parseInt(i.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:i.hasOwnProperty("showHelp")&&i.showHelp!==void 0?i.showHelp:!0,fileSize:d,title:i.title||"[[global:upload-file]]",description:i.description||"",button:i.button||"[[global:upload]]",accept:i.accept?i.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const n=t.find("#uploadForm");n.attr("action",i.route),n.find("#params").val(JSON.stringify(i.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),n.submit()}),n.submit(function(){return s(t,d,a),!1})})},g.hideAlerts=function(i){$(i).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function s(i,a,d){e(i,"status","[[uploads:uploading-file]]"),i.find("#upload-progress-bar").css("width","0%"),i.find("#upload-progress-box").show().removeClass("hide");const t=i.find("#fileInput");if(!t.val())return e(i,"error","[[uploads:select-file-to-upload]]");if(!m(t[0],a))return e(i,"error","[[error:file-too-big, "+a+"]]");g.ajaxSubmit(i,d)}function e(i,a,d){g.hideAlerts(i),a==="error"&&i.find("#fileUploadSubmitBtn").removeClass("disabled"),d=d.replace(/&amp;#44/g,"&#44"),i.find("#alert-"+a).translateText(d).removeClass("hide")}g.ajaxSubmit=function(i,a){i.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=o(t),e(i,"error",t.responseJSON?.status?.message||t.responseJSON?.error||`[[error:upload-error-fallback, ${t.status} ${t.statusText}]]`)},uploadProgress:function(t,n,r,l){i.find("#upload-progress-bar").css("width",l+"%")},success:function(t){let n=o(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(n=t.response.images),a(n[0].url),e(i,"success","[[uploads:upload-success]]"),setTimeout(function(){g.hideAlerts(i),i.modal("hide")},750)}})};function o(i){if(typeof i=="string")try{return JSON.parse(i)}catch{return{error:"[[error:parse-error]]"}}return i}function m(i,a){return window.FileReader&&a?i.files[0].size<=a*1e3:!0}return g}.apply(w,h),p!==void 0&&(b.exports=p)},91943:(b,w,u)=>{"use strict";var h,p;h=[u(89596),u(99594),u(36159),u(51916)],p=function(g,s,e,o){var m={},i={picture:function(){var n=this;n.find("#files").attr("accept","image/*").click()},upload:function(){var n=this;n.find("#files").attr("accept","").click()},thumbs:function(){m.exitFullscreen();var n=this;Promise.all([u.e(54516),u.e(99166),u.e(47061),u.e(29567)]).then(function(){var r=[u(71431)];(function(l){const c=n.get(0).getAttribute("data-uuid"),f=l.posts[c];(f.action==="topics.post"||f.action==="posts.edit"&&f.isMain)&&e.modal.open({id:c,pid:f.pid}).then(()=>{n.trigger("thumb.uploaded"),l.updateThumbCount(c,n)})}).apply(null,r)}).catch(u.oe)},tags:function(){var n=this;n.find(".tags-container").toggleClass("hidden")},zen:function(){var n=this;$(window).one("resize",function(){function r(){o.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),s.reposition(n),$(window).off("resize",r))}o.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),n.find(".write").focus(),$(window).on("resize",r),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",o.exit))}),o.toggle(n.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:n})}},a=[];m.exitFullscreen=function(){o.isEnabled&&o.isFullscreen&&o.exit()},m.addComposerButtons=function(){const n=$(".formatting-bar"),r=n.find(".formatting-group #fileForm");a.forEach(c=>{let f="";Array.isArray(c.dropdownItems)&&c.dropdownItems.length?f=t(c):f=`
					<li title="${c.title||""}">
						<button data-format="${c.name}" class="btn btn-sm btn-link text-reset position-relative" aria-label="${c.title||""}">
							<i class="${c.iconClass}"></i>
							${d(c)}
						</button>
					</li>
				`,r.before(f)}),n.find(".formatting-group>li").tooltip({container:"#content",animation:!1,trigger:"manual"}).on("mouseenter",function(c){const f=$(c.target);f.hasClass("dropdown-menu")||!!f.parents(".dropdown-menu").length||$(this).tooltip("show")}).on("click mouseleave",function(){$(this).tooltip("hide")})};function d(n){let r="";return n.badge&&(r='<span class="px-1 position-absolute top-0 start-100 translate-middle badge rounded text-bg-info"></span>'),r}function t(n){const r=n.dropdownItems.map(function(l){return`
				<li>
					<a href="#" data-format="${l.name}" class="dropdown-item rounded-1 position-relative" role="menuitem">
						<i class="${l.iconClass} text-secondary"></i> ${l.text}
						${d(l)}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1" title="${n.title}">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="${n.title}">
					<i class="${n.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1" role="menu">
				${r}
				</ul>
			</li>
		`}return m.addButton=function(n,r,l,c){c=c||n.replace("fa fa-",""),i[c]=r,a.push({name:c,iconClass:n,title:l})},m.addDropdown=function(n){a.push({iconClass:n.iconClass,title:n.title,dropdownItems:n.dropdownItems}),n.dropdownItems.forEach(r=>{r.name&&r.onClick&&(i[r.name]=r.onClick)})},m.getDispatchTable=function(){return i},m.addButtonDispatch=function(n,r){i[n]=r},m.addHandler=function(n){n.on("click",".formatting-bar [data-format]",function(r){var l=$(this).attr("data-format"),c=$(this).parents('[component="composer"]').find("textarea")[0];i.hasOwnProperty(l)&&(i[l].call(n,c,c.selectionStart,c.selectionEnd,r),g.render(n))})},m}.apply(w,h),p!==void 0&&(b.exports=p)},62590:(b,w,u)=>{"use strict";var h,p;h=[u(91749)],p=function(g){var s={};return s.render=function(e,o){if(o=o||function(){},!e.find(".preview-container").is(":visible"))return o();var m=e.find("textarea");socket.emit("plugins.composer.renderPreview",m.val(),function(i,a){i||(a=$("<div>"+a+"</div>"),a.find("img:not(.not-responsive)").addClass("img-fluid"),e.find(".preview").html(a),g.fire("action:composer.preview",{postContainer:e,preview:a}),o())})},s.matchScroll=function(e){if(e.find(".preview-container").is(":visible")){var o=e.find("textarea"),m=e.find(".preview");if(o.length&&m.length){var i=o[0].scrollHeight-o.height();if(i===0)return;var a=o.scrollTop()/i;m.scrollTop(Math.max(m[0].scrollHeight-m.height(),0)*a)}}},s.handleToggler=function(e){const o=e.get(0);s.env=utils.findBootstrapEnvironment();const m=["xs","sm"].includes(s.env),i=o.querySelector('.formatting-bar [data-action="preview"]'),a=i.querySelector(".show-text"),d=i.querySelector(".hide-text"),t=localStorage.getItem("composer:previewToggled"),n=config["composer-default"].hidePreviewOnOpen==="on";let r=!m&&(t===null&&!n||t==="true");const l=o.querySelector(".preview-container"),c=o.querySelector(".write-container");if(!i)return;function f(E){m?(l.classList.toggle("hide",!1),c.classList.toggle("maximized",!1),l.classList.toggle("d-none",!E),l.classList.toggle("d-flex",E),l.classList.toggle("w-100",E),c.classList.toggle("d-flex",!E),c.classList.toggle("d-none",E),c.classList.toggle("w-100",!E)):(l.classList.toggle("hide",!E),c.classList.toggle("w-50",E),c.classList.toggle("w-100",!E),localStorage.setItem("composer:previewToggled",E)),a.classList.toggle("hide",E),d.classList.toggle("hide",!E),E&&s.render(e),s.matchScroll(e)}s.toggle=f,i.addEventListener("click",E=>{E.button===0&&(r=!r,f(r))}),f(r)},s}.apply(w,h),p!==void 0&&(b.exports=p)},57904:(b,w,u)=>{"use strict";var h,p;h=[u(14063)],p=function(g){var s={},e=0,o=.3,m=.05,i=768,a=$("body"),d=$(window),t=$('[component="navbar"]');const n=document.getElementById("content");var r=t[0];function l(){return localStorage.getItem("composer:resizeRatio")||.5}function c(v){localStorage.setItem("composer:resizeRatio",Math.min(v,1))}function f(){var v;r?v=r.getBoundingClientRect():v={bottom:0};var A=Math.max(v.bottom,0),x={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return x.width=x.right,x.height=x.bottom,x.boundedTop=A,x.boundedHeight=x.bottom-A,x}function E(v,A){var x=f(),k=v[0],I=window.getComputedStyle(k),T=parseInt(I.getPropertyValue("min-height"),10),B=Math.max(T/window.innerHeight,o);if(x.width>=i){const N=(x.height-x.boundedHeight)/x.height;A=Math.min(Math.max(A,B+N),1);var P=A*x.boundedHeight/x.height;k.style.top=((1-P)*100).toString()+"%";var z=k.getBoundingClientRect();n.style.paddingBottom=(z.bottom-z.top).toString()+"px"}else k.style.top=0,n.style.paddingBottom=0;v.ratio=A,g.updateActive(v.attr("data-uuid"))}var F=E,D=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return D&&(F=function(v,A){D(function(){E(v,A),setTimeout(function(){d.trigger("action:composer.resize"),v.trigger("action:composer.resize")},0)})}),s.reposition=function(v){var A=l();A>=1-m&&(A=1,v.addClass("maximized")),F(v,A)},s.maximize=function(v,A){A?F(v,1):s.reposition(v)},s.handleResize=function(v){var A=0,x=0,k=0,I=v.find(".resizer"),T=I[0];function B(S){var R=T.getBoundingClientRect(),y=(R.top+R.bottom)/2;A=(y-S.clientY)/2,x=S.clientY,d.on("mousemove",P),d.on("mouseup",z),a.on("touchmove",N)}function P(S){var R=S.clientY-A,y=f(),C=(y.height-R)/y.boundedHeight;F(v,C)}function z(S){S.preventDefault(),k=S.clientY,v.find("textarea").focus(),d.off("mousemove",P),d.off("mouseup",z),a.off("touchmove",N);var R=k-A,y=f(),C=(y.height-R)/y.boundedHeight;k-x===0&&v.hasClass("maximized")?(v.removeClass("maximized"),C=!e||e>=1-m?.5:e,F(v,C)):k-x===0||C>=1-m?(F(v,1),v.addClass("maximized"),e=C):v.removeClass("maximized"),c(C)}function N(S){S.preventDefault(),P(S.touches[0])}I.on("mousedown",function(S){S.button===0&&(S.preventDefault(),B(S))}).on("touchstart",function(S){S.preventDefault(),B(S.touches[0])}).on("touchend",z)},s}.apply(w,h),p!==void 0&&(b.exports=p)},51916:b=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var w=typeof window<"u"&&typeof window.document<"u"?window.document:{},u=b.exports,h=function(){for(var s,e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],o=0,m=e.length,i={};o<m;o++)if(s=e[o],s&&s[1]in w){for(o=0;o<s.length;o++)i[e[0][o]]=s[o];return i}return!1}(),p={change:h.fullscreenchange,error:h.fullscreenerror},g={request:function(s,e){return new Promise(function(o,m){var i=function(){this.off("change",i),o()}.bind(this);this.on("change",i),s=s||w.documentElement;var a=s[h.requestFullscreen](e);a instanceof Promise&&a.then(i).catch(m)}.bind(this))},exit:function(){return new Promise(function(s,e){if(!this.isFullscreen){s();return}var o=function(){this.off("change",o),s()}.bind(this);this.on("change",o);var m=w[h.exitFullscreen]();m instanceof Promise&&m.then(o).catch(e)}.bind(this))},toggle:function(s,e){return this.isFullscreen?this.exit():this.request(s,e)},onchange:function(s){this.on("change",s)},onerror:function(s){this.on("error",s)},on:function(s,e){var o=p[s];o&&w.addEventListener(o,e,!1)},off:function(s,e){var o=p[s];o&&w.removeEventListener(o,e,!1)},raw:h};if(!h){u?b.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(g,{isFullscreen:{get:function(){return!!w[h.fullscreenElement]}},element:{enumerable:!0,get:function(){return w[h.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!w[h.fullscreenEnabled]}}}),u?b.exports=g:window.screenfull=g})()}}]);
