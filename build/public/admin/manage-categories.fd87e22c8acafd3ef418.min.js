"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[90479,99127,34271,69185,86198,1091,49897],{29195:(A,x,l)=>{var b,E;b=[l(17459),l(81335),l(65348),l(49897),l(10246),l(40027),l(29930)],E=function(v,D,w,h,g,a,r){g=g.default;const d={};let c=-1,p;d.init=function(){w.init($('[component="category-selector"]'),{parentCid:ajaxify.data.selectedCategory?ajaxify.data.selectedCategory.cid:0,onSelect:function(t){ajaxify.go("/admin/manage/categories"+(t.cid?"?cid="+t.cid:""))},cacheList:!1,localCategories:[],template:"admin/partials/category/selector-dropdown-right"}),d.render(ajaxify.data.categoriesTree),$('button[data-action="create"]').on("click",d.throwCreateModal),$(".categories").on("click",'.category-tools [data-action="toggle"]',function(){const t=$(this),o=t.attr("data-disable-cid"),f=t.parents('li[data-cid="'+o+'"]'),s=f.hasClass("disabled"),u=f.find("li[data-cid]").map(function(){return $(this).attr("data-cid")}).get();d.toggle([o].concat(u),!s)}),$(".categories").on("click",".toggle",function(){const t=$(this);t.find("i").toggleClass("fa-chevron-down").toggleClass("fa-chevron-right"),t.closest("[data-cid]").find("> ul[data-cid]").toggleClass("hidden");const o=t.closest("[data-cid]").find("> ul.has-more-categories");parseInt(o.attr("data-hasmore"),10)===1&&o.toggleClass("hidden")}),$(".categories").on("click",".set-order",function(){const t=$(this).attr("data-cid"),o=$(this).attr("data-order"),f=a.dialog({title:"[[admin/manage/categories:set-order]]",message:'<input type="number" min="1" class="form-control input-lg" value='+o+' /><p class="form-text">[[admin/manage/categories:set-order-help]]</p>',show:!0,buttons:{save:{label:"[[modules:bootbox.confirm]]",className:"btn-primary",callback:function(){const s=f.find("input").val();if(s&&t){const y={};y[t]={order:Math.max(1,parseInt(s,10))},h.put("/categories/"+t,y[t]).then(function(){ajaxify.refresh()}).catch(r.error)}else return!1}}}})}),$("#toggle-collapse-all").on("click",function(){const t=$(this),o=parseInt(t.attr("data-collapsed"),10)===1;e(o),t.attr("data-collapsed",o?0:1).translateText(o?"[[admin/manage/categories:collapse-all]]":"[[admin/manage/categories:expand-all]]")});function e(t){const o=$(".categories .toggle");o.find("i").toggleClass("fa-chevron-down",t).toggleClass("fa-chevron-right",!t),o.closest("[data-cid]").find("> ul[data-cid]").toggleClass("hidden",!t)}},d.throwCreateModal=function(){D.render("admin/partials/categories/create",{}).then(function(e){const t=a.dialog({title:"[[admin/manage/categories:alert.create]]",message:e,buttons:{save:{label:"[[global:create]]",className:"btn-primary",callback:y}}}),o={localCategories:[{cid:0,name:"[[admin/manage/categories:parent-category-none]]",icon:"fa-none"}],template:"admin/partials/category/selector-dropdown-left"},f=w.init(t.find('#parentCidGroup [component="category-selector"]'),o),s=w.init(t.find('#cloneFromCidGroup [component="category-selector"]'),o);function y(){const u=t.find("form").serializeObject();return u.description="",u.icon="fa-comments",u.uid=app.user.uid,u.parentCid=f.getSelectedCid(),u.cloneFromCid=s.getSelectedCid(),d.create(u),t.modal("hide"),!1}$("#cloneChildren").on("change",function(){const u=$(this),C=t.find('#parentCidGroup [component="category-selector"] .dropdown-toggle');u.prop("checked")?(C.attr("disabled","disabled"),f.selectCategory(0)):C.removeAttr("disabled")}),t.find("form").on("submit",y)})},d.create=function(e){h.post("/categories",e,function(t,o){if(t)return r.error(t);r.alert({alert_id:"category_created",title:"[[admin/manage/categories:alert.created]]",message:"[[admin/manage/categories:alert.create-success]]",type:"success",timeout:2e3}),ajaxify.go("admin/manage/categories/"+o.cid)})},d.render=function(e){const t=$(".categories");!e||!e.length?v.translate("[[admin/manage/categories:alert.none-active]]",function(o){$("<div></div>").addClass("alert alert-info text-center").text(o).appendTo(t)}):(p={},i(e,t,{cid:0}))},d.toggle=function(e,t){const o=document.querySelector('.categories [data-cid="0"]');Promise.all(e.map(f=>h.put("/categories/"+f,{disabled:t?1:0}).then(()=>{const s=o.querySelector(`li[data-cid="${f}"]`);s.classList[t?"add":"remove"]("disabled"),$(s).find('li a[data-action="toggle"]').first().translateText(t?"[[admin/manage/categories:enable]]":"[[admin/manage/categories:disable]]")}).catch(r.error)))};function m(e){c=e.to.dataset.cid}function n(e){const t=parseInt(c,10)!==-1;if(e.newIndex!=null&&parseInt(e.oldIndex,10)!==parseInt(e.newIndex,10)||t){const o=e.item.dataset.cid,f={},s=(ajaxify.data.pagination.currentPage-1)*ajaxify.data.categoriesPerPage;if(f[o]={order:s+e.newIndex+1},t){f[o].parentCid=c;const y=parseInt(e.from.getAttribute("data-cid"),10),u=parseInt(e.to.getAttribute("data-cid"),10);if(y!==u){const C=document.querySelector(`.categories li[data-cid="${u}"] .toggle`);if(C&&C.classList.toggle("invisible",!1),!document.querySelectorAll(`.categories li[data-cid="${y}"] ul[data-cid] li[data-cid]`).length){const I=document.querySelector(`.categories li[data-cid="${y}"] .toggle`);I&&I.classList.toggle("invisible",!0)}e.item.dataset.parentCid=u}}c=-1,h.put("/categories/"+o,f[o]).catch(r.error)}}function i(e,t,o){let f=0;const s=o.cid;e.forEach(function(u,C,S){v.translate(u.name,function(I){u.name!==I&&(u.name=I),f+=1,f===S.length&&y()})}),e.length||y();function y(){app.parseAndTranslate("admin/partials/categories/category-rows",{cid:o.cid,categories:e,parentCategory:o},function(u){t.find(".category-row").length?t.find(".category-row").after(u):t.append(u),e.length||t.get(0).querySelector(".toggle").classList.toggle("invisible",!0);for(let C=0,S=e.length;C<S;C+=1)i(e[C].children,$('li[data-cid="'+e[C].cid+'"]'),e[C]);p[s]=g.create($('ul[data-cid="'+s+'"]')[0],{group:"cross-categories",animation:150,handle:".information",dataIdAttr:"data-cid",ghostClass:"placeholder",onAdd:m,onEnd:n})})}}return d}.apply(x,b),E!==void 0&&(A.exports=E)},49897:(A,x,l)=>{l.r(x),l.d(x,{del:()=>m,get:()=>a,head:()=>r,patch:()=>c,post:()=>d,put:()=>p});var b=l(91749),E=l.n(b),v=l(40027),D=l.n(v);const w=config.relative_path+"/api/v3";async function h(n,i){if(n.url=n.url.startsWith("/api")?config.relative_path+n.url:w+n.url,typeof i=="function"){g(n).then(e=>i(null,e),e=>i(e));return}try{return await g(n)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again.")return(0,v.confirm)("[[error:api.reauth-required]]",t=>{t&&ajaxify.go("login")});throw e}}async function g(n){const{url:i}=n;delete n.url,n.data&&!(n.data instanceof FormData)&&(n.data=JSON.stringify(n.data||{}),n.headers["content-type"]="application/json; charset=utf-8"),{options:n}=await(0,b.fire)("filter:api.options",{options:n}),n.data&&(n.body=n.data,delete n.data);const e=await fetch(i,n),{headers:t}=e,o=t.get("content-type"),f=o&&o.startsWith("application/json");let s;if(n.method!=="head"&&(f?s=await e.json():s=await e.text()),!e.ok)throw s?new Error(f?s.status.message:s):new Error(e.statusText);return f&&s&&s.hasOwnProperty("status")&&s.hasOwnProperty("response")?s.response:s}function a(n,i,e){return h({url:n+(i&&Object.keys(i).length?"?"+$.param(i):"")},e)}function r(n,i,e){return h({url:n+(i&&Object.keys(i).length?"?"+$.param(i):""),method:"head"},e)}function d(n,i,e){return h({url:n,method:"post",data:i,headers:{"x-csrf-token":config.csrf_token}},e)}function c(n,i,e){return h({url:n,method:"patch",data:i,headers:{"x-csrf-token":config.csrf_token}},e)}function p(n,i,e){return h({url:n,method:"put",data:i,headers:{"x-csrf-token":config.csrf_token}},e)}function m(n,i,e){return h({url:n,method:"delete",data:i,headers:{"x-csrf-token":config.csrf_token}},e)}},96349:(A,x,l)=>{var b,E;b=[l(29930),l(89336),l(49897)],E=function(v,D,w){const h={};return h.init=function(g,a){let r=null;a=a||{},a.privilege=a.privilege||"topics:read",a.states=a.states||["watching","tracking","notwatching","ignoring"],a.cacheList=a.hasOwnProperty("cacheList")?a.cacheList:!0;let d=[];Array.isArray(a.localCategories)&&(d=a.localCategories.map(i=>({...i}))),a.selectedCids=a.selectedCids||ajaxify.data.selectedCids||[];const c=g.find('[component="category-selector-search"]');if(!c.length)return;const p=c.parent('[component="category/dropdown"]').length>0||c.parent('[component="category-selector"]').length>0;g.on("show.bs.dropdown",function(){p&&(g.find(".dropdown-toggle").css({visibility:"hidden"}),c.removeClass("hidden"),c.css({"z-index":g.find(".dropdown-toggle").css("z-index")+1}));function i(){const e=c.find("input").val();e.length>1||!e&&!r?m(e,function(t){r=a.cacheList&&(r||t),n(t)}):!e&&r&&n(r)}c.on("click",function(e){e.preventDefault(),e.stopPropagation()}),c.find("input").val("").on("keyup",utils.debounce(i,300)),i()}),g.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||c.find("input").focus()}),g.on("hide.bs.dropdown",function(){p&&(g.find(".dropdown-toggle").css({visibility:"inherit"}),c.addClass("hidden")),c.off("click"),c.find("input").off("keyup")});function m(i,e){w.get("/search/categories",{search:i,query:utils.params(),parentCid:a.parentCid||0,selectedCids:a.selectedCids,privilege:a.privilege,states:a.states,showLinks:a.showLinks},function(t,{categories:o}){if(t)return v.error(t);e(d.concat(o))})}function n(i){const e=a.selectedCids.map(String);i.forEach(function(t){t.selected=e.includes(String(t.cid))}),app.parseAndTranslate(a.template,{categoryItems:i.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(t){g.find('[component="category/list"]').html(t.find('[component="category/list"]').html()),g.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!i.length);const o=D.Dropdown.getInstance(g.find(".dropdown-toggle").get(0));o&&o.update()})}},h}.apply(x,b),E!==void 0&&(A.exports=E)},65348:(A,x,l)=>{var b,E;b=[l(96349),l(40027),l(91749),l(17459)],E=function(v,D,w,h){const g={};return g.init=function(a,r){if(!a||!a.length)return;r=r||{};const d=r.onSelect||function(){};r.states=r.states||["watching","tracking","notwatching","ignoring"],r.template=r.template||"partials/category/selector-dropdown-left",w.fire("action:category.selector.options",{el:a,options:r}),v.init(a,r);const c={el:a,selectedCategory:null};a.on("click","[data-cid]",function(){const m=$(this);return m.hasClass("disabled")?!1:(c.selectCategory(m.attr("data-cid")),d(c.selectedCategory))});let p=c.el.find('[component="category-selector-selected"]').html();return h.translate(p,m=>{p=m}),c.selectCategory=function(m){const n=c.el.find('[data-cid="'+m+'"]');c.selectedCategory={cid:m,name:n.attr("data-name")},n.length?c.el.find('[component="category-selector-selected"]').html(n.find('[component="category-markup"]').html()):c.el.find('[component="category-selector-selected"]').html(p)},c.getSelectedCategory=function(){return c.selectedCategory},c.getSelectedCid=function(){return c.selectedCategory?c.selectedCategory.cid:0},r.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(r.template,{selectedCategory:r.selectedCategory},function(m){c.el.find('[component="category-selector-selected"]').html(m.find('[component="category-selector-selected"]').html())}),c},g.modal=function(a){a=a||{},a.onSelect=a.onSelect||function(){},a.onSubmit=a.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:a.message},function(r){const d=D.dialog({title:a.title||"[[modules:composer.select-category]]",message:r,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:p}}}),c=g.init(d.find('[component="category-selector"]'),a);function p(m){return m.preventDefault(),c.selectedCategory&&(a.onSubmit(c.selectedCategory),d.modal("hide")),!1}a.openOnLoad&&d.on("shown.bs.modal",function(){d.find(".dropdown-toggle").dropdown("toggle")}),d.find("form").on("submit",p)})},g}.apply(x,b),E!==void 0&&(A.exports=E)}}]);
