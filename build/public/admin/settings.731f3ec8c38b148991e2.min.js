"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[61396,18470,98463],{54222:(R,F,d)=>{var x,m;x=[d(24187),d(6411),d(91749),d(29930),d(70012),d(89336)],m=function(y,k,r,v,S,s){const f={};f.populateTOC=function(){const n=$(".settings-header"),a=$('[component="settings/toc"]'),o=$('[component="settings/toc/list"]'),c=$('[component="settings/main/header"]');if(n.length>1&&o.length){n.each(function(u){const g=$(this),h=g.text(),A=g.parent().attr("id")||`section${u+1}`;A.startsWith("section")&&g.parent().attr("id",A),o.append(`<a class="btn-ghost-sm text-xs justify-content-start text-decoration-none" href="#${A}">${h}</a>`)});const l=c.outerHeight(!0);o.find("a").on("click",function(u){u.preventDefault();const g=$(this).attr("href");return $(g)[0].scrollIntoView(),window.location.hash=g,scrollBy(0,-l),setTimeout(()=>{o.find("a").removeClass("active"),$(this).addClass("active")},10),!1}),new s.ScrollSpy($("#spy-container")[0],{target:"#settings-navbar",rootMargin:"-10% 0px -70%",smoothScroll:!0});const p=$(`${window.location.hash}`);p.length&&$("html, body").animate({scrollTop:p.offset().top-l+"px"},400),a.removeClass("hidden")}},f.prepare=function(n){const a=$("#content [data-field]"),o=a.length,c=$("#save"),l=$("#revert");let p,u,g,h;a.on("change",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const A=["text","hidden","password","textarea","number"];for(p=0;p<o;p+=1)if(h=a.eq(p),u=h.attr("data-field"),g=h.attr("type"),app.config.hasOwnProperty(u))if(h.is("input")&&g==="checkbox"){const C=parseInt(app.config[u],10)===1;h.prop("checked",C)}else(h.is("textarea")||h.is("select")||h.is("input")&&A.indexOf(g)!==-1)&&h.val(app.config[u]);l.off("click").on("click",function(){ajaxify.refresh()}),c.off("click").on("click",function(C){C.preventDefault(),S.check(document.querySelectorAll("#content [data-field]"))&&i(a,function(P){if(P)return v.alert({alert_id:"config_status",timeout:2500,title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${P.message}]]`,type:"danger"});app.flags._unsaved=!1,f.toggleSaveSuccess(c),r.fire("action:admin.settingsSaved")})}),k.bind("ctrl+s",function(C){c.click(),C.preventDefault()}),e(),t(),$("#clear-sitemap-cache").off("click").on("click",function(){return socket.emit("admin.settings.clearSitemapCache",function(){v.success("Sitemap Cache Cleared!")}),!1}),typeof n=="function"&&n(),setTimeout(function(){r.fire("action:admin.settingsLoaded")},0)},f.toggleSaveSuccess=function(n){const a=n.get(0);a&&(a.classList.toggle("saved",!0),setTimeout(()=>{a.classList.toggle("saved",!1)},1500))};function e(){$('#content input[data-action="upload"]').each(function(){const n=$(this);n.on("click",function(){y.show({title:n.attr("data-title"),description:n.attr("data-description"),route:n.attr("data-route"),params:{},showHelp:n.attr("data-help")?n.attr("data-help")===1:void 0,accept:n.attr("data-accept")},function(a){$("#"+n.attr("data-target")).val(a)})})})}function t(){$('[data-field-type="tagsinput"]').tagsinput({tagClass:"badge bg-info",confirmKeys:[13,44],trimValue:!0}),app.flags._unsaved=!1}f.remove=function(n){socket.emit("admin.config.remove",n)};function i(n,a){const o={};n.each(function(){const c=$(this),l=c.attr("data-field");let p,u;if(c.is("input"))switch(u=c.attr("type"),u){case"text":case"password":case"hidden":case"textarea":case"number":p=c.val();break;case"checkbox":p=c.prop("checked")?"1":"0";break}else(c.is("textarea")||c.is("select"))&&(p=c.val());o[l]=p}),socket.emit("admin.config.setMultiple",o,function(c){if(c)return a(c);for(const l in o)o.hasOwnProperty(l)&&(app.config[l]=o[l]);a()})}return f}.apply(F,x),m!==void 0&&(R.exports=m)},70012:(R,F,d)=>{var x,m;x=[d(91749),d(29930)],m=function(y,k){let r,v=[],S=0,s;function f(e,t){typeof e!="string"&&(e=$(e),e=e.data("type")||e.attr("type")||e.prop("tagName"));const i=r.plugins[e.toLowerCase()];if(i==null)return;const n=i[t];return typeof n=="function"?n:null}return s={deepClone:function(e){return typeof e=="object"?JSON.parse(JSON.stringify(e)):e},createElement:function(e,t,i){const n=document.createElement(e);for(const a in t)t.hasOwnProperty(a)&&n.setAttribute(a,t[a]);return i&&n.appendChild(document.createTextNode(i)),n},initElement:function(e){const t=f(e,"init");t?.call(r,$(e))},destructElement:function(e){const t=f(e,"destruct");t?.call(r,$(e))},createElementOfType:function(e,t,i){let n;const a=f(e,"create");return a!=null?n=$(a.call(r,e,t,i)):(i==null&&(i={}),e!=null&&(i.type=e),n=$(s.createElement(t||"input",i))),n.data("type",e),s.initElement(n),n},cleanArray:function(e,t,i){const n=[];if(!t&&i)return e;for(let a=0;a<e.length;a+=1){let o=e[a];t&&(o===!!o?o=+o:o&&typeof o.trim=="function"&&(o=o.trim())),(i||o!=null&&o.length)&&n.push(o)}return n},isTrue:function(e){return e==="true"||+e==1},isFalse:function(e){return e==="false"||+e==0},readValue:function(e){let t=!s.isFalse(e.data("empty"));const i=!s.isFalse(e.data("trim")),n=e.data("split"),a=f(e,"get");let o;if(a!=null)return a.call(r,e,i,t);if(n!=null){t=s.isTrue(e.data("empty")),o=e.val();const c=o!=null&&o.split(n||",")||[];return s.cleanArray(c,i,t)}if(o=e.val(),i&&o!=null&&typeof o.trim=="function"&&(o=o.trim()),t||o!==void 0&&(o==null||o.length!==0))return o},fillField:function(e,t){const i=f(e,"set");let n=e.data("trim");if(n=n!=="false"&&+n!=0,i!=null)return i.call(r,e,t,n);t instanceof Array&&(t=t.join(e.data("split")||(n?", ":","))),n&&t&&typeof t.trim=="function"?(t=t.trim(),typeof t.toString=="function"&&(t=t.toString())):t!=null?(typeof t.toString=="function"&&(t=t.toString()),n&&(t=t.trim())):t="",t!==void 0&&e.val(t)},initFields:function(e){$("[data-key]",e).each(function(t,i){i=$(i);const n=f(i,"init"),a=i.data("key").split(".");let o=r.get();n?.call(r,i);for(let c=0;c<a.length;c+=1){const l=a[c];l&&o!=null&&(o=o[l])}s.fillField(i,o)})},registerReadyJobs:function(e){return S+=e,S},beforeReadyJobsDecreased:function(e){if(e==null&&(e=1),S>0&&(S-=e,S<=0)){for(let t=0;t<v.length;t+=1)v[t]();v=[]}},whenReady:function(e){S<=0?e():v.push(e)},serializeForm:function(e){const t=e.serializeObject();return e.find('input[type="checkbox"]').each(function(i,n){n=$(n),n.is(":checked")||(t[n.attr("name")]="off")}),e.find("select[multiple]").each(function(i,n){n=$(n),t[n.attr("name")]=JSON.stringify(n.val())}),t},persistSettings:function(e,t,i,n){t!=null&&t._!=null&&typeof t._!="string"&&(t=s.deepClone(t),t._=JSON.stringify(t._)),socket.emit("admin.settings.set",{hash:e,values:t},function(a){i&&(a?k.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${a.message}]]`,timeout:5e3}):k.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof n=="function"&&n(a)})},use:function(e){try{e._=JSON.parse(e._)}catch{}r.cfg=e}},r={helper:s,plugins:{},cfg:{},get:function(){return r.cfg!=null&&r.cfg._!==void 0?r.cfg._:r.cfg},registerPlugin:function(e,t){t==null?t=e.types:e.types=t,typeof e.use=="function"&&e.use.call(r);for(let i=0;i<t.length;i+=1){const n=t[i].toLowerCase();r.plugins[n]==null&&(r.plugins[n]=e)}},set:function(e,t,i,n,a){a==null&&(a=!0),s.whenReady(function(){s.use(t),s.initFields(i||"form"),s.persistSettings(e,t,a,n)})},sync:function(e,t,i){socket.emit("admin.settings.get",{hash:e},function(n,a){n?typeof i=="function"&&i(n):s.whenReady(function(){s.use(a),s.initFields(t||"form"),typeof i=="function"&&i()})})},persist:function(e,t,i,n){const a=[],o=$("[data-key]",t||"form").toArray();n==null&&(n=!0);for(let c=0;c<o.length;c+=1){const l=$(o[c]),p=s.readValue(l);let u=r.get();const g=l.data("key").split("."),h=g[g.length-1];if(g.length>1)for(let A=0;A<g.length-1;A+=1){const C=g[A];C&&u!=null&&(u=u[C])}u!=null?p!=null?u[h]=p:delete u[h]:a.push(l.data("key"))}a.length&&k.alert({title:"Attributes Not Saved",message:"'"+a.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),s.persistSettings(e,r.cfg,n,i)},load:function(e,t,i){i=i||function(){};const n=t.attr("data-socket-get");socket.emit(n||"admin.settings.get",{hash:e},function(a,o){if(a)return i(a);$(t).find("select[multiple]").each(function(l,p){const u=$(p).attr("name");if(u&&o.hasOwnProperty(u))try{o[u]=JSON.parse(o[u])}catch{}}),ajaxify.data[n?e:"settings"]=o,s.whenReady(function(){$(t).find("[data-sorted-list]").each(function(l,p){f(p,"get").call(r,$(p),e)})}),$(t).deserialize(o),y.fire("action:admin.settingsLoaded"),$(t).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const c=document.getElementById("save");c&&d.e(6411).then(function(){var l=[d(6411)];(function(p){p.bind("ctrl+s",function(u){c.click(),u.preventDefault()})}).apply(null,l)}).catch(d.oe),i(null,o)})},save:function(e,t,i){t=$(t);const n=t.get(0).elements;if(r.check(n)&&t.length){const o=s.serializeForm(t);s.whenReady(function(){const l=t.find("[data-sorted-list]");l.length&&l.each((p,u)=>{f(u,"set").call(r,$(u),o)})});const c=t.attr("data-socket-set");socket.emit(c||"admin.settings.set",{hash:e,values:o},function(l){if(app.flags._unsaved=!1,ajaxify.data[c?e:"settings"]=o,typeof i=="function")i(l);else if(l)k.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${l.message}]]`,type:"error",timeout:2500});else{const p=document.getElementById("save");p.classList.toggle("saved",!0),setTimeout(()=>{p.classList.toggle("saved",!1)},1500)}})}},check:function(e){const t=i=>{const n=i.target.closest(".form-group");n&&n.classList.add("has-error"),i.target.removeEventListener("invalid",t)};return Array.prototype.map.call(e,i=>{const n=i.closest(".form-group");return n&&n.classList.remove("has-error"),i.addEventListener("invalid",t),i.reportValidity()}).every(Boolean)}},s.registerReadyJobs(1),Promise.all([d.e(23662),d.e(65285),d.e(19308)]).then(function(){var e=[d(75210),d(474),d(50397),d(71575),d(40054),d(17708),d(46700),d(59175)];(function(){for(let t=0;t<arguments.length;t+=1)r.registerPlugin(arguments[t]);s.beforeReadyJobsDecreased()}).apply(null,e)}).catch(d.oe),r}.apply(F,x),m!==void 0&&(R.exports=m)},24187:(R,F,d)=>{var x,m;x=[d(64061)],m=function(){const y={};y.show=function(s,f){const e=s.hasOwnProperty("fileSize")&&s.fileSize!==void 0?parseInt(s.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:s.hasOwnProperty("showHelp")&&s.showHelp!==void 0?s.showHelp:!0,fileSize:e,title:s.title||"[[global:upload-file]]",description:s.description||"",button:s.button||"[[global:upload]]",accept:s.accept?s.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const i=t.find("#uploadForm");i.attr("action",s.route),i.find("#params").val(JSON.stringify(s.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),i.submit()}),i.submit(function(){return k(t,e,f),!1})})},y.hideAlerts=function(s){$(s).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function k(s,f,e){r(s,"status","[[uploads:uploading-file]]"),s.find("#upload-progress-bar").css("width","0%"),s.find("#upload-progress-box").show().removeClass("hide");const t=s.find("#fileInput");if(!t.val())return r(s,"error","[[uploads:select-file-to-upload]]");if(!S(t[0],f))return r(s,"error","[[error:file-too-big, "+f+"]]");y.ajaxSubmit(s,e)}function r(s,f,e){y.hideAlerts(s),f==="error"&&s.find("#fileUploadSubmitBtn").removeClass("disabled"),e=e.replace(/&amp;#44/g,"&#44"),s.find("#alert-"+f).translateText(e).removeClass("hide")}y.ajaxSubmit=function(s,f){s.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=v(t),r(s,"error",t.responseJSON?.status?.message||t.responseJSON?.error||`[[error:upload-error-fallback, ${t.status} ${t.statusText}]]`)},uploadProgress:function(t,i,n,a){s.find("#upload-progress-bar").css("width",a+"%")},success:function(t){let i=v(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(i=t.response.images),f(i[0].url),r(s,"success","[[uploads:upload-success]]"),setTimeout(function(){y.hideAlerts(s),s.modal("hide")},750)}})};function v(s){if(typeof s=="string")try{return JSON.parse(s)}catch{return{error:"[[error:parse-error]]"}}return s}function S(s,f){return window.FileReader&&f?s.files[0].size<=f*1e3:!0}return y}.apply(F,x),m!==void 0&&(R.exports=m)}}]);
