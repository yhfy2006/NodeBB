"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[49980,24866,26174],{72296:(C,v,a)=>{var g,u;g=[a(89664),a(67308),a(17459),a(65348),a(2954),a(13230),a(49897),a(40027),a(29930),a(54222)],u=function(l,s,E,y,i,e,t,d,n,m){const f={};f.init=function(){const c=$("#group-icon"),r=$("#change-group-user-title"),h=$("#change-group-label-color"),A=$("#change-group-text-color"),L=$("#group-label-preview"),S=$("#group-label-preview-text"),D=ajaxify.data.group.name;$("#group-selector").on("change",function(){ajaxify.go("admin/manage/groups/"+$(this).val()+window.location.hash)}),l.init("admin/manage/group"),r.on("keyup",function(){S.translateText(r.val())}),h.on("keyup input",function(){L.css("background-color",h.val()||"#000000")}),A.on("keyup input",function(){L.css("color",A.val()||"#ffffff")}),o(),$("#group-icon-container").on("click",function(){const b=c.attr("value");s.init(c,function(){let w=c.attr("value");w!==b&&(w==="fa-nbb-none"&&(w="hidden"),$("#group-icon-preview").attr("class","fa fa-fw "+(w||"hidden")),app.flags=app.flags||{},app.flags._unsaved=!0)})}),y.init($('.edit-privileges-selector [component="category-selector"]'),{onSelect:function(b){p(b.cid)},showLinks:!0});const k=y.init($('.member-post-cids-selector [component="category-selector"]'),{onSelect:function(b){let w=($("#memberPostCids").val()||"").split(",").map(x=>parseInt(x,10));return w.push(b.cid),w=w.filter((x,P,T)=>T.indexOf(x)===P),$("#memberPostCids").val(w.join(",")),k.selectCategory(0),!1}});i.init($('[component="group-selector"]')),$("form [data-property]").on("change",function(){app.flags=app.flags||{},app.flags._unsaved=!0}),$('[data-action="delete"]').on("click",function(){d.confirm("[[admin/manage/groups:alerts.confirm-delete]]",function(b){b&&t.del(`/groups/${e(ajaxify.data.group.name)}`,{}).then(()=>{ajaxify.go("/admin/managegroups")}).catch(n.error)})}),$("#save").on("click",function(){return t.put(`/groups/${e(D)}`,{name:$("#change-group-name").val(),userTitle:r.val(),description:$("#change-group-desc").val(),icon:c.attr("value"),labelColor:h.val(),textColor:A.val(),userTitleEnabled:$("#group-userTitleEnabled").is(":checked"),private:$("#group-private").is(":checked"),hidden:$("#group-hidden").is(":checked"),memberPostCids:$("#memberPostCids").val(),disableJoinRequests:$("#group-disableJoinRequests").is(":checked"),disableLeave:$("#group-disableLeave").is(":checked")}).then(()=>{const b=$("#change-group-name").val();D!==b&&ajaxify.go("admin/manage/groups/"+encodeURIComponent(b),void 0,!0),m.toggleSaveSuccess($("#save"))}).catch(n.error),!1})};function o(){$('[component="groups/members"]').on("click","[data-action]",function(){const c=$(this),r=c.parents("[data-uid]"),h=r.find(".member-name .user-owner-icon"),A=!h.hasClass("invisible"),L=r.attr("data-uid");switch(c.attr("data-action")){case"toggleOwnership":t[A?"del":"put"](`/groups/${ajaxify.data.group.slug}/ownership/${L}`,{}).then(()=>{h.toggleClass("invisible")}).catch(n.error);break;case"kick":d.confirm("[[admin/manage/groups:edit.confirm-remove-user]]",function(D){D&&t.del("/groups/"+ajaxify.data.group.slug+"/membership/"+L).then(()=>{r.slideUp().remove()}).catch(n.error)});break;default:break}})}function p(c){if(c){const r="admin/manage/privileges/"+c+"?group="+ajaxify.data.group.nameEncoded;if(app.flags&&app.flags._unsaved===!0){E.translate("[[global:unsaved-changes]]",function(h){d.confirm(h,function(A){A&&(app.flags._unsaved=!1,ajaxify.go(r))})});return}ajaxify.go(r)}}return f}.apply(v,g),u!==void 0&&(C.exports=u)},96349:(C,v,a)=>{var g,u;g=[a(29930),a(89336),a(49897)],u=function(l,s,E){const y={};return y.init=function(i,e){let t=null;e=e||{},e.privilege=e.privilege||"topics:read",e.states=e.states||["watching","tracking","notwatching","ignoring"],e.cacheList=e.hasOwnProperty("cacheList")?e.cacheList:!0;let d=[];Array.isArray(e.localCategories)&&(d=e.localCategories.map(p=>({...p}))),e.selectedCids=e.selectedCids||ajaxify.data.selectedCids||[];const n=i.find('[component="category-selector-search"]');if(!n.length)return;const m=n.parent('[component="category/dropdown"]').length>0||n.parent('[component="category-selector"]').length>0;i.on("show.bs.dropdown",function(){m&&(i.find(".dropdown-toggle").css({visibility:"hidden"}),n.removeClass("hidden"),n.css({"z-index":i.find(".dropdown-toggle").css("z-index")+1}));function p(){const c=n.find("input").val();c.length>1||!c&&!t?f(c,function(r){t=e.cacheList&&(t||r),o(r)}):!c&&t&&o(t)}n.on("click",function(c){c.preventDefault(),c.stopPropagation()}),n.find("input").val("").on("keyup",utils.debounce(p,300)),p()}),i.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||n.find("input").focus()}),i.on("hide.bs.dropdown",function(){m&&(i.find(".dropdown-toggle").css({visibility:"inherit"}),n.addClass("hidden")),n.off("click"),n.find("input").off("keyup")});function f(p,c){E.get("/search/categories",{search:p,query:utils.params(),parentCid:e.parentCid||0,selectedCids:e.selectedCids,privilege:e.privilege,states:e.states,showLinks:e.showLinks},function(r,{categories:h}){if(r)return l.error(r);c(d.concat(h))})}function o(p){const c=e.selectedCids.map(String);p.forEach(function(r){r.selected=c.includes(String(r.cid))}),app.parseAndTranslate(e.template,{categoryItems:p.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(r){i.find('[component="category/list"]').html(r.find('[component="category/list"]').html()),i.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!p.length);const h=s.Dropdown.getInstance(i.find(".dropdown-toggle").get(0));h&&h.update()})}},y}.apply(v,g),u!==void 0&&(C.exports=u)},65348:(C,v,a)=>{var g,u;g=[a(96349),a(40027),a(91749),a(17459)],u=function(l,s,E,y){const i={};return i.init=function(e,t){if(!e||!e.length)return;t=t||{};const d=t.onSelect||function(){};t.states=t.states||["watching","tracking","notwatching","ignoring"],t.template=t.template||"partials/category/selector-dropdown-left",E.fire("action:category.selector.options",{el:e,options:t}),l.init(e,t);const n={el:e,selectedCategory:null};e.on("click","[data-cid]",function(){const f=$(this);return f.hasClass("disabled")?!1:(n.selectCategory(f.attr("data-cid")),d(n.selectedCategory))});let m=n.el.find('[component="category-selector-selected"]').html();return y.translate(m,f=>{m=f}),n.selectCategory=function(f){const o=n.el.find('[data-cid="'+f+'"]');n.selectedCategory={cid:f,name:o.attr("data-name")},o.length?n.el.find('[component="category-selector-selected"]').html(o.find('[component="category-markup"]').html()):n.el.find('[component="category-selector-selected"]').html(m)},n.getSelectedCategory=function(){return n.selectedCategory},n.getSelectedCid=function(){return n.selectedCategory?n.selectedCategory.cid:0},t.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(t.template,{selectedCategory:t.selectedCategory},function(f){n.el.find('[component="category-selector-selected"]').html(f.find('[component="category-selector-selected"]').html())}),n},i.modal=function(e){e=e||{},e.onSelect=e.onSelect||function(){},e.onSubmit=e.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:e.message},function(t){const d=s.dialog({title:e.title||"[[modules:composer.select-category]]",message:t,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:m}}}),n=i.init(d.find('[component="category-selector"]'),e);function m(f){return f.preventDefault(),n.selectedCategory&&(e.onSubmit(n.selectedCategory),d.modal("hide")),!1}e.openOnLoad&&d.on("shown.bs.modal",function(){d.find(".dropdown-toggle").dropdown("toggle")}),d.find("form").on("submit",m)})},i}.apply(v,g),u!==void 0&&(C.exports=u)},2954:(C,v,a)=>{var g;g=function(){const u={};return u.init=function(l){if(utils.isTouchDevice())return;const s=l.find('[component="group-selector-search"]');if(!s.length)return;const E=s.parent('[component="group-selector"]').length>0,y=l.find('[component="group-list"] [data-name]');l.on("show.bs.dropdown",function(){function i(){const e=s.find("input").val().toLowerCase();let t=!0;y.each(function(){const d=$(this),n=d.attr("data-name").toLowerCase().indexOf(e)!==-1;t&&n&&(t=!1),d.toggleClass("hidden",!n)}),l.find('[component="group-list"] [component="group-no-matches"]').toggleClass("hidden",!t)}E&&(l.find(".dropdown-toggle").css({visibility:"hidden"}),s.removeClass("hidden"),s.css({"z-index":l.find(".dropdown-toggle").css("z-index")+1})),s.on("click",function(e){e.preventDefault(),e.stopPropagation()}),s.find("input").val("").on("keyup",i),i()}),l.on("shown.bs.dropdown",function(){s.find("input").focus()}),l.on("hide.bs.dropdown",function(){E&&(l.find(".dropdown-toggle").css({visibility:"inherit"}),s.addClass("hidden")),s.off("click").find("input").off("keyup")})},u}.call(v,a,v,C),g!==void 0&&(C.exports=g)},13230:(C,v,a)=>{var g,u,l;(function(s){u=[a(53050)],g=s,l=typeof g=="function"?g.apply(v,u):g,l!==void 0&&(C.exports=l)})(function(s){const E=s("[^\\p{L}\\s\\d\\-_]","g"),y=/[^\w\s\d\-_]/g,i=/^\s+|\s+$/g,e=/\s+/g,t=/-+/g,d=/-$/g,n=/^-/g,m=/^[\w\d\s.,\-@]+$/;return function(o,p){return o?(o=String(o).replace(i,""),m.test(o)?o=o.replace(y,"-"):o=s.replace(o,E,"-"),o=p?o:o.toLocaleLowerCase(),o=o.replace(e,"-"),o=o.replace(t,"-"),o=o.replace(d,""),o=o.replace(n,""),o):""}})}}]);
