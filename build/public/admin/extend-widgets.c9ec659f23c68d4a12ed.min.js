(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6871],{92701:(y,x,g)=>{"use strict";var w,b;w=[g(40027),g(29930),g(65285),g(41758),g(79914),g(83431)],b=function(A,a){const e={};e.init=function(){$("#widgets .dropdown .dropdown-menu a").on("click",function(r){const l=$(this);$("#widgets .tab-pane").removeClass("active");const s=l.attr("data-template");return $('#widgets .tab-pane[data-template="'+s+'"]').addClass("active"),$("#widgets .selected-template").text(s),$("#widgets .dropdown").trigger("click"),r.preventDefault(),!1}),$("#widget-selector").on("change",function(){$(".available-widgets [data-widget]").addClass("hide"),$('.available-widgets [data-widget="'+$(this).val()+'"]').removeClass("hide")}),$("#widget-selector").trigger("change"),o(),f(),$("#hide-drafts").on("click",function(){$(this).addClass("hidden"),$("#show-drafts").removeClass("hidden"),$('[component="drafts-container"]').addClass("hidden"),$('[component="widgets-container"]').addClass("col-md-12").removeClass("col-md-6")}),$("#show-drafts").on("click",function(){$(this).addClass("hidden"),$("#hide-drafts").removeClass("hidden"),$('[component="drafts-container"]').removeClass("hidden"),$('[component="widgets-container"]').addClass("col-md-6").removeClass("col-md-12")})};function t(){const r=$('[component="drafts-container"]');$('[data-location="drafts"]').appendTo(r),$("#widgets .available-widgets .widget-panel").draggable({helper:function(s){return $(s.target).parents(".widget-panel").clone()},distance:10,connectToSortable:".widget-area"}),$("#widgets .available-containers .containers > [data-container-html]").draggable({helper:function(s){let n=$(s.target);return n=n.attr("data-container-html")?n:n.parents("[data-container-html]"),n.clone().addClass("block").width(n.width()).css("opacity","0.5")},distance:10}).each(function(){$(this).attr("data-container-html",$(this).attr("data-container-html").replace(/\\\{([\s\S]*?)\\\}/g,"{$1}"))}),$("#widgets .widget-area").sortable({update:function(s,n){i(n.item),d(n.item)},start:function(){r.find('[data-location="drafts"]>div').removeClass("overflow-auto").css({"max-height":"initial"})},stop:function(){r.find('[data-location="drafts"]>div').addClass("overflow-auto").css({"max-height":"calc(100vh - 200px)"})},connectWith:"div"}).on("click",".delete-widget",function(){const s=$(this).parents(".widget-panel");A.confirm("[[admin/extend/widgets:alert.confirm-delete]]",function(n){n&&s.remove()})}).on("mouseup","> .card > .card-header",function(s){$(this).parent().is(".ui-sortable-helper")||$(s.target).closest(".delete-widget").length||$(this).parent().children(".card-body").toggleClass("hidden")}),$("#save").on("click",l);function l(){const s=[];$("#widgets [data-template][data-location]").each(function(n,c){c=$(c);const h=c.attr("data-template"),u=c.attr("data-location"),_=c.children(".widget-area"),p=[];_.find(".widget-panel[data-widget]").each(function(){const v={},m=$(this).find("form").serializeArray();for(const C in m)m.hasOwnProperty(C)&&m[C].name&&(v[m[C].name]?(Array.isArray(v[m[C].name])||(v[m[C].name]=[v[m[C].name]]),v[m[C].name].push(m[C].value)):v[m[C].name]=m[C].value);p.push({widget:$(this).attr("data-widget"),data:v})}),s.push({template:h,location:u,widgets:p})}),socket.emit("admin.widgets.set",s,function(n){if(n)return a.error(n);const c=document.getElementById("save");c.classList.toggle("saved",!0),setTimeout(()=>{c.classList.toggle("saved",!1)},5e3)})}$(".color-selector").on("click",".btn",function(){const s=$(this),n=s.parents(".color-selector"),c=n.parents("[data-container-html]"),h=[];n.children().each(function(){h.push($(this).attr("data-class"))}),c.removeClass(h.join(" ")).addClass(s.attr("data-class")),c.attr("data-container-html",c.attr("data-container-html").replace(/class="[a-zA-Z0-9-\s]+"/,'class="'+c[0].className.replace(" pointer ui-draggable ui-draggable-handle","")+'"'))})}function i(r){const l=new Date().getFullYear();r.find(".date-selector").datepicker({changeMonth:!0,changeYear:!0,yearRange:l+":"+(l+100)})}function d(r){r.hasClass("block")||r.addClass("block").css("width","").css("height","").droppable({accept:"[data-container-html]",drop:function(l,s){const n=$(this);n.find(".card-body .container-html").val(s.draggable.attr("data-container-html")),n.find(".card-body").removeClass("hidden")},hoverClass:"container-hover"}).children(".card-header").append('<div class="float-end pointer"><span class="delete-widget"><i class="fa fa-times-circle"></i></span></div><div class="float-start pointer"><span class="toggle-widget"><i class="fa fa-chevron-circle-down"></i></span>&nbsp;</div>').children("small").html("")}function o(){function r(l,s){if(s.title){const n=l.find(".card-header strong");n.text(n.text()+" - "+s.title)}return l.find("input, textarea, select").each(function(){const n=$(this),c=s[n.attr("name")];n.attr("type")==="checkbox"?n.prop("checked",!!c).trigger("change"):n.val(c)}),l}$.get(config.relative_path+"/api/admin/extend/widgets",function(l){const s=l.areas;for(let n=0;n<s.length;n+=1){const c=s[n],h=$('#widgets .area[data-template="'+c.template+'"][data-location="'+c.location+'"]').find(".widget-area");h.html("");for(let u=0;u<c.data.length;u+=1){const _=c.data[u],p=$('.available-widgets [data-widget="'+_.widget+'"]').clone(!0).removeClass("hide");h.append(r(p,_.data)),d(p),i(p)}}t()})}function f(){const r=$('[component="clone"]'),l=$('[component="clone/button"]');r.find(".dropdown-menu li").on("click",function(){const s=$(this).find("a").text();l.translateHtml("[[admin/extend/widgets:clone-from]] <strong>"+s+"</strong>"),l.attr("data-template",s)}),l.on("click",function(){const s=l.attr("data-template");if(!s)return a.error("[[admin/extend/widgets:error.select-clone]]");const n=$("#active-widgets .active.tab-pane[data-template] .area"),c=$('#active-widgets .tab-pane[data-template="'+s+'"] .area'),h=n.map(function(){return $(this).attr("data-location")}).get(),u=c.map(function(){const p=$(this).attr("data-location");return h.indexOf(p)!==-1?p:void 0}).get().filter(function(p){return p});function _(p){$('#active-widgets .tab-pane[data-template="'+s+'"] [data-location="'+p+'"]').each(function(){$(this).find("[data-widget]").each(function(){const v=$(this).clone(!0);$('#active-widgets .active.tab-pane[data-template]:not([data-template="global"]) [data-location="'+p+'"] .widget-area').append(v)})})}for(let p=0,v=u.length;p<v;p++){const m=u[p];_(m)}a.success("[[admin/extend/widgets:alert.clone-success]]")})}return e}.apply(x,w),b!==void 0&&(y.exports=b)},79914:(y,x,g)=>{var w,b,A;/*!
* jQuery UI Droppable 1.13.2
* http://jqueryui.com
*
* Copyright jQuery Foundation and other contributors
* Released under the MIT license.
* http://jquery.org/license
*/(function(a){"use strict";b=[g(74692),g(41758),g(23662),g(56883),g(69139)],w=a,A=typeof w=="function"?w.apply(x,b):w,A!==void 0&&(y.exports=A)})(function(a){"use strict";return a.widget("ui.droppable",{version:"1.13.2",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,i=t.accept;this.isover=!1,this.isout=!0,this.accept=typeof i=="function"?i:function(d){return d.is(i)},this.proportions=function(){if(arguments.length)e=arguments[0];else return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(t.scope),t.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){a.ui.ddmanager.droppables[e]=a.ui.ddmanager.droppables[e]||[],a.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=a.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,t){if(e==="accept")this.accept=typeof t=="function"?t:function(d){return d.is(t)};else if(e==="scope"){var i=a.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=a.ui.ddmanager.current;this._addActiveClass(),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=a.ui.ddmanager.current;this._removeActiveClass(),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=a.ui.ddmanager.current;!t||(t.currentItem||t.element)[0]===this.element[0]||this.accept.call(this.element[0],t.currentItem||t.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=a.ui.ddmanager.current;!t||(t.currentItem||t.element)[0]===this.element[0]||this.accept.call(this.element[0],t.currentItem||t.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(t)))},_drop:function(e,t){var i=t||a.ui.ddmanager.current,d=!1;return!i||(i.currentItem||i.element)[0]===this.element[0]||(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var o=a(this).droppable("instance");if(o.options.greedy&&!o.options.disabled&&o.options.scope===i.options.scope&&o.accept.call(o.element[0],i.currentItem||i.element)&&a.ui.intersect(i,a.extend(o,{offset:o.element.offset()}),o.options.tolerance,e))return d=!0,!1}),d)?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(i)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),a.ui.intersect=function(){function e(t,i,d){return t>=i&&t<i+d}return function(t,i,d,o){if(!i.offset)return!1;var f=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,l=f+t.helperProportions.width,s=r+t.helperProportions.height,n=i.offset.left,c=i.offset.top,h=n+i.proportions().width,u=c+i.proportions().height;switch(d){case"fit":return n<=f&&l<=h&&c<=r&&s<=u;case"intersect":return n<f+t.helperProportions.width/2&&l-t.helperProportions.width/2<h&&c<r+t.helperProportions.height/2&&s-t.helperProportions.height/2<u;case"pointer":return e(o.pageY,c,i.proportions().height)&&e(o.pageX,n,i.proportions().width);case"touch":return(r>=c&&r<=u||s>=c&&s<=u||r<c&&s>u)&&(f>=n&&f<=h||l>=n&&l<=h||f<n&&l>h);default:return!1}}}(),a.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var i,d,o=a.ui.ddmanager.droppables[e.options.scope]||[],f=t?t.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(i=0;i<o.length;i++)if(!(o[i].options.disabled||e&&!o[i].accept.call(o[i].element[0],e.currentItem||e.element))){for(d=0;d<r.length;d++)if(r[d]===o[i].element[0]){o[i].proportions().height=0;continue t}o[i].visible=o[i].element.css("display")!=="none",o[i].visible&&(f==="mousedown"&&o[i]._activate.call(o[i],t),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(e,t){var i=!1;return a.each((a.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(e,this,this.options.tolerance,t)&&(i=this._drop.call(this,t)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))}),i},dragStart:function(e,t){e.element.parentsUntil("body").on("scroll.droppable",function(){e.options.refreshPositions||a.ui.ddmanager.prepareOffsets(e,t)})},drag:function(e,t){e.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(e,t),a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var i,d,o,f=a.ui.intersect(e,this,this.options.tolerance,t),r=!f&&this.isover?"isout":f&&!this.isover?"isover":null;r&&(this.options.greedy&&(d=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return a(this).droppable("instance").options.scope===d}),o.length&&(i=a(o[0]).droppable("instance"),i.greedyChild=r==="isover")),i&&r==="isover"&&(i.isover=!1,i.isout=!0,i._out.call(i,t)),this[r]=!0,this[r==="isout"?"isover":"isout"]=!1,this[r==="isover"?"_over":"_out"].call(this,t),i&&r==="isout"&&(i.isout=!1,i.isover=!0,i._over.call(i,t)))}})},dragStop:function(e,t){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||a.ui.ddmanager.prepareOffsets(e,t)}},a.uiBackCompat!==!1&&a.widget("ui.droppable",a.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),a.ui.droppable})}}]);
