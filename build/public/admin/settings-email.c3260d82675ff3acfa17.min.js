"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[38259,97960],{49589:(D,_,e)=>{var s,d;s=[e(32222),e(29930),e(54222)],d=function(r,c){const m={};let n;m.init=function(){v(),u(),l(),$(window).off("action:admin.settingsLoaded",E).on("action:admin.settingsLoaded",E),$(window).off("action:admin.settingsSaved",f).on("action:admin.settingsSaved",f)};function E(){l(),h()}function f(){l(),socket.emit("admin.user.restartJobs")}function v(){$('button[data-action="email.test"]').off("click").on("click",function(){return socket.emit("admin.email.test",{template:$("#test-email").val()},function(t){if(t)return console.error(t.message),c.error(t);c.success("Test Email Sent")}),!1})}function u(){$("#email-editor-selector").on("change",g),n=r.edit("email-editor"),n.$blockScrolling=1/0,n.setTheme("ace/theme/twilight"),n.getSession().setMode("ace/mode/html"),n.on("change",function(){const t=$("#email-editor-selector").val();let i;ajaxify.data.emails.forEach(function(o){o.path===t&&(i=o.original)});const a=n.getValue();$("#email-editor-holder").val(a!==i?a:"")}),$('button[data-action="email.revert"]').off("click").on("click",function(){ajaxify.data.emails.forEach(function(t){t.path===$("#email-editor-selector").val()&&(n.getSession().setValue(t.original),$("#email-editor-holder").val(""))})}),g()}function g(){ajaxify.data.emails.forEach(function(t){t.path===$("#email-editor-selector").val()&&(n.getSession().setValue(t.text),$("#email-editor-holder").val(t.text!==t.original?t.text:"").attr("data-field","email:custom:"+t.path))})}function l(){let t=parseInt($("#digestHour").val(),10);isNaN(t)?t=17:(t>23||t<0)&&(t=0),socket.emit("admin.getServerTime",{},function(i,a){if(i)return c.error(i);const o=new Date(a.timestamp),M=(new Date().getTimezoneOffset()-a.offset)/60;o.setHours(o.getHours()+M),$("#serverTime").text(o.toLocaleTimeString()),o.setHours(parseInt(t,10)-M,0,0,0),o.getTime()<Date.now()&&o.setDate(o.getDate()+1),$("#nextDigestTime").text(o.toLocaleString())})}function h(){function t(){const i=$('[id="email:smtpTransport:service"]').val()==="nodebb-custom-smtp";$('[id="email:smtpTransport:custom-service"]')[i?"slideDown":"slideUp"](i)}t(),$('[id="email:smtpTransport:service"]').change(function(){t();const i=document.getElementById("email:smtpTransport:enabled");i&&(i.checked||(i.checked=!0,c.alert({message:"[[admin/settings/email:smtp-transport.auto-enable-toast]]",timeout:5e3})))})}return m}.apply(_,s),d!==void 0&&(D.exports=d)},32222:(D,_,e)=>{e.r(_);var s=e(80952),d=e.n(s),r={};for(const o in s)o!=="default"&&(r[o]=()=>s[o]);e.d(_,r);var c=e(1766),m=e.n(c),n=e(79869),E=e.n(n),f=e(29072),v=e.n(f),u=e(55208),g=e.n(u),l=e(57031),h=e.n(l),t=e(91929),i=e(30827),a=e(71385);ace.config.setModuleUrl("ace/mode/html_worker",t.A),ace.config.setModuleUrl("ace/mode/javascript_worker",i.A),ace.config.setModuleUrl("ace/mode/css_worker",a.A)}}]);
