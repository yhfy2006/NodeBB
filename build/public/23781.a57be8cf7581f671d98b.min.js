(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[23781,99127,34271,1091,46379,92332,88189,6232,18732,25432,15794,26174,87212,33069,62441,98463,49897,29567,49775,11484,23346],{49897:(y,E,l)=>{"use strict";l.r(E),l.d(E,{del:()=>r,get:()=>u,head:()=>m,patch:()=>e,post:()=>g,put:()=>t});var h=l(91749),v=l.n(h),p=l(40027),f=l.n(p);const n=config.relative_path+"/api/v3";async function c(o,s){if(o.url=o.url.startsWith("/api")?config.relative_path+o.url:n+o.url,typeof s=="function"){b(o).then(a=>s(null,a),a=>s(a));return}try{return await b(o)}catch(a){if(a.message==="A valid login session was not found. Please log in and try again.")return(0,p.confirm)("[[error:api.reauth-required]]",x=>{x&&ajaxify.go("login")});throw a}}async function b(o){const{url:s}=o;delete o.url,o.data&&!(o.data instanceof FormData)&&(o.data=JSON.stringify(o.data||{}),o.headers["content-type"]="application/json; charset=utf-8"),{options:o}=await(0,h.fire)("filter:api.options",{options:o}),o.data&&(o.body=o.data,delete o.data);const a=await fetch(s,o),{headers:x}=a,A=x.get("content-type"),k=A&&A.startsWith("application/json");let w;if(o.method!=="head"&&(k?w=await a.json():w=await a.text()),!a.ok)throw w?new Error(k?w.status.message:w):new Error(a.statusText);return k&&w&&w.hasOwnProperty("status")&&w.hasOwnProperty("response")?w.response:w}function u(o,s,a){return c({url:o+(s&&Object.keys(s).length?"?"+$.param(s):"")},a)}function m(o,s,a){return c({url:o+(s&&Object.keys(s).length?"?"+$.param(s):""),method:"head"},a)}function g(o,s,a){return c({url:o,method:"post",data:s,headers:{"x-csrf-token":config.csrf_token}},a)}function e(o,s,a){return c({url:o,method:"patch",data:s,headers:{"x-csrf-token":config.csrf_token}},a)}function t(o,s,a){return c({url:o,method:"put",data:s,headers:{"x-csrf-token":config.csrf_token}},a)}function r(o,s,a){return c({url:o,method:"delete",data:s,headers:{"x-csrf-token":config.csrf_token}},a)}},74566:(y,E,l)=>{y.exports=l(12236)},449:(y,E,l)=>{y.exports=l(91943)},89596:(y,E,l)=>{y.exports=l(62590)},99594:(y,E,l)=>{y.exports=l(57904)},29869:y=>{"use strict";y.exports=function(E,l,h){l.setGlobal("true",!0),l.setGlobal("false",!1);const v=24*60*60*1e3,p={displayMenuItem:n,buildMetaTag:c,buildLinkTag:b,stringify:u,escape:m,stripTags:g,buildCategoryIcon:e,buildCategoryLabel:t,generateCategoryBackground:r,generateChildrenCategories:o,generateTopicClass:s,membershipBtn:a,spawnPrivilegeStates:x,localeToHTML:A,renderTopicImage:k,renderDigestAvatar:w,userAgentIcons:I,buildAvatar:D,increment:F,generateRepliedTo:M,generateWrote:U,isoTimeToLocaleString:O,shouldHideReplyContainer:B,humanReadableNumber:T,formattedNumber:W,register:C,__escape:f};function f(i){return i}function n(i,d){const S=i.navigation[d];return!(!S||S.route.match("/users")&&i.user&&!i.user.privileges["view:users"]||S.route.match("/tags")&&i.user&&!i.user.privileges["view:tags"]||S.route.match("/groups")&&i.user&&!i.user.privileges["view:groups"])}function c(i){const d=i.name?'name="'+i.name+'" ':"",S=i.property?'property="'+i.property+'" ':"",R=i.content?'content="'+i.content.replace(/\n/g," ")+'" ':"";return"<meta "+d+S+R+`/>
	`}function b(i){const d=["link","rel","as","type","href","sizes","title","crossorigin"],[S,R,P,L,z,H,N,Y]=d.map(K=>i[K]?`${K}="${i[K]}" `:"");return"<link "+S+R+P+L+H+N+z+Y+`/>
	`}function u(i){return JSON.stringify(i).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function m(i){return E.escapeHTML(i)}function g(i){return E.stripHTMLTags(i)}function e(i,d,S){return i?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${S}" style="${r(i)} width:${d}; height: ${d}; font-size: ${parseInt(d,10)/2}px;">${i.icon?`<i class="fa fa-fw ${i.icon}"></i>`:""}</span>`:""}function t(i,d="a",S=""){if(!i)return"";const R=d==="a"?`href="${h}/category/${i.slug}"`:"";return`<${d} ${R} class="badge px-1 text-truncate text-decoration-none ${S}" style="color: ${i.color};background-color: ${i.bgColor};border-color: ${i.bgColor}!important; max-width: 70vw;">
			${i.icon&&i.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${i.icon}"></i>`:""}
			${i.name}
		</${d}>`}function r(i){if(!i)return"";const d=[];return i.bgColor&&(d.push("background-color: "+i.bgColor),d.push(`border-color: ${i.bgColor}!important`)),i.color&&d.push("color: "+i.color),i.backgroundImage&&(d.push("background-image: url("+i.backgroundImage+")"),i.imageClass&&d.push("background-size: "+i.imageClass)),d.join("; ")+";"}function o(i){let d="";return!i||!i.children||!i.children.length||(i.children.forEach(function(S){if(S&&!S.isSection){const R=S.link?S.link:h+"/category/"+S.slug;d+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+r(S)+'"><i class="fa fa-fw '+S.icon+'"></i></div><a href="'+R+'"><small>'+S.name+"</small></a></span>"}}),d=d&&'<span class="category-children">'+d+"</span>"),d}function s(i){return["locked","pinned","deleted","unread","scheduled"].filter(S=>!!i[S]).join(" ")}function a(i,d=""){return i.isMember&&i.name!=="administrators"?`<button class="btn btn-danger ${d}" data-action="leave" data-group="${i.displayName}" ${i.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:i.isPending&&i.name!=="administrators"?`<button class="btn btn-warning disabled ${d}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:i.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${i.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${i.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!i.disableJoinRequests&&i.name!=="administrators"?`<button class="btn btn-success ${d}" data-action="join" data-group="${i.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function x(i,d,S){const R=[];for(const P in d)d.hasOwnProperty(P)&&R.push({name:P,state:d[P],type:S[P]});return R.map(function(P){const L=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],z=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],H=["groups:moderate"],N=i==="guests"&&(L.includes(P.name)||P.name.startsWith("groups:admin:"))||i==="spiders"&&!z.includes(P.name)||i==="Global Moderators"&&H.includes(P.name);return`
				<td data-privilege="${P.name}" data-value="${P.state}" data-type="${P.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none" autocomplete="off" type="checkbox"${P.state?" checked":""}${N?' disabled="disabled"':""} />
					</div>
				</td>
			`}).join("")}function A(i,d){return i=i||d||"en-GB",i.replace("_","-")}function k(i){return i.thumb?'<img src="'+i.thumb+'" class="img-circle user-img" title="'+i.user.username+'" />':'<img component="user/picture" data-uid="'+i.user.uid+'" src="'+i.user.picture+'" class="user-img" title="'+i.user.username+'" />'}function w(i){return i.teaser?i.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+i.teaser.user.picture+'" title="'+i.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+i.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+i.teaser.user["icon:text"]+"</div>":i.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+i.user.picture+'" title="'+i.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+i.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+i.user["icon:text"]+"</div>"}function I(i){let d="";switch(i.platform){case"Linux":d+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":d+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":d+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":d+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":d+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":d+='<i class="fa fa-fw fa-mobile"></i>';break;default:d+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(i.browser){case"Chrome":d+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":d+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":d+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":d+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":d+='<i class="fa fa-fw fa-edge"></i>';break;default:d+='<i class="fa fa-fw fa-question-circle"></i>';break}return d}function D(i,d,S,R,P){i||(i=this);const L=new Map([["alt",i.username],["title",i.username],["data-uid",i.uid],["loading","lazy"],["aria-label",`[[aria:user-avatar-for, ${i.username}]]`]]),z=[`--avatar-size: ${d};`],H=Y=>Array.from(Y).reduce((K,[J,j])=>(K+=` ${J}="${j}"`,K),"");R=R||"",L.set("class",`avatar ${R}${S?" avatar-rounded":""}`);let N="";return i.picture&&(L.set("component",P||"avatar/picture"),N+="<img "+H(L)+' src="'+i.picture+'" style="'+z.join(" ")+'" onError="this.remove();" itemprop="image" />'),L.set("component",P||"avatar/icon"),z.push("background-color: "+i["icon:bgColor"]+";"),N+="<span "+H(L)+' style="'+z.join(" ")+'">'+i["icon:text"]+"</span>",N}function F(i,d){return String(i+parseInt(d,10))}function M(i,d){const S=i.parent&&i.parent.displayname?i.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${i.timestamp<Date.now()-d*v?"on":"ago"}, ${i.toPid}, ${h}/post/${i.toPid}, ${S}, ${h}/post/${i.pid}, ${i.timestampISO}]]`}function U(i,d){return`[[topic:wrote-${i.timestamp<Date.now()-d*v?"on":"ago"}, ${h}/post/${i.pid}, ${i.timestampISO}]]`}function O(i,d="en-GB"){return new Date(i).toLocaleString([d],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function B(i){return!!(i.replies.count<=0||i.replies.hasSingleImmediateReply)}function T(i,d=1){return E.makeNumberHumanReadable(i,d)}function W(i){return E.addCommas(i)}function C(){Object.keys(p).forEach(function(i){l.registerHelper(i,p[i])})}return p}},30076:(y,E,l)=>{"use strict";var h,v;const p=l(29869);h=[l(77918),l(81335)],v=function(f,n){return p(f,n,config.relative_path)}.apply(E,h),v!==void 0&&(y.exports=v)},13230:(y,E,l)=>{"use strict";var h,v,p;(function(f){v=[l(53050)],h=f,p=typeof h=="function"?h.apply(E,v):h,p!==void 0&&(y.exports=p)})(function(f){const n=f("[^\\p{L}\\s\\d\\-_]","g"),c=/[^\w\s\d\-_]/g,b=/^\s+|\s+$/g,u=/\s+/g,m=/-+/g,g=/-$/g,e=/^-/g,t=/^[\w\d\s.,\-@]+$/;return function(o,s){return o?(o=String(o).replace(b,""),t.test(o)?o=o.replace(c,"-"):o=f.replace(o,n,"-"),o=s?o:o.toLocaleLowerCase(),o=o.replace(u,"-"),o=o.replace(m,"-"),o=o.replace(g,""),o=o.replace(e,""),o):""}})},68636:(y,E,l)=>{"use strict";var h;h=function(){function v(){this._store={},this._keys=[]}v.prototype.isMock=!0,v.prototype.setItem=function(n,c){n=String(n),this._keys.indexOf(n)===-1&&this._keys.push(n),this._store[n]=c},v.prototype.getItem=function(n){return n=String(n),this._keys.indexOf(n)===-1?null:this._store[n]},v.prototype.removeItem=function(n){n=String(n),this._keys=this._keys.filter(function(c){return c!==n}),this._store[n]=null},v.prototype.clear=function(){this._keys=[],this._store={}},v.prototype.key=function(n){return n=parseInt(n,10)||0,this._keys[n]},Object.defineProperty&&Object.defineProperty(v.prototype,"length",{get:function(){return this._keys.length}});let p;const f=Date.now().toString();try{if(p=window.localStorage,p.setItem(f,f),p.getItem(f)!==f)throw Error("localStorage behaved unexpectedly");return p.removeItem(f),p}catch(n){console.warn(n),console.warn("localStorage failed, falling back on sessionStorage");try{if(p=window.sessionStorage,p.setItem(f,f),p.getItem(f)!==f)throw Error("sessionStorage behaved unexpectedly");return p.removeItem(f),p}catch(c){return console.warn(c),console.warn("sessionStorage failed, falling back on memory storage"),new v}}}.call(E,l,E,y),h!==void 0&&(y.exports=h)},14063:(y,E,l)=>{"use strict";y=l.nmd(y);var h,v;h=[l(17459),l(91749)],v=function(p,f){const n={};let c=!1;n.init=function(){if(n.taskbar=$('[component="taskbar"]'),n.tasklist=n.taskbar.find("ul"),!n.taskbar.length||!n.tasklist.length){c=!0;return}n.taskbar.on("click","li",async function(){const e=$(this),t=e.attr("data-module"),r=e.attr("data-uuid"),o=await app.require(t);return e.hasClass("active")?o.minimize(r):(u(),o.load(r),n.toggleNew(r,!1),n.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){n.closeAll()})},n.close=async function(e,t){if(c)return;if(n.tasklist.find('[data-module="'+y+'"][data-uuid="'+t+'"]').length){const o=await app.require(e);o&&typeof o.close=="function"&&o.close(t)}},n.closeAll=function(e){if(c)return;let t="[data-uuid]";e&&(t='[data-module="'+e+'"]'+t),n.tasklist.find(t).each(function(r,o){n.close(e||o.getAttribute("data-module"),o.getAttribute("data-uuid"))})},n.discard=function(e,t){if(c)return;n.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').remove(),b()},n.push=function(e,t,r,o){if(o=o||function(){},c)return o();const s=n.tasklist.find('li[data-uuid="'+t+'"]'),a={module:e,uuid:t,options:r,element:s};f.fire("filter:taskbar.push",a),!s.length&&a.module?m(a,o):o(s)},n.get=function(e){return c?[]:$('[data-module="'+e+'"]').map(function(r,o){return $(o).data()})},n.minimize=function(e,t){if(c)return;n.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').toggleClass("active",!1)},n.toggleNew=function(e,t,r){if(c)return;n.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",t),r||f.fire("action:taskbar.toggleNew",e)},n.updateActive=function(e){if(c)return;const t=n.tasklist.find("li");t.removeClass("active"),t.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},n.isActive=function(e){return c?!1:n.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function b(){if(c)return;n.tasklist.find("li").length>0?n.taskbar.attr("data-active","1"):n.taskbar.removeAttr("data-active")}function u(){c||n.tasklist.find(".active").removeClass("active")}function m(e,t){if(c)return t();p.translate(e.options.title,function(r){const o=$("<div></div>").text(r||"NodeBB Task").html(),s=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+o+'" component="taskbar/title">'+o+"</span></a>").attr({title:o,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&u(),n.tasklist.append(s),b(),e.element=s,s.data(e),f.fire("action:taskbar.pushed",e),t(s)})}const g=function(e,t,r){switch(t){case"title":e.find('[component="taskbar/title"]').text(r);break;case"icon":e.find("i").attr("class","fa fa-"+r);break;case"image":e.find("a").css("background-image",r?'url("'+r.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",r);break;case"color":e.find("a").css("color",r);break}};return n.update=function(e,t,r){if(c)return;const o=n.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]');if(!o.length)return;const s=o.data();Object.keys(r).forEach(function(a){s[a]=r[a],g(o,a,r[a])}),o.data(s)},n}.apply(E,h),v!==void 0&&(y.exports=v)},36159:(y,E,l)=>{"use strict";var h,v;h=[l(49897),l(40027),l(29930),l(24187),l(81335),l(17459),l(65285)],v=function(p,f,n,c,b,u){const m={};return m.get=g=>p.get(`/topics/${g}/thumbs`,{}),m.getByPid=g=>p.get(`/posts/${g}`,{}).then(e=>m.get(e.tid)),m.delete=(g,e)=>p.del(`/topics/${g}/thumbs`,{path:e}),m.deleteAll=g=>{m.get(g).then(e=>{Promise.all(e.map(t=>m.delete(g,t.url)))})},m.upload=g=>new Promise(e=>{c.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${g}/thumbs`},function(t){e(t)})}),m.modal={},m.modal.open=function(g){const{id:e,pid:t}=g;let{modal:r}=g,o;return new Promise(s=>{Promise.all([m.get(e),t?m.getByPid(t):[]]).then(a=>new Promise(x=>{const A=a.reduce((k,w)=>k.concat(w));o=A.length,x(A)})).then(a=>b.render("modals/topic-thumbs",{thumbs:a})).then(a=>{r?u.translate(a,function(x){r.find(".bootbox-body").html(x),m.modal.handleSort({modal:r,numThumbs:o})}):(r=f.dialog({title:"[[modules:thumbs.modal.title]]",message:a,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(m.upload(e).then(()=>{m.modal.open({...g,modal:r}),Promise.all([l.e(54516),l.e(99166),l.e(47061),l.e(49775)]).then(function(){var x=[l(71431)];(A=>{A.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),s()}).apply(null,x)}).catch(l.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),m.modal.handleDelete({...g,modal:r}),m.modal.handleSort({modal:r,numThumbs:o}))})})},m.modal.handleDelete=g=>{g.modal.get(0).addEventListener("click",t=>{t.target.closest('button[data-action="remove"]')&&f.confirm("[[modules:thumbs.modal.confirm-remove]]",r=>{if(!r)return;const o=t.target.closest("[data-id]").getAttribute("data-id"),s=t.target.closest("[data-path]").getAttribute("data-path");p.del(`/topics/${o}/thumbs`,{path:s}).then(()=>{m.modal.open(g)}).catch(n.error)})})},m.modal.handleSort=({modal:g,numThumbs:e})=>{if(e>1){const t=g.find(".topic-thumbs-modal");t.sortable({items:"[data-id]"}),t.on("sortupdate",m.modal.handleSortChange)}},m.modal.handleSortChange=(g,e)=>{const t=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(t).forEach((r,o)=>{const s=r.getAttribute("data-id");let a=r.getAttribute("data-path");a=a.replace(new RegExp(`^${config.upload_url}`),""),p.put(`/topics/${s}/thumbs/order`,{path:a,order:o}).catch(n.error)})},m}.apply(E,h),v!==void 0&&(y.exports=v)},24187:(y,E,l)=>{"use strict";var h,v;h=[l(64061)],v=function(){const p={};p.show=function(u,m){const g=u.hasOwnProperty("fileSize")&&u.fileSize!==void 0?parseInt(u.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:u.hasOwnProperty("showHelp")&&u.showHelp!==void 0?u.showHelp:!0,fileSize:g,title:u.title||"[[global:upload-file]]",description:u.description||"",button:u.button||"[[global:upload]]",accept:u.accept?u.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const t=e.find("#uploadForm");t.attr("action",u.route),t.find("#params").val(JSON.stringify(u.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),t.submit()}),t.submit(function(){return f(e,g,m),!1})})},p.hideAlerts=function(u){$(u).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function f(u,m,g){n(u,"status","[[uploads:uploading-file]]"),u.find("#upload-progress-bar").css("width","0%"),u.find("#upload-progress-box").show().removeClass("hide");const e=u.find("#fileInput");if(!e.val())return n(u,"error","[[uploads:select-file-to-upload]]");if(!b(e[0],m))return n(u,"error","[[error:file-too-big, "+m+"]]");p.ajaxSubmit(u,g)}function n(u,m,g){p.hideAlerts(u),m==="error"&&u.find("#fileUploadSubmitBtn").removeClass("disabled"),g=g.replace(/&amp;#44/g,"&#44"),u.find("#alert-"+m).translateText(g).removeClass("hide")}p.ajaxSubmit=function(u,m){u.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=c(e),n(u,"error",e.responseJSON?.status?.message||e.responseJSON?.error||`[[error:upload-error-fallback, ${e.status} ${e.statusText}]]`)},uploadProgress:function(e,t,r,o){u.find("#upload-progress-bar").css("width",o+"%")},success:function(e){let t=c(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(t=e.response.images),m(t[0].url),n(u,"success","[[uploads:upload-success]]"),setTimeout(function(){p.hideAlerts(u),u.modal("hide")},750)}})};function c(u){if(typeof u=="string")try{return JSON.parse(u)}catch{return{error:"[[error:parse-error]]"}}return u}function b(u,m){return window.FileReader&&m?u.files[0].size<=m*1e3:!0}return p}.apply(E,h),v!==void 0&&(y.exports=v)},12236:(y,E,l)=>{"use strict";var h,v;h=[l(49897),l(29930)],v=function(p,f){const n={};n.init=function(e,t){const r=e.find(".draft-icon"),o=e.attr("data-uuid");function s(){$(`[component="composer"][data-uuid="${o}"]`).length&&(t.save_id||(t.save_id=utils.generateSaveId(app.user.uid)),n.addToDraftList("available",t.save_id),n.addToDraftList("open",t.save_id),u(e,r,t))}e.on("keyup","textarea, input.handle, input.title",utils.debounce(s,1e3)),e.on("click",'input[type="checkbox"]',utils.debounce(s,1e3)),e.on("click",'[component="category/list"] [data-cid]',utils.debounce(s,1e3)),e.on("itemAdded",".tags",utils.debounce(s,1e3)),e.on("thumb.uploaded",s),r.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){const a=n.getList("open");a.length&&a.forEach(x=>n.removeFromDraftList("open",x))}),n.migrateGuest(),n.migrateThumbs(...arguments)};function b(e){return parseInt(e,10)>0?localStorage:sessionStorage}n.get=function(e){if(!e)return null;const t=e.split(":")[1],r=b(t);try{const o=r.getItem(e),s=JSON.parse(o)||null;if(!s)throw new Error(`can't parse draft json for ${e}`);return s.save_id=e,s.timestamp&&(s.timestampISO=utils.toISOString(s.timestamp)),$(window).trigger("action:composer.drafts.get",{save_id:e,draft:s,storage:r}),s}catch{return console.warn(`[composer/drafts] Could not get draft ${e}, removing`),n.removeFromDraftList("available"),n.removeFromDraftList("open"),null}};function u(e,t,r){if(g(app.user.uid?"localStorage":"sessionStorage")&&r&&r.save_id&&e.length){const o=e.find("input.title"),s=o&&o.length&&o.val(),a=e.find("textarea").val(),x=b(app.user.uid);if(a.length||s&&s.length){const A={save_id:r.save_id,action:r.action,text:a,uuid:e.attr("data-uuid"),timestamp:Date.now()};if(r.action==="topics.post"){const k=e.find("input.tags").val();A.tags=k,A.title=s,A.cid=r.cid}else r.action==="posts.reply"?(A.title=r.title,A.tid=r.tid,A.toPid=r.toPid):r.action==="posts.edit"&&(A.pid=r.pid,A.title=s||r.title);app.user.uid||(A.handle=e.find("input.handle").val()),x.setItem(r.save_id,JSON.stringify(A)),$(window).trigger("action:composer.drafts.save",{storage:x,postData:r,postContainer:e}),t.toggleClass("active",!0)}else n.removeDraft(r.save_id)}}n.removeDraft=function(e){if(!e)return;n.removeFromDraftList("available",e),n.removeFromDraftList("open",e);const t=e.split(":")[1],r=b(t);r.removeItem(e),$(window).trigger("action:composer.drafts.remove",{storage:r,save_id:e})},n.getList=function(e){try{const t=localStorage.getItem(`drafts:${e}`);return JSON.parse(t)||[]}catch{return console.warn("[composer/drafts] Could not read list of available drafts"),[]}},n.addToDraftList=function(e,t){if(!g(app.user.uid?"localStorage":"sessionStorage")||!t)return;const r=n.getList(e);r.includes(t)||(r.push(t),localStorage.setItem("drafts:"+e,JSON.stringify(r)))},n.removeFromDraftList=function(e,t){if(!g(app.user.uid?"localStorage":"sessionStorage")||!t)return;const r=n.getList(e);r.includes(t)&&(r.splice(r.indexOf(t),1),localStorage.setItem("drafts:"+e,JSON.stringify(r)))},n.migrateGuest=function(){if(g("localStorage")&&app.user.uid){const e=/^composer:\d+:\d$/,t=Object.keys(sessionStorage).filter(function(s){return e.test(s)}),r=new Set([]),o=t.map(function(s){const a=s.split(":");return a[1]=app.user.uid,r.add(a.join(":")),a.join(":")});return t.forEach(function(s,a){localStorage.setItem(o[a],sessionStorage.getItem(s)),sessionStorage.removeItem(s)}),r.forEach(function(s){n.addToDraftList("available",s)}),r}},n.migrateThumbs=function(e,t){if(!app.uid)return;const r=e.attr("data-uuid"),o=n.get(t.save_id);o&&o.uuid&&p.put(`/topics/${o.uuid}/thumbs`,{tid:r}).then(()=>{Promise.all([l.e(23662),l.e(65285),l.e(54516),l.e(99166),l.e(47061),l.e(11484)]).then(function(){var s=[l(71431)];(function(a){a.updateThumbCount(r,e)}).apply(null,s)}).catch(l.oe)})},n.listAvailable=function(){return n.getList("available").map(n.get).filter(Boolean)},n.getAvailableCount=function(){return n.listAvailable().length},n.open=function(e){if(!e)return;const t=n.get(e);m(e,t)},n.loadOpen=function(){if(ajaxify.data.template.login||ajaxify.data.template.register||config.hasOwnProperty("openDraftsOnPageLoad")&&!config.openDraftsOnPageLoad)return;const e=n.getList("available"),t=n.getList("open");e.length&&e.forEach(function(r){if(!r||t.includes(r))return;const o=n.get(r);if(!o||!o.text&&!o.title){n.removeFromDraftList("available",r),n.removeFromDraftList("open",r);return}m(r,o)})};function m(e,t){const o=e.split(":")[1];parseInt(app.user.uid,10)===parseInt(o,10)&&Promise.all([l.e(23662),l.e(65285),l.e(54516),l.e(99166),l.e(47061),l.e(11484)]).then(function(){var s=[l(71431)];(function(a){t.action==="topics.post"?a.newTopic({save_id:t.save_id,cid:t.cid,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(t.handle),title:utils.escapeHTML(t.title),body:t.text,tags:String(t.tags||"").split(",")}):t.action==="posts.reply"?p.get("/topics/"+t.tid,{},function(x,A){if(x)return f.error(x);a.newReply({save_id:t.save_id,tid:t.tid,toPid:t.toPid,title:A.title,body:t.text})}):t.action==="posts.edit"&&a.editPost({save_id:t.save_id,pid:t.pid,title:t.title?utils.escapeHTML(t.title):void 0,body:t.text})}).apply(null,s)}).catch(l.oe)}function g(e){var t;try{t=window[e];var r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(o){return o instanceof DOMException&&(o.code===22||o.code===1014||o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&t.length!==0}}return n}.apply(E,h),v!==void 0&&(y.exports=v)},91943:(y,E,l)=>{"use strict";var h,v;h=[l(89596),l(99594),l(36159),l(51916)],v=function(p,f,n,c){var b={},u={picture:function(){var t=this;t.find("#files").attr("accept","image/*").click()},upload:function(){var t=this;t.find("#files").attr("accept","").click()},thumbs:function(){b.exitFullscreen();var t=this;Promise.all([l.e(54516),l.e(99166),l.e(47061),l.e(29567)]).then(function(){var r=[l(71431)];(function(o){const s=t.get(0).getAttribute("data-uuid"),a=o.posts[s];(a.action==="topics.post"||a.action==="posts.edit"&&a.isMain)&&n.modal.open({id:s,pid:a.pid}).then(()=>{t.trigger("thumb.uploaded"),o.updateThumbCount(s,t)})}).apply(null,r)}).catch(l.oe)},tags:function(){var t=this;t.find(".tags-container").toggleClass("hidden")},zen:function(){var t=this;$(window).one("resize",function(){function r(){c.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),f.reposition(t),$(window).off("resize",r))}c.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),t.find(".write").focus(),$(window).on("resize",r),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",c.exit))}),c.toggle(t.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:t})}},m=[];b.exitFullscreen=function(){c.isEnabled&&c.isFullscreen&&c.exit()},b.addComposerButtons=function(){const t=$(".formatting-bar"),r=t.find(".formatting-group #fileForm");m.forEach(s=>{let a="";Array.isArray(s.dropdownItems)&&s.dropdownItems.length?a=e(s):a=`
					<li title="${s.title||""}">
						<button data-format="${s.name}" class="btn btn-sm btn-link text-reset position-relative" aria-label="${s.title||""}">
							<i class="${s.iconClass}"></i>
							${g(s)}
						</button>
					</li>
				`,r.before(a)}),t.find(".formatting-group>li").tooltip({container:"#content",animation:!1,trigger:"manual"}).on("mouseenter",function(s){const a=$(s.target);a.hasClass("dropdown-menu")||!!a.parents(".dropdown-menu").length||$(this).tooltip("show")}).on("click mouseleave",function(){$(this).tooltip("hide")})};function g(t){let r="";return t.badge&&(r='<span class="px-1 position-absolute top-0 start-100 translate-middle badge rounded text-bg-info"></span>'),r}function e(t){const r=t.dropdownItems.map(function(o){return`
				<li>
					<a href="#" data-format="${o.name}" class="dropdown-item rounded-1 position-relative" role="menuitem">
						<i class="${o.iconClass} text-secondary"></i> ${o.text}
						${g(o)}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1" title="${t.title}">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="${t.title}">
					<i class="${t.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1" role="menu">
				${r}
				</ul>
			</li>
		`}return b.addButton=function(t,r,o,s){s=s||t.replace("fa fa-",""),u[s]=r,m.push({name:s,iconClass:t,title:o})},b.addDropdown=function(t){m.push({iconClass:t.iconClass,title:t.title,dropdownItems:t.dropdownItems}),t.dropdownItems.forEach(r=>{r.name&&r.onClick&&(u[r.name]=r.onClick)})},b.getDispatchTable=function(){return u},b.addButtonDispatch=function(t,r){u[t]=r},b.addHandler=function(t){t.on("click",".formatting-bar [data-format]",function(r){var o=$(this).attr("data-format"),s=$(this).parents('[component="composer"]').find("textarea")[0];u.hasOwnProperty(o)&&(u[o].call(t,s,s.selectionStart,s.selectionEnd,r),p.render(t))})},b}.apply(E,h),v!==void 0&&(y.exports=v)},62590:(y,E,l)=>{"use strict";var h,v;h=[l(91749)],v=function(p){var f={};return f.render=function(n,c){if(c=c||function(){},!n.find(".preview-container").is(":visible"))return c();var b=n.find("textarea");socket.emit("plugins.composer.renderPreview",b.val(),function(u,m){u||(m=$("<div>"+m+"</div>"),m.find("img:not(.not-responsive)").addClass("img-fluid"),n.find(".preview").html(m),p.fire("action:composer.preview",{postContainer:n,preview:m}),c())})},f.matchScroll=function(n){if(n.find(".preview-container").is(":visible")){var c=n.find("textarea"),b=n.find(".preview");if(c.length&&b.length){var u=c[0].scrollHeight-c.height();if(u===0)return;var m=c.scrollTop()/u;b.scrollTop(Math.max(b[0].scrollHeight-b.height(),0)*m)}}},f.handleToggler=function(n){const c=n.get(0);f.env=utils.findBootstrapEnvironment();const b=["xs","sm"].includes(f.env),u=c.querySelector('.formatting-bar [data-action="preview"]'),m=u.querySelector(".show-text"),g=u.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),t=config["composer-default"].hidePreviewOnOpen==="on";let r=!b&&(e===null&&!t||e==="true");const o=c.querySelector(".preview-container"),s=c.querySelector(".write-container");if(!u)return;function a(x){b?(o.classList.toggle("hide",!1),s.classList.toggle("maximized",!1),o.classList.toggle("d-none",!x),o.classList.toggle("d-flex",x),o.classList.toggle("w-100",x),s.classList.toggle("d-flex",!x),s.classList.toggle("d-none",x),s.classList.toggle("w-100",!x)):(o.classList.toggle("hide",!x),s.classList.toggle("w-50",x),s.classList.toggle("w-100",!x),localStorage.setItem("composer:previewToggled",x)),m.classList.toggle("hide",x),g.classList.toggle("hide",!x),x&&f.render(n),f.matchScroll(n)}f.toggle=a,u.addEventListener("click",x=>{x.button===0&&(r=!r,a(r))}),a(r)},f}.apply(E,h),v!==void 0&&(y.exports=v)},57904:(y,E,l)=>{"use strict";var h,v;h=[l(14063)],v=function(p){var f={},n=0,c=.3,b=.05,u=768,m=$("body"),g=$(window),e=$('[component="navbar"]');const t=document.getElementById("content");var r=e[0];function o(){return localStorage.getItem("composer:resizeRatio")||.5}function s(w){localStorage.setItem("composer:resizeRatio",Math.min(w,1))}function a(){var w;r?w=r.getBoundingClientRect():w={bottom:0};var I=Math.max(w.bottom,0),D={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return D.width=D.right,D.height=D.bottom,D.boundedTop=I,D.boundedHeight=D.bottom-I,D}function x(w,I){var D=a(),F=w[0],M=window.getComputedStyle(F),U=parseInt(M.getPropertyValue("min-height"),10),O=Math.max(U/window.innerHeight,c);if(D.width>=u){const W=(D.height-D.boundedHeight)/D.height;I=Math.min(Math.max(I,O+W),1);var B=I*D.boundedHeight/D.height;F.style.top=((1-B)*100).toString()+"%";var T=F.getBoundingClientRect();t.style.paddingBottom=(T.bottom-T.top).toString()+"px"}else F.style.top=0,t.style.paddingBottom=0;w.ratio=I,p.updateActive(w.attr("data-uuid"))}var A=x,k=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return k&&(A=function(w,I){k(function(){x(w,I),setTimeout(function(){g.trigger("action:composer.resize"),w.trigger("action:composer.resize")},0)})}),f.reposition=function(w){var I=o();I>=1-b&&(I=1,w.addClass("maximized")),A(w,I)},f.maximize=function(w,I){I?A(w,1):f.reposition(w)},f.handleResize=function(w){var I=0,D=0,F=0,M=w.find(".resizer"),U=M[0];function O(C){var i=U.getBoundingClientRect(),d=(i.top+i.bottom)/2;I=(d-C.clientY)/2,D=C.clientY,g.on("mousemove",B),g.on("mouseup",T),m.on("touchmove",W)}function B(C){var i=C.clientY-I,d=a(),S=(d.height-i)/d.boundedHeight;A(w,S)}function T(C){C.preventDefault(),F=C.clientY,w.find("textarea").focus(),g.off("mousemove",B),g.off("mouseup",T),m.off("touchmove",W);var i=F-I,d=a(),S=(d.height-i)/d.boundedHeight;F-D===0&&w.hasClass("maximized")?(w.removeClass("maximized"),S=!n||n>=1-b?.5:n,A(w,S)):F-D===0||S>=1-b?(A(w,1),w.addClass("maximized"),n=S):w.removeClass("maximized"),s(S)}function W(C){C.preventDefault(),B(C.touches[0])}M.on("mousedown",function(C){C.button===0&&(C.preventDefault(),O(C))}).on("touchstart",function(C){C.preventDefault(),O(C.touches[0])}).on("touchend",T)},f}.apply(E,h),v!==void 0&&(y.exports=v)},51916:y=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var E=typeof window<"u"&&typeof window.document<"u"?window.document:{},l=y.exports,h=function(){for(var f,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],c=0,b=n.length,u={};c<b;c++)if(f=n[c],f&&f[1]in E){for(c=0;c<f.length;c++)u[n[0][c]]=f[c];return u}return!1}(),v={change:h.fullscreenchange,error:h.fullscreenerror},p={request:function(f,n){return new Promise(function(c,b){var u=function(){this.off("change",u),c()}.bind(this);this.on("change",u),f=f||E.documentElement;var m=f[h.requestFullscreen](n);m instanceof Promise&&m.then(u).catch(b)}.bind(this))},exit:function(){return new Promise(function(f,n){if(!this.isFullscreen){f();return}var c=function(){this.off("change",c),f()}.bind(this);this.on("change",c);var b=E[h.exitFullscreen]();b instanceof Promise&&b.then(c).catch(n)}.bind(this))},toggle:function(f,n){return this.isFullscreen?this.exit():this.request(f,n)},onchange:function(f){this.on("change",f)},onerror:function(f){this.on("error",f)},on:function(f,n){var c=v[f];c&&E.addEventListener(c,n,!1)},off:function(f,n){var c=v[f];c&&E.removeEventListener(c,n,!1)},raw:h};if(!h){l?y.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(p,{isFullscreen:{get:function(){return!!E[h.fullscreenElement]}},element:{enumerable:!0,get:function(){return E[h.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!E[h.fullscreenEnabled]}}}),l?y.exports=p:window.screenfull=p})()}}]);
