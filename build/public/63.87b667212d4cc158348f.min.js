"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[63,34405],{63:(b,x,r)=>{var y,g;y=[r(29930),r(34405),r(49897),r(81335)],g=function(E,h,l,C){const m={};let i,t,e,c;m.init=function(a,n,s){i||(e=a,c=n||[],app.parseAndTranslate("modals/tag-topic",{topics:e,tagWhitelist:c},function(p){i=p,t=i.find("#tag-topic-commit"),$("body").append(i),i.find("#tag-topic-cancel").on("click",f),t.on("click",async()=>{await u(),s&&s()}),i.find(".tags").each((d,D)=>{const A=$(D),_=A.tagsinput({tagClass:"badge bg-info",confirmKeys:[13,44],trimValue:!0}),v=_[0].$input;e[d].tags.forEach(T=>A.tagsinput("add",T.value)),A.on("itemAdded",function(T){c.length&&!c.includes(T.item)&&(A.tagsinput("remove",T.item),E.error("[[error:tag-not-allowed]]")),v.length&&v.autocomplete("close")}),o({input:v,container:_[0].$container})})}))};function o(a){h.init({input:a.input,position:{my:"left bottom",at:"left top",collision:"flip"},appendTo:a.container,source:async(n,s)=>{socket.emit("topics.autocompleteTags",{query:n.term},function(p,d){if(p)return E.error(p);d&&s(d)})}})}async function u(){await Promise.all(i.find(".tags").map(async(a,n)=>{const s=e[a],p=$(n);s.tags=await l.put(`/topics/${s.tid}/tags`,{tags:p.tagsinput("items")}),m.updateTopicTags([s])})),f()}m.updateTopicTags=function(a){a.forEach(n=>{const s=ajaxify.data.template.topic?"partials/topic/tags":"partials/category/tags";C.render(s,{tags:n.tags}).then(function(p){const d=$(`[data-tid="${n.tid}"][component="topic/tags"]`);d.fadeOut(250,function(){d.toggleClass("hidden",n.tags.length===0),d.html(p).fadeIn(250)})})})};function f(){i&&(i.remove(),i=null)}return m}.apply(x,y),g!==void 0&&(b.exports=g)},34405:(b,x,r)=>{var y,g;y=[r(49897),r(29930)],g=function(E,h){const l={},C={delay:200,appendTo:null};l.init=i=>{const t={...C,...i},{input:e,onSelect:c}=t;app.loadJQueryUI(function(){e.autocomplete({...t,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(o,u){m(e,c,o,u)}})})},l.user=function(i,t,e){typeof t=="function"&&(e=t,t={}),t=t||{},l.init({input:i,onSelect:e,source:(c,o)=>{t.query=c.term,E.get("/api/users",t,function(u,f){if(u)return h.error(u);if(f&&f.users){const a=f.users.map(function(n){const s=$("<div></div>").html(n.username).text();return n&&{label:s,value:s,user:{uid:n.uid,name:n.username,slug:n.userslug,username:n.username,userslug:n.userslug,picture:n.picture,banned:n.banned,"icon:text":n["icon:text"],"icon:bgColor":n["icon:bgColor"]}}});o(a)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},l.group=function(i,t){l.init({input:i,onSelect:t,source:(e,c)=>{socket.emit("groups.search",{query:e.term},function(o,u){if(o)return h.error(o);if(u&&u.length){const f=u.map(function(a){return a&&{label:a.name,value:a.name,group:a}});c(f)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},l.tag=function(i,t){l.init({input:i,onSelect:t,delay:100,source:(e,c)=>{socket.emit("topics.autocompleteTags",{query:e.term,cid:ajaxify.data.cid||0},function(o,u){if(o)return h.error(o);u&&c(u),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function m(i,t,e,c){t=t||function(){};const o=jQuery.Event("keypress");o.which=13,o.keyCode=13,setTimeout(function(){i.trigger(o)},100),t(e,c)}return l}.apply(x,y),g!==void 0&&(b.exports=g)}}]);
