(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[54516],{9794:(p,l,c)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.ContenteditableEditor=void 0;const v=c(36e3),h=c(29326);class a extends v.Editor{constructor(n){super(),this.el=n,this.onInput=()=>{this.emitChangeEvent()},this.onKeydown=e=>{const t=this.getCode(e);let i;t==="UP"||t==="DOWN"?i=this.emitMoveEvent(t):t==="ENTER"?i=this.emitEnterEvent():t==="ESC"&&(i=this.emitEscEvent()),i&&i.defaultPrevented&&e.preventDefault()},this.startListening=()=>{this.el.addEventListener("input",this.onInput),this.el.addEventListener("keydown",this.onKeydown)},this.stopListening=()=>{this.el.removeEventListener("input",this.onInput),this.el.removeEventListener("keydown",this.onKeydown)},this.startListening()}destroy(){return super.destroy(),this.stopListening(),this}applySearchResult(n){const e=this.getBeforeCursor(),t=this.getAfterCursor();if(e!=null&&t!=null){const i=n.replace(e,t);if(Array.isArray(i)){let r=i[0];(0,h.isSafari)()&&(r=r.replace(e,""));const o=this.getRange();o.selectNode(o.startContainer),this.el.ownerDocument.execCommand("insertText",!1,r+i[1]),o.detach();const d=this.getRange();d.setStart(d.startContainer,r.length),d.collapse(!0)}}}getCursorOffset(){const n=this.getRange(),e=n.getBoundingClientRect(),t=this.el.ownerDocument.body.getBoundingClientRect(),i=n.startContainer,r=i instanceof Text?i.parentElement:i,o=e.left,d=(0,h.getLineHeightPx)(r),u=e.top-t.top+d;return this.el.dir!=="rtl"?{left:o,lineHeight:d,top:u}:{right:document.documentElement.clientWidth-o,lineHeight:d,top:u}}getBeforeCursor(){const n=this.getRange();return n.collapsed&&n.startContainer instanceof Text?n.startContainer.wholeText.substring(0,n.startOffset):null}getAfterCursor(){const n=this.getRange();return n.collapsed&&n.startContainer instanceof Text?n.startContainer.wholeText.substring(n.startOffset):null}getRange(n){var e;const t=(e=this.el.ownerDocument.defaultView)===null||e===void 0?void 0:e.getSelection();if(t==null)throw new Error("The element does not belong to view");for(let o=0,d=t.rangeCount;o<d;o++){const u=t.getRangeAt(o);if(this.el.contains(u.startContainer))return u}if(n)throw new Error("Unexpected");const i=this.el.ownerDocument.activeElement;this.el.focus();const r=this.getRange(!0);if(i){const o=i;o.focus&&o.focus()}return r}}l.ContenteditableEditor=a},35786:function(p,l,c){"use strict";var v=this&&this.__createBinding||(Object.create?function(a,s,n,e){e===void 0&&(e=n);var t=Object.getOwnPropertyDescriptor(s,n);(!t||("get"in t?!s.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return s[n]}}),Object.defineProperty(a,e,t)}:function(a,s,n,e){e===void 0&&(e=n),a[e]=s[n]}),h=this&&this.__exportStar||function(a,s){for(var n in a)n!=="default"&&!Object.prototype.hasOwnProperty.call(s,n)&&v(s,a,n)};Object.defineProperty(l,"__esModule",{value:!0}),h(c(9794),l)},22615:(p,l,c)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.Completer=void 0;const v=c(30228),h=c(59099);class a extends v.EventEmitter{constructor(n){super(),this.handleQueryResult=e=>{this.emit("hit",{searchResults:e})},this.strategies=n.map(e=>new h.Strategy(e))}destroy(){return this.strategies.forEach(n=>n.destroy()),this}run(n){for(const e of this.strategies)if(e.execute(n,this.handleQueryResult))return;this.handleQueryResult([])}}l.Completer=a},44871:(p,l,c)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.Dropdown=l.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME=l.DEFAULT_DROPDOWN_ITEM_CLASS_NAME=l.DEFAULT_DROPDOWN_CLASS_NAME=l.DEFAULT_DROPDOWN_PLACEMENT=l.DEFAULT_DROPDOWN_MAX_COUNT=void 0;const v=c(30228),h=c(32665);l.DEFAULT_DROPDOWN_MAX_COUNT=10,l.DEFAULT_DROPDOWN_PLACEMENT="auto",l.DEFAULT_DROPDOWN_CLASS_NAME="dropdown-menu textcomplete-dropdown",l.DEFAULT_DROPDOWN_ITEM_CLASS_NAME="textcomplete-item",l.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME=`${l.DEFAULT_DROPDOWN_ITEM_CLASS_NAME} active`;class a extends v.EventEmitter{static create(e){const t=document.createElement("ul");t.className=e.className||l.DEFAULT_DROPDOWN_CLASS_NAME,Object.assign(t.style,{display:"none",position:"absolute",zIndex:"1000"},e.style);const i=e.parent||document.body;return i?.appendChild(t),new a(t,e)}constructor(e,t){super(),this.el=e,this.option=t,this.shown=!1,this.items=[],this.activeIndex=null}render(e,t){const i=(0,h.createCustomEvent)("render",{cancelable:!0});return this.emit("render",i),i.defaultPrevented?this:(this.clear(),e.length===0?this.hide():(this.items=e.slice(0,this.option.maxCount||l.DEFAULT_DROPDOWN_MAX_COUNT).map((r,o)=>{var d;return new s(this,o,r,((d=this.option)===null||d===void 0?void 0:d.item)||{})}),this.setStrategyId(e[0]).renderEdge(e,"header").renderItems().renderEdge(e,"footer").show().setOffset(t).activate(0),this.emit("rendered",(0,h.createCustomEvent)("rendered")),this))}destroy(){var e;return this.clear(),(e=this.el.parentNode)===null||e===void 0||e.removeChild(this.el),this}select(e){const t={searchResult:e.searchResult},i=(0,h.createCustomEvent)("select",{cancelable:!0,detail:t});return this.emit("select",i),i.defaultPrevented?this:(this.hide(),this.emit("selected",(0,h.createCustomEvent)("selected",{detail:t})),this)}show(){if(!this.shown){const e=(0,h.createCustomEvent)("show",{cancelable:!0});if(this.emit("show",e),e.defaultPrevented)return this;this.el.style.display="block",this.shown=!0,this.emit("shown",(0,h.createCustomEvent)("shown"))}return this}hide(){if(this.shown){const e=(0,h.createCustomEvent)("hide",{cancelable:!0});if(this.emit("hide",e),e.defaultPrevented)return this;this.el.style.display="none",this.shown=!1,this.clear(),this.emit("hidden",(0,h.createCustomEvent)("hidden"))}return this}clear(){return this.items.forEach(e=>e.destroy()),this.items=[],this.el.innerHTML="",this.activeIndex=null,this}up(e){return this.shown?this.moveActiveItem("prev",e):this}down(e){return this.shown?this.moveActiveItem("next",e):this}moveActiveItem(e,t){if(this.activeIndex!=null){const i=e==="next"?this.getNextActiveIndex():this.getPrevActiveIndex();i!=null&&(this.activate(i),t.preventDefault())}return this}activate(e){return this.activeIndex!==e&&(this.activeIndex!=null&&this.items[this.activeIndex].deactivate(),this.activeIndex=e,this.items[e].activate()),this}isShown(){return this.shown}getActiveItem(){return this.activeIndex!=null?this.items[this.activeIndex]:null}setOffset(e){const t=document.documentElement;if(t){const i=this.el.offsetWidth;if(e.left){const d=this.option.dynamicWidth?t.scrollWidth:t.clientWidth;e.left+i>d&&(e.left=d-i),this.el.style.left=`${e.left}px`}else e.right&&(e.right-i<0&&(e.right=0),this.el.style.right=`${e.right}px`);let r=!1;const o=this.option.placement||l.DEFAULT_DROPDOWN_PLACEMENT;if(o==="auto"){const d=this.items.length*e.lineHeight;r=e.clientTop!=null&&e.clientTop+d>t.clientHeight}o==="top"||r?(this.el.style.bottom=`${t.clientHeight-e.top+e.lineHeight}px`,this.el.style.top="auto"):(this.el.style.top=`${e.top}px`,this.el.style.bottom="auto")}return this}getNextActiveIndex(){if(this.activeIndex==null)throw new Error;return this.activeIndex<this.items.length-1?this.activeIndex+1:this.option.rotate?0:null}getPrevActiveIndex(){if(this.activeIndex==null)throw new Error;return this.activeIndex!==0?this.activeIndex-1:this.option.rotate?this.items.length-1:null}renderItems(){const e=document.createDocumentFragment();for(const t of this.items)e.appendChild(t.el);return this.el.appendChild(e),this}setStrategyId(e){const t=e.getStrategyId();return t&&(this.el.dataset.strategy=t),this}renderEdge(e,t){const i=this.option[t],r=document.createElement("li");return r.className=`textcomplete-${t}`,r.innerHTML=typeof i=="function"?i(e.map(o=>o.data)):i||"",this.el.appendChild(r),this}}l.Dropdown=a;class s{constructor(e,t,i,r){this.dropdown=e,this.index=t,this.searchResult=i,this.props=r,this.active=!1,this.onClick=u=>{u.preventDefault(),this.dropdown.select(this)},this.className=this.props.className||l.DEFAULT_DROPDOWN_ITEM_CLASS_NAME,this.activeClassName=this.props.activeClassName||l.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME;const o=document.createElement("li");o.className=this.active?this.activeClassName:this.className;const d=document.createElement("span");d.tabIndex=-1,d.innerHTML=this.searchResult.render(),o.appendChild(d),o.addEventListener("click",this.onClick),this.el=o}destroy(){var e;const t=this.el;return(e=t.parentNode)===null||e===void 0||e.removeChild(t),t.removeEventListener("click",this.onClick,!1),this}activate(){return this.active||(this.active=!0,this.el.className=this.activeClassName,this.dropdown.el.scrollTop=this.el.offsetTop),this}deactivate(){return this.active&&(this.active=!1,this.el.className=this.className),this}}},83271:(p,l,c)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.Editor=void 0;const v=c(30228),h=c(32665);class a extends v.EventEmitter{destroy(){return this}applySearchResult(n){throw new Error("Not implemented.")}getCursorOffset(){throw new Error("Not implemented.")}getBeforeCursor(){throw new Error("Not implemented.")}emitMoveEvent(n){const e=(0,h.createCustomEvent)("move",{cancelable:!0,detail:{code:n}});return this.emit("move",e),e}emitEnterEvent(){const n=(0,h.createCustomEvent)("enter",{cancelable:!0});return this.emit("enter",n),n}emitChangeEvent(){const n=(0,h.createCustomEvent)("change",{detail:{beforeCursor:this.getBeforeCursor()}});return this.emit("change",n),n}emitEscEvent(){const n=(0,h.createCustomEvent)("esc",{cancelable:!0});return this.emit("esc",n),n}getCode(n){switch(n.keyCode){case 9:case 13:return"ENTER";case 27:return"ESC";case 38:return"UP";case 40:return"DOWN";case 78:if(n.ctrlKey)return"DOWN";break;case 80:if(n.ctrlKey)return"UP";break}return"OTHER"}}l.Editor=a},83103:(p,l)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.SearchResult=void 0;const c=/\$&/g,v=/\$(\d)/g;class h{constructor(s,n,e){this.data=s,this.term=n,this.strategy=e}getReplacementData(s){let n=this.strategy.replace(this.data);if(n==null)return null;let e="";Array.isArray(n)&&(e=n[1],n=n[0]);const t=this.strategy.match(s);if(t==null||t.index==null)return null;const i=n.replace(c,t[0]).replace(v,(r,o)=>t[parseInt(o)]);return{start:t.index,end:t.index+t[0].length,beforeCursor:i,afterCursor:e}}replace(s,n){const e=this.getReplacementData(s);if(e!==null)return n=e.afterCursor+n,[[s.slice(0,e.start),e.beforeCursor,s.slice(e.end)].join(""),n]}render(){return this.strategy.renderTemplate(this.data,this.term)}getStrategyId(){return this.strategy.getId()}}l.SearchResult=h},59099:(p,l,c)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.Strategy=l.DEFAULT_INDEX=void 0;const v=c(83103);l.DEFAULT_INDEX=1;class h{constructor(s){this.props=s,this.cache={}}destroy(){return this.cache={},this}replace(s){return this.props.replace(s)}execute(s,n){var e;const t=this.matchWithContext(s);if(!t)return!1;const i=t[(e=this.props.index)!==null&&e!==void 0?e:l.DEFAULT_INDEX];return this.search(i,r=>{n(r.map(o=>new v.SearchResult(o,i,this)))},t),!0}renderTemplate(s,n){if(this.props.template)return this.props.template(s,n);if(typeof s=="string")return s;throw new Error(`Unexpected render data type: ${typeof s}. Please implement template parameter by yourself`)}getId(){return this.props.id||null}match(s){return typeof this.props.match=="function"?this.props.match(s):s.match(this.props.match)}search(s,n,e){this.props.cache?this.searchWithCach(s,n,e):this.props.search(s,n,e)}matchWithContext(s){const n=this.context(s);return n===!1?null:this.match(n===!0?s:n)}context(s){return this.props.context?this.props.context(s):!0}searchWithCach(s,n,e){this.cache[s]!=null?n(this.cache[s]):this.props.search(s,t=>{this.cache[s]=t,n(t)},e)}}l.Strategy=h},88638:(p,l,c)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.Textcomplete=void 0;const v=c(30228),h=c(44871),a=c(22615),s=["show","shown","render","rendered","selected","hidden","hide"];class n extends v.EventEmitter{constructor(t,i,r){super(),this.editor=t,this.isQueryInFlight=!1,this.nextPendingQuery=null,this.handleHit=({searchResults:o})=>{o.length?this.dropdown.render(o,this.editor.getCursorOffset()):this.dropdown.hide(),this.isQueryInFlight=!1,this.nextPendingQuery!==null&&this.trigger(this.nextPendingQuery)},this.handleMove=o=>{o.detail.code==="UP"?this.dropdown.up(o):this.dropdown.down(o)},this.handleEnter=o=>{const d=this.dropdown.getActiveItem();d?(this.dropdown.select(d),o.preventDefault()):this.dropdown.hide()},this.handleEsc=o=>{this.dropdown.isShown()&&(this.dropdown.hide(),o.preventDefault())},this.handleChange=o=>{o.detail.beforeCursor!=null?this.trigger(o.detail.beforeCursor):this.dropdown.hide()},this.handleSelect=o=>{this.emit("select",o),o.defaultPrevented||this.editor.applySearchResult(o.detail.searchResult)},this.handleResize=()=>{this.dropdown.isShown()&&this.dropdown.setOffset(this.editor.getCursorOffset())},this.completer=new a.Completer(i),this.dropdown=h.Dropdown.create(r?.dropdown||{}),this.startListening()}destroy(t=!0){return this.completer.destroy(),this.dropdown.destroy(),t&&this.editor.destroy(),this.stopListening(),this}isShown(){return this.dropdown.isShown()}hide(){return this.dropdown.hide(),this}trigger(t){return this.isQueryInFlight?this.nextPendingQuery=t:(this.isQueryInFlight=!0,this.nextPendingQuery=null,this.completer.run(t)),this}startListening(){var t;this.editor.on("move",this.handleMove).on("enter",this.handleEnter).on("esc",this.handleEsc).on("change",this.handleChange),this.dropdown.on("select",this.handleSelect);for(const i of s)this.dropdown.on(i,r=>this.emit(i,r));this.completer.on("hit",this.handleHit),(t=this.dropdown.el.ownerDocument.defaultView)===null||t===void 0||t.addEventListener("resize",this.handleResize)}stopListening(){var t;(t=this.dropdown.el.ownerDocument.defaultView)===null||t===void 0||t.removeEventListener("resize",this.handleResize),this.completer.removeAllListeners(),this.dropdown.removeAllListeners(),this.editor.removeListener("move",this.handleMove).removeListener("enter",this.handleEnter).removeListener("esc",this.handleEsc).removeListener("change",this.handleChange)}}l.Textcomplete=n},36e3:function(p,l,c){"use strict";var v=this&&this.__createBinding||(Object.create?function(a,s,n,e){e===void 0&&(e=n);var t=Object.getOwnPropertyDescriptor(s,n);(!t||("get"in t?!s.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return s[n]}}),Object.defineProperty(a,e,t)}:function(a,s,n,e){e===void 0&&(e=n),a[e]=s[n]}),h=this&&this.__exportStar||function(a,s){for(var n in a)n!=="default"&&!Object.prototype.hasOwnProperty.call(s,n)&&v(s,a,n)};Object.defineProperty(l,"__esModule",{value:!0}),h(c(22615),l),h(c(44871),l),h(c(83271),l),h(c(83103),l),h(c(59099),l),h(c(88638),l),h(c(32665),l)},32665:(p,l)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.createCustomEvent=void 0;const c=typeof window<"u"&&!!window.CustomEvent,v=(h,a)=>{if(c)return new CustomEvent(h,a);const s=document.createEvent("CustomEvent");return s.initCustomEvent(h,!1,a?.cancelable||!1,a?.detail||void 0),s};l.createCustomEvent=v},48456:function(p,l,c){"use strict";var v=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(l,"__esModule",{value:!0}),l.TextareaEditor=void 0;const h=c(12531),a=v(c(7037)),s=c(36e3),n=c(29326);class e extends s.Editor{constructor(i){super(),this.el=i,this.onInput=()=>{this.emitChangeEvent()},this.onKeydown=r=>{const o=this.getCode(r);let d;o==="UP"||o==="DOWN"?d=this.emitMoveEvent(o):o==="ENTER"?d=this.emitEnterEvent():o==="ESC"&&(d=this.emitEscEvent()),d&&d.defaultPrevented&&r.preventDefault()},this.startListening()}destroy(){return super.destroy(),this.stopListening(),this}applySearchResult(i){const r=this.getBeforeCursor();if(r!=null){const o=i.replace(r,this.getAfterCursor());this.el.focus(),Array.isArray(o)&&((0,h.update)(this.el,o[0],o[1]),this.el&&this.el.dispatchEvent((0,s.createCustomEvent)("input")))}}getCursorOffset(){const i=(0,n.calculateElementOffset)(this.el),r=this.getElScroll(),o=this.getCursorPosition(),d=(0,n.getLineHeightPx)(this.el),u=i.top-r.top+o.top+d,m=i.left-r.left+o.left,f=this.el.getBoundingClientRect().top;if(this.el.dir!=="rtl")return{top:u,left:m,lineHeight:d,clientTop:f};{const E=document.documentElement?document.documentElement.clientWidth-m:0;return{top:u,right:E,lineHeight:d,clientTop:f}}}getBeforeCursor(){return this.el.selectionStart!==this.el.selectionEnd?null:this.el.value.substring(0,this.el.selectionEnd)}getAfterCursor(){return this.el.value.substring(this.el.selectionEnd)}getElScroll(){return{top:this.el.scrollTop,left:this.el.scrollLeft}}getCursorPosition(){return(0,a.default)(this.el,this.el.selectionEnd)}startListening(){this.el.addEventListener("input",this.onInput),this.el.addEventListener("keydown",this.onKeydown)}stopListening(){this.el.removeEventListener("input",this.onInput),this.el.removeEventListener("keydown",this.onKeydown)}}l.TextareaEditor=e},9787:(p,l,c)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.TextareaEditor=void 0;var v=c(48456);Object.defineProperty(l,"TextareaEditor",{enumerable:!0,get:function(){return v.TextareaEditor}})},21251:(p,l)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.calculateElementOffset=void 0;const c=v=>{const h=v.getBoundingClientRect(),a=v.ownerDocument;if(a==null)throw new Error("Given element does not belong to document");const{defaultView:s,documentElement:n}=a;if(s==null)throw new Error("Given element does not belong to window");const e={top:h.top+s.pageYOffset,left:h.left+s.pageXOffset};return n&&(e.top-=n.clientTop,e.left-=n.clientLeft),e};l.calculateElementOffset=c},68675:(p,l)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.getLineHeightPx=void 0;const c=48,v=57,h=n=>c<=n&&n<=v,a=n=>{const e=getComputedStyle(n),t=e.lineHeight;if(h(t.charCodeAt(0))){const i=parseFloat(t);return h(t.charCodeAt(t.length-1))?i*parseFloat(e.fontSize):i}return s(n.nodeName,e)};l.getLineHeightPx=a;const s=(n,e)=>{const t=document.body;if(!t)return 0;const i=document.createElement(n);i.innerHTML="&nbsp;",Object.assign(i.style,{fontSize:e.fontSize,fontFamily:e.fontFamily,padding:"0"}),t.appendChild(i),i instanceof HTMLTextAreaElement&&(i.rows=1);const r=i.offsetHeight;return t.removeChild(i),r}},29326:function(p,l,c){"use strict";var v=this&&this.__createBinding||(Object.create?function(a,s,n,e){e===void 0&&(e=n);var t=Object.getOwnPropertyDescriptor(s,n);(!t||("get"in t?!s.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return s[n]}}),Object.defineProperty(a,e,t)}:function(a,s,n,e){e===void 0&&(e=n),a[e]=s[n]}),h=this&&this.__exportStar||function(a,s){for(var n in a)n!=="default"&&!Object.prototype.hasOwnProperty.call(s,n)&&v(s,a,n)};Object.defineProperty(l,"__esModule",{value:!0}),h(c(21251),l),h(c(68675),l),h(c(81960),l)},81960:(p,l)=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.isSafari=void 0;const c=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent);l.isSafari=c},30228:p=>{"use strict";var l=Object.prototype.hasOwnProperty,c="~";function v(){}Object.create&&(v.prototype=Object.create(null),new v().__proto__||(c=!1));function h(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function a(e,t,i,r,o){if(typeof i!="function")throw new TypeError("The listener must be a function");var d=new h(i,r||e,o),u=c?c+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],d]:e._events[u].push(d):(e._events[u]=d,e._eventsCount++),e}function s(e,t){--e._eventsCount===0?e._events=new v:delete e._events[t]}function n(){this._events=new v,this._eventsCount=0}n.prototype.eventNames=function(){var t=[],i,r;if(this._eventsCount===0)return t;for(r in i=this._events)l.call(i,r)&&t.push(c?r.slice(1):r);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(i)):t},n.prototype.listeners=function(t){var i=c?c+t:t,r=this._events[i];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,d=r.length,u=new Array(d);o<d;o++)u[o]=r[o].fn;return u},n.prototype.listenerCount=function(t){var i=c?c+t:t,r=this._events[i];return r?r.fn?1:r.length:0},n.prototype.emit=function(t,i,r,o,d,u){var m=c?c+t:t;if(!this._events[m])return!1;var f=this._events[m],E=arguments.length,w,g;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),E){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,i),!0;case 3:return f.fn.call(f.context,i,r),!0;case 4:return f.fn.call(f.context,i,r,o),!0;case 5:return f.fn.call(f.context,i,r,o,d),!0;case 6:return f.fn.call(f.context,i,r,o,d,u),!0}for(g=1,w=new Array(E-1);g<E;g++)w[g-1]=arguments[g];f.fn.apply(f.context,w)}else{var _=f.length,y;for(g=0;g<_;g++)switch(f[g].once&&this.removeListener(t,f[g].fn,void 0,!0),E){case 1:f[g].fn.call(f[g].context);break;case 2:f[g].fn.call(f[g].context,i);break;case 3:f[g].fn.call(f[g].context,i,r);break;case 4:f[g].fn.call(f[g].context,i,r,o);break;default:if(!w)for(y=1,w=new Array(E-1);y<E;y++)w[y-1]=arguments[y];f[g].fn.apply(f[g].context,w)}}return!0},n.prototype.on=function(t,i,r){return a(this,t,i,r,!1)},n.prototype.once=function(t,i,r){return a(this,t,i,r,!0)},n.prototype.removeListener=function(t,i,r,o){var d=c?c+t:t;if(!this._events[d])return this;if(!i)return s(this,d),this;var u=this._events[d];if(u.fn)u.fn===i&&(!o||u.once)&&(!r||u.context===r)&&s(this,d);else{for(var m=0,f=[],E=u.length;m<E;m++)(u[m].fn!==i||o&&!u[m].once||r&&u[m].context!==r)&&f.push(u[m]);f.length?this._events[d]=f.length===1?f[0]:f:s(this,d)}return this},n.prototype.removeAllListeners=function(t){var i;return t?(i=c?c+t:t,this._events[i]&&s(this,i)):(this._events=new v,this._eventsCount=0),this},n.prototype.off=n.prototype.removeListener,n.prototype.addListener=n.prototype.on,n.prefixed=c,n.EventEmitter=n,p.exports=n},54516:(p,l,c)=>{"use strict";var v,h;v=[c(89596),c(36e3),c(9787),c(35786)],h=function(a,{Textcomplete:s},{TextareaEditor:n},{ContenteditableEditor:e}){var t={_active:{}};return $(window).on("action:composer.discard",function(i,r){t._active.hasOwnProperty(r.post_uuid)&&(t._active[r.post_uuid].destroy(),delete t._active[r.post_uuid])}),t.init=function(i,r){var o=i.find(".write"),d="composer-autocomplete-dropdown-"+r,u;if(o.length){var m={element:o,strategies:[],options:{style:{"z-index":2e4},className:d+" dropdown-menu textcomplete-dropdown"}};o.on("keyup",function(){clearTimeout(u),u=setTimeout(function(){var f=document.querySelector("."+d);if(f){var E=f.getBoundingClientRect(),w=parseFloat(f.style.marginTop,10)||0,g=window.innerHeight+w-10-E.bottom;f.style.marginTop=Math.min(g,0)+"px"}},0)}),$(window).trigger("composer:autocomplete:init",m),t._active[r]=t.setup(m),m.element.on("textComplete:select",function(){a.render(i)})}},t.setup=function({element:i,strategies:r,options:o}){const d=i.get(0);if(d){var u;if(d.nodeName==="TEXTAREA"||d.nodeName==="INPUT"?u=new n(d):d.nodeName==="DIV"&&d.getAttribute("contenteditable")==="true"&&(u=new e(d)),!u)throw new Error("unknown target element type");d.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var m=new s(u,r,{dropdown:o});return m.on("rendered",function(){m.dropdown.items.length&&m.dropdown.items[0].activate()}),m}},t}.apply(l,v),h!==void 0&&(p.exports=h)},7037:p=>{(function(){var l=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],c=typeof window<"u",v=c&&window.mozInnerScreenX!=null;function h(a,s,n){if(!c)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var e=n&&n.debug||!1;if(e){var t=document.querySelector("#input-textarea-caret-position-mirror-div");t&&t.parentNode.removeChild(t)}var i=document.createElement("div");i.id="input-textarea-caret-position-mirror-div",document.body.appendChild(i);var r=i.style,o=window.getComputedStyle?window.getComputedStyle(a):a.currentStyle,d=a.nodeName==="INPUT";r.whiteSpace="pre-wrap",d||(r.wordWrap="break-word"),r.position="absolute",e||(r.visibility="hidden"),l.forEach(function(f){d&&f==="lineHeight"?r.lineHeight=o.height:r[f]=o[f]}),v?a.scrollHeight>parseInt(o.height)&&(r.overflowY="scroll"):r.overflow="hidden",i.textContent=a.value.substring(0,s),d&&(i.textContent=i.textContent.replace(/\s/g,"\xA0"));var u=document.createElement("span");u.textContent=a.value.substring(s)||".",i.appendChild(u);var m={top:u.offsetTop+parseInt(o.borderTopWidth),left:u.offsetLeft+parseInt(o.borderLeftWidth),height:parseInt(o.lineHeight)};return e?u.style.backgroundColor="#aaa":document.body.removeChild(i),m}typeof p.exports<"u"?p.exports=h:c&&(window.getCaretCoordinates=h)})()},12531:(p,l,c)=>{"use strict";c.r(l),c.d(l,{update:()=>v,wrapCursor:()=>h});function v(a,s,n){const e=a.value,t=s+(n||""),i=document.activeElement;let r=0,o=0;for(;r<e.length&&r<t.length&&e[r]===t[r];)r++;for(;e.length-o-1>=0&&t.length-o-1>=0&&e[e.length-o-1]===t[t.length-o-1];)o++;r=Math.min(r,Math.min(e.length,t.length)-o),a.setSelectionRange(r,e.length-o);const d=t.substring(r,t.length-o);if(a.focus(),!document.execCommand("insertText",!1,d)){a.value=t;const u=document.createEvent("Event");u.initEvent("input",!0,!0),a.dispatchEvent(u)}return a.setSelectionRange(s.length,s.length),i.focus(),a}function h(a,s,n){const e=a.selectionEnd,t=a.value.substr(0,a.selectionStart)+s,i=a.value.substring(a.selectionStart,e)+(n||"")+a.value.substr(e);return v(a,t,i),a.selectionEnd=e+s.length,a}}}]);
