"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[90954,42619,8981,14526],{71131:(S,F,d)=>{var D,A;D=[d(70550),d(60984),d(52473),d(49897),d(40027),d(29930)],A=function(x,P,g,E,T,e){const i={};i.init=function(){x.init(s),k(),$('[component="category/topic"]').each((n,c)=>{P.observeTopicLabels($(c).find('[component="topic/labels"]'))}),g.get("topic/delete").on("click",function(){return o("del","/state","delete",r),!1}),g.get("topic/restore").on("click",function(){return o("put","/state","restore",r),!1}),g.get("topic/purge").on("click",function(){return o("del","","purge",y),!1}),g.get("topic/lock").on("click",function(){return o("put","/lock","lock",t),!1}),g.get("topic/unlock").on("click",function(){return o("del","/lock","unlock",t),!1}),g.get("topic/pin").on("click",function(){return o("put","/pin","pin",t),!1}),g.get("topic/unpin").on("click",function(){return o("del","/pin","unpin",t),!1}),g.get("topic/mark-unread-for-all").on("click",function(){const n=x.getSelectedTids();return n.length?(socket.emit("topics.markAsUnreadForAll",n,function(c){if(c)return e.error(c);e.success("[[topic:markAsUnreadForAll.success]]"),n.forEach(function(l){$('[component="category/topic"][data-tid="'+l+'"]').addClass("unread")}),t()}),!1):e.error("[[error:no-topics-selected]]")}),g.get("topic/move").on("click",function(){return d.e(28310).then(function(){var n=[d(28310)];(function(c){const l=x.getSelectedTids();if(!l.length)return e.error("[[error:no-topics-selected]]");c.init(l,null,t)}).apply(null,n)}).catch(d.oe),!1}),g.get("topic/move-all").on("click",function(){const n=ajaxify.data.cid;if(!ajaxify.data.template.category)return e.error("[[error:invalid-data]]");d.e(28310).then(function(){var c=[d(28310)];(function(l){l.init(null,n,function(w){if(w)return e.error(w);ajaxify.refresh()})}).apply(null,c)}).catch(d.oe)}),g.get("topic/merge").on("click",function(){const n=x.getSelectedTids();d.e(2403).then(function(){var c=[d(2403)];(function(l){l.init(function(){n.length&&n.forEach(function(w){l.addTopic(w)})})}).apply(null,c)}).catch(d.oe)}),g.get("topic/tag").on("click",async function(){const n=x.getSelectedTids();if(!n.length)return e.error("[[error:no-topics-selected]]");const c=await Promise.all(n.map(l=>E.get(`/topics/${l}`)));d.e(63).then(function(){var l=[d(63)];(function(w){w.init(c,ajaxify.data.tagWhitelist,t)}).apply(null,l)}).catch(d.oe)}),i.removeListeners(),socket.on("event:topic_deleted",M),socket.on("event:topic_restored",M),socket.on("event:topic_purged",v),socket.on("event:topic_locked",u),socket.on("event:topic_unlocked",u),socket.on("event:topic_pinned",W),socket.on("event:topic_unpinned",W),socket.on("event:topic_moved",a)};function o(n,c,l,w){w||(w=function(){});const R=x.getSelectedTids(),I={},B=function(N){N&&Promise.all(R.map(K=>E[n](`/topics/${K}${c}`,I))).then(w).catch(e.error)};if(!R.length)return e.error("[[error:no-topics-selected]]");switch(l){case"delete":case"restore":case"purge":T.confirm(`[[topic:thread-tools.${l}-confirm]]`,B);break;case"pin":P.requestPinExpiry(I,B.bind(null,!0));break;default:B(!0);break}}i.removeListeners=function(){socket.removeListener("event:topic_deleted",M),socket.removeListener("event:topic_restored",M),socket.removeListener("event:topic_purged",v),socket.removeListener("event:topic_locked",u),socket.removeListener("event:topic_unlocked",u),socket.removeListener("event:topic_pinned",W),socket.removeListener("event:topic_unpinned",W),socket.removeListener("event:topic_moved",a)};function f(){$(".thread-tools .show").removeClass("show")}function t(){f(),x.unselectAll()}function r(){f(),s()}function y(){f(),x.unselectAll(),s()}function s(){const n=x.getSelectedTids(),c=m(h,n),l=p(h,n),w=m(L,n),R=m(C,n),I=m(b,n),B=p(b,n);g.get("topic/delete").toggleClass("hidden",c),g.get("topic/restore").toggleClass("hidden",I||!c),g.get("topic/purge").toggleClass("hidden",!l||!n.length),g.get("topic/lock").toggleClass("hidden",R),g.get("topic/unlock").toggleClass("hidden",!R),g.get("topic/pin").toggleClass("hidden",B||w),g.get("topic/unpin").toggleClass("hidden",B||!w),g.get("topic/merge").toggleClass("hidden",I)}function m(n,c){for(let l=0;l<c.length;l+=1)if(n(c[l]))return!0;return!1}function p(n,c){for(let l=0;l<c.length;l+=1)if(!n(c[l]))return!1;return!0}function h(n){return j(n).hasClass("deleted")}function C(n){return j(n).hasClass("locked")}function L(n){return j(n).hasClass("pinned")}function b(n){return j(n).hasClass("scheduled")}function j(n){return g.get("category/topic","tid",n)}function M(n){const c=j(n.tid);c.toggleClass("deleted",n.isDeleted),c.find('[component="topic/locked"]').toggleClass("hidden",!n.isDeleted)}function W(n){const c=j(n.tid);c.toggleClass("pinned",n.isPinned),c.find('[component="topic/pinned"]').toggleClass("hidden",!n.isPinned),ajaxify.refresh()}function u(n){const c=j(n.tid);c.toggleClass("locked",n.isLocked),c.find('[component="topic/locked"]').toggleClass("hidden",!n.isLocked)}function a(n){j(n.tid).remove()}function v(n){j(n.tid).remove()}function k(){if(!ajaxify.data.topics||!ajaxify.data.template.category)return;const n=ajaxify.data.topics.filter(c=>c.pinned).length;!app.user.isAdmin&&!app.user.isMod||n<2||app.loadJQueryUI(function(){const c=$('[component="category"]').filter(function(w,R){return!$(R).parents("[widget-area],[data-widget-area]").length});let l=0;c.sortable({axis:"y",handle:'[component="topic/pinned"]',items:'[component="category/topic"].pinned',start:function(){l=parseInt(c.find('[component="category/topic"].pinned').first().attr("data-index"),10)},update:function(w,R){const I=R.item.attr("data-tid"),B=c.find('[component="category/topic"].pinned');let N=0;B.each((K,U)=>{if($(U).attr("data-tid")===I)return N=K,!1}),socket.emit("topics.orderPinnedTopics",{tid:I,order:l+N},function(K){if(K)return e.error(K);B.each((U,Y)=>{$(Y).attr("data-index",l+U)})})}})})}return i}.apply(F,D),A!==void 0&&(S.exports=A)},39259:(S,F,d)=>{var D,A;D=[d(96349),d(49897),d(91749)],A=function(x,P,g){const E={};E.init=function(e,i){if(!e||!e.length)return;i=i||{},i.states=i.states||["watching","tracking","notwatching","ignoring"],i.template=i.template||"partials/category/filter-dropdown-left",g.fire("action:category.filter.options",{el:e,options:i}),x.init(e,i);let o=[],f=[];Array.isArray(i.selectedCids)?o=i.selectedCids.map(String):Array.isArray(ajaxify.data.selectedCids)&&(o=ajaxify.data.selectedCids.map(String)),f=o.slice(),e.on("hidden.bs.dropdown",function(){let t=f.length!==o.length;if(f.forEach(function(r,y){r!==o[y]&&(t=!0)}),f=o.slice(),t&&(i.updateButton?i.updateButton({el:e,changed:t,selectedCids:o.slice()}):i.updateButton!==!1&&T(e,o)),i.onHidden){i.onHidden({changed:t,selectedCids:o.slice()});return}if(t){let r=window.location.pathname;const y=utils.params();o.length?y.cid=o:delete y.cid,delete y.page,Object.keys(y).length&&(r+="?"+decodeURIComponent($.param(y))),ajaxify.go(r)}}),e.on("click",'[component="category/list"] [data-cid]',function(){const t=e.find('[component="category/list"]'),r=$(this),y=r.find("a").attr("href");if(y&&y!=="#"&&y.length)return;const s=r.attr("data-cid"),m=r.find('[component="category/select/icon"]');return s!=="all"?(o.includes(s)?o.splice(o.indexOf(s),1):o.push(s),o.sort(function(p,h){return p-h}),m.toggleClass("invisible"),t.find('[data-cid="all"] i').toggleClass("invisible",!!o.length)):(e.find('[component="category/select/icon"]').addClass("invisible"),t.find('[data-cid="all"] i').removeClass("invisible"),o=[]),i.selectedCids=o,i.onSelect&&i.onSelect({cid:s,selectedCids:o.slice()}),!1})};function T(e,i){i.length>1?o({icon:"fa-plus",name:"[[unread:multiple-categories-selected]]",bgColor:"#ddd"}):i.length===1?P.get(`/categories/${i[0]}`,{}).then(o):o();function o(f){app.parseAndTranslate("partials/category/filter-dropdown-content",{selectedCategory:f},function(t){e.find("button").replaceWith($("<div/>").html(t).find("button"))})}}return E}.apply(F,D),A!==void 0&&(S.exports=A)},96349:(S,F,d)=>{var D,A;D=[d(29930),d(89336),d(49897)],A=function(x,P,g){const E={};return E.init=function(T,e){let i=null;e=e||{},e.privilege=e.privilege||"topics:read",e.states=e.states||["watching","tracking","notwatching","ignoring"],e.cacheList=e.hasOwnProperty("cacheList")?e.cacheList:!0;let o=[];Array.isArray(e.localCategories)&&(o=e.localCategories.map(s=>({...s}))),e.selectedCids=e.selectedCids||ajaxify.data.selectedCids||[];const f=T.find('[component="category-selector-search"]');if(!f.length)return;const t=f.parent('[component="category/dropdown"]').length>0||f.parent('[component="category-selector"]').length>0;T.on("show.bs.dropdown",function(){t&&(T.find(".dropdown-toggle").css({visibility:"hidden"}),f.removeClass("hidden"),f.css({"z-index":T.find(".dropdown-toggle").css("z-index")+1}));function s(){const m=f.find("input").val();m.length>1||!m&&!i?r(m,function(p){i=e.cacheList&&(i||p),y(p)}):!m&&i&&y(i)}f.on("click",function(m){m.preventDefault(),m.stopPropagation()}),f.find("input").val("").on("keyup",utils.debounce(s,300)),s()}),T.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||f.find("input").focus()}),T.on("hide.bs.dropdown",function(){t&&(T.find(".dropdown-toggle").css({visibility:"inherit"}),f.addClass("hidden")),f.off("click"),f.find("input").off("keyup")});function r(s,m){g.get("/search/categories",{search:s,query:utils.params(),parentCid:e.parentCid||0,selectedCids:e.selectedCids,privilege:e.privilege,states:e.states,showLinks:e.showLinks},function(p,{categories:h}){if(p)return x.error(p);m(o.concat(h))})}function y(s){const m=e.selectedCids.map(String);s.forEach(function(p){p.selected=m.includes(String(p.cid))}),app.parseAndTranslate(e.template,{categoryItems:s.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(p){T.find('[component="category/list"]').html(p.find('[component="category/list"]').html()),T.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!s.length);const h=P.Dropdown.getInstance(T.find(".dropdown-toggle").get(0));h&&h.update()})}},E}.apply(F,D),A!==void 0&&(S.exports=A)},25955:(S,F,d)=>{var D,A;D=[d(91749),d(29930),d(89336)],A=function(x,P,g){const E={};E.init=function(e,i){if(!e||!e.length)return;i=i||{},i.template="partials/tags/filter-dropdown-left",x.fire("action:tag.filter.options",{el:e,options:i});const o=e.find('[component="tag/filter/search"]');i.selectedTags=i.selectedTags||ajaxify.data.selectedTags||[];let f=null,t=[],r=[];Array.isArray(i.selectedTags)?t=i.selectedTags.map(String):Array.isArray(ajaxify.data.selectedTags)&&(t=ajaxify.data.selectedTags.map(String)),r=t.slice();const y=o.parent('[component="tag/filter"]').length&&app.user.privileges["search:tags"];e.on("show.bs.dropdown",function(){y&&(e.find(".dropdown-toggle").css({visibility:"hidden"}),o.removeClass("hidden"),o.css({"z-index":e.find(".dropdown-toggle").css("z-index")+1}));function p(){const h=o.find("input").val();h.length>1||!h&&!f?s(h,function(C){f=f||C,m(C)}):!h&&f&&m(f)}o.on("click",function(h){h.preventDefault(),h.stopPropagation()}),o.find("input").val("").on("keyup",utils.debounce(p,300)),p()}),e.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||o.find("input").focus()}),e.on("hidden.bs.dropdown",function(){y&&(e.find(".dropdown-toggle").css({visibility:"inherit"}),o.addClass("hidden")),o.off("click"),o.find("input").off("keyup");let p=r.length!==t.length;if(r.forEach(function(h,C){h!==t[C]&&(p=!0)}),r=t.slice(),p&&(i.updateButton?i.updateButton({el:e,changed:p,selectedTags:t.slice()}):i.updateButton!==!1&&T(e,t)),i.onHidden){i.onHidden({changed:p,selectedTags:t.slice()});return}if(p){let h=window.location.pathname;const C=utils.params();t.length?C.tag=t.length?t:void 0:delete C.tag,delete C.page,Object.keys(C).length&&(h+="?"+decodeURIComponent($.param(C))),ajaxify.go(h)}}),e.on("click",'[component="tag/filter/list"] [data-tag]',function(){const p=e.find('[component="tag/filter/list"]'),h=$(this),C=h.find("a").attr("href");if(C&&C!=="#"&&C.length)return;const L=h.attr("data-tag"),b=h.find('[component="tag/select/icon"]');return L!==""?(t.includes(L)?t.splice(t.indexOf(L),1):t.push(L),t.sort(function(j,M){return j-M}),b.toggleClass("invisible")):(e.find('[component="tag/select/icon"]').addClass("invisible"),t=[]),p.find('[data-tag=""] i').toggleClass("invisible",!!t.length),i.selectedTags=t,i.onSelect&&i.onSelect({tag:L,selectedTags:t.slice()}),!1});function s(p,h){let C=null;ajaxify.data.template.category?C=[ajaxify.data.cid]:Array.isArray(ajaxify.data.selectedCids)&&ajaxify.data.selectedCids.length&&(C=ajaxify.data.selectedCids),socket.emit("topics.tagFilterSearch",{query:p,cids:C},function(L,b){if(L)return P.error(L);h(b)})}function m(p){const h=i.selectedTags;p.forEach(function(C){C.selected=h.includes(C.valueEscaped)}),app.parseAndTranslate(i.template,{tagItems:p.slice(0,200),selectedTag:ajaxify.data.selectedTag},function(C){e.find('[component="tag/filter/list"]').html(C.find('[component="tag/filter/list"]').html());const L=g.Dropdown.getInstance(e.find(".dropdown-toggle").get(0));L&&L.update()})}};function T(e,i){i.length>0?o({label:i.join(", ")}):o();function o(f){app.parseAndTranslate("partials/tags/filter-dropdown-content",{selectedTag:f},function(t){e.find("button").replaceWith($("<div/>").html(t).find("button"))})}}return E}.apply(F,D),A!==void 0&&(S.exports=A)},47682:(S,F,d)=>{var D,A;D=[d(22410),d(60644),d(70550),d(39259),d(25955),d(71131),d(91749)],A=function(x,P,g,E,T,e,i){const o={};let f="",t=0,r=0,y,s;const m=[];$(window).on("action:ajaxify.start",function(){o.removeListeners(),e.removeListeners()}),o.init=function(u,a){s=p(),f=u,y=a||j,e.init(),o.watchForNewPosts();const v=["watching","tracking"];ajaxify.data.selectedFilter&&ajaxify.data.selectedFilter.filter==="watched"?v.push("notwatching","ignoring"):u!=="unread"&&v.push("notwatching"),E.init($('[component="category/dropdown"]'),{states:v}),T.init($('[component="tag/filter"]')),config.usePagination||x.init(o.loadMoreTopics),P.init(function(k,n){y(k,1,function(c,l){W(f,c.topics,ajaxify.data.showSelect,1,function(){n(),l()})})}),$("body").height()<=$(window).height()&&s.children().length>=20&&$("#load-more-btn").show(),$("#load-more-btn").on("click",function(){o.loadMoreTopics(1)}),i.fire("action:topics.loaded",{topics:ajaxify.data.topics})};function p(){return $('[component="category"]').filter(function(u,a){return!$(a).parents("[widget-area],[data-widget-area]").length})}o.watchForNewPosts=function(){r=0,t=0,o.removeListeners(),socket.on("event:new_topic",h),socket.on("event:new_post",C)},o.removeListeners=function(){socket.removeListener("event:new_topic",h),socket.removeListener("event:new_post",C)};function h(u){const a=ajaxify.data,v=a.selectedCids&&a.selectedCids.length&&a.selectedCids.indexOf(parseInt(u.cid,10))===-1,k=a.selectedFilter&&a.selectedFilter.filter==="watched",n=a.template.category&&parseInt(a.cid,10)!==parseInt(u.cid,10),c=!!(v||k||n||m.includes(u.tid));i.fire("filter:topicList.onNewTopic",{topic:u,preventAlert:c}).then(l=>{l.preventAlert||(u.scheduled&&u.tid&&m.push(u.tid),t+=1,L())})}function C(u){const a=u.posts[0];if(!a||!a.topic||a.topic.isFollowing)return;const v=ajaxify.data,k=parseInt(a.topic.mainPid,10)===parseInt(a.pid,10),n=v.selectedCids&&v.selectedCids.length&&v.selectedCids.indexOf(parseInt(a.topic.cid,10))===-1,c=v.selectedFilter&&v.selectedFilter.filter==="new",l=v.selectedFilter&&v.selectedFilter.filter==="watched"&&!a.topic.isFollowing,w=v.template.category&&parseInt(v.cid,10)!==parseInt(a.topic.cid,10),R=!!(k||n||c||l||w);i.fire("filter:topicList.onNewPost",{post:a,preventAlert:R}).then(I=>{I.preventAlert||(r+=1,L())})}function L(){(t>0||r>0)&&($("#new-topics-alert").removeClass("hide").fadeIn("slow"),$("#category-no-topics").addClass("hide"))}o.loadMoreTopics=function(u){if(!s.length||!s.children().length)return;const a=s.find('[component="category/topic"]'),v=u>0?a.last():a.first(),k=(parseInt(v.attr("data-index"),10)||0)+(u>0?1:0);!utils.isNumber(k)||k===0&&s.find('[component="category/topic"][data-index="0"]').length||y(k,u,function(n,c){W(f,n.topics,ajaxify.data.showSelect,u,c)})};function b(u,a){return Math.floor(u/config.topicsPerPage)+(a>0?1:0)}function j(u,a,v){v=v||function(){};const k=utils.params();k.page=b(u,a),x.loadMoreXhr(k,v)}function M(u){return u.filter(function(a){return!s.find('[component="category/topic"][data-tid="'+a.tid+'"]').length})}function W(u,a,v,k,n){if(!a||!a.length||(a=M(a),!a.length))return $("#load-more-btn").hide(),n();let c,l;const w=s.find('[component="category/topic"]');k>0&&a.length?c=w.last():k<0&&a.length&&(l=w.first());const R={topics:a,showSelect:v,template:{name:u}};R.template[u]=!0,i.fire("action:topics.loading",{topics:a,after:c,before:l}),app.parseAndTranslate(u,"topics",R,function(I){if(s.removeClass("hidden"),$("#category-no-topics").remove(),c&&c.length)I.insertAfter(c);else if(l&&l.length){const B=$(document).height(),N=$(window).scrollTop();I.insertBefore(l),$(window).scrollTop(N+($(document).height()-B))}else s.append(I);g.getSelectedTids().length||x.removeExtra(s.find('[component="category/topic"]'),k,Math.max(60,config.topicsPerPage*3)),I.find(".timeago").timeago(),i.fire("action:topics.loaded",{topics:a,template:u}),n()})}return o}.apply(F,D),A!==void 0&&(S.exports=A)},70550:(S,F,d)=>{var D,A;D=[d(52473)],A=function(x){const P={};let g,E;P.init=function(t){E=$('[component="category"]'),E.on("selectstart",'[component="topic/select"]',function(r){r.preventDefault()}),E.on("click",'[component="topic/select"]',function(r){const s=$(this).parents('[component="category/topic"]');if(r.shiftKey)return i(s.attr("data-tid")),g=s,!1;const m=s.hasClass("selected");T(s,!m),g=s,typeof t=="function"&&t()})};function T(t,r){const y=t.find('[component="topic/select"]');y.toggleClass("fa-check-square-o",r),y.toggleClass("fa-square-o",!r),y.parents('[component="category/topic"]').toggleClass("selected",r),e()}function e(){const t=$('[component="topic/selected/badge"]');if(t.length){const r=E.find('[component="category/topic"].selected').length;t.text(r>0?r:"")}}P.getSelectedTids=function(){const t=[];return E&&E.find('[component="category/topic"].selected').each(function(){t.push($(this).attr("data-tid"))}),t},P.unselectAll=function(){E&&(E.find('[component="category/topic"].selected').removeClass("selected"),E.find('[component="topic/select"]').toggleClass("fa-check-square-o",!1).toggleClass("fa-square-o",!0),e())};function i(t){g||(g=$('[component="category/topic"]').first());const r=x.get("category/topic","tid",t).hasClass("selected"),y=f(t),s=f(g.attr("data-tid"));o(y,s,!r)}function o(t,r,y){if(t>r){const s=t;t=r,r=s}for(let s=t;s<=r;s+=1){const m=$('[component="category/topic"]').eq(s);T(m,y)}}function f(t){return x.get("category/topic","tid",t).index('[component="category/topic"]')}return P}.apply(F,D),A!==void 0&&(S.exports=A)}}]);
