"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[51831,99127,34271,69185,1091,49897],{49897:(w,m,o)=>{o.r(m),o.d(m,{del:()=>u,get:()=>a,head:()=>i,patch:()=>c,post:()=>r,put:()=>l});var y=o(91749),p=o.n(y),C=o(40027),v=o.n(C);const E=config.relative_path+"/api/v3";async function f(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:E+e.url,typeof n=="function"){d(e).then(t=>n(null,t),t=>n(t));return}try{return await d(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again.")return(0,C.confirm)("[[error:api.reauth-required]]",s=>{s&&ajaxify.go("login")});throw t}}async function d(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,y.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const t=await fetch(n,e),{headers:s}=t,h=s.get("content-type"),A=h&&h.startsWith("application/json");let g;if(e.method!=="head"&&(A?g=await t.json():g=await t.text()),!t.ok)throw g?new Error(A?g.status.message:g):new Error(t.statusText);return A&&g&&g.hasOwnProperty("status")&&g.hasOwnProperty("response")?g.response:g}function a(e,n,t){return f({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},t)}function i(e,n,t){return f({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},t)}function r(e,n,t){return f({url:e,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function c(e,n,t){return f({url:e,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function l(e,n,t){return f({url:e,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function u(e,n,t){return f({url:e,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}},39259:(w,m,o)=>{var y,p;y=[o(96349),o(49897),o(91749)],p=function(C,v,E){const f={};f.init=function(a,i){if(!a||!a.length)return;i=i||{},i.states=i.states||["watching","tracking","notwatching","ignoring"],i.template=i.template||"partials/category/filter-dropdown-left",E.fire("action:category.filter.options",{el:a,options:i}),C.init(a,i);let r=[],c=[];Array.isArray(i.selectedCids)?r=i.selectedCids.map(String):Array.isArray(ajaxify.data.selectedCids)&&(r=ajaxify.data.selectedCids.map(String)),c=r.slice(),a.on("hidden.bs.dropdown",function(){let l=c.length!==r.length;if(c.forEach(function(u,e){u!==r[e]&&(l=!0)}),c=r.slice(),l&&(i.updateButton?i.updateButton({el:a,changed:l,selectedCids:r.slice()}):i.updateButton!==!1&&d(a,r)),i.onHidden){i.onHidden({changed:l,selectedCids:r.slice()});return}if(l){let u=window.location.pathname;const e=utils.params();r.length?e.cid=r:delete e.cid,delete e.page,Object.keys(e).length&&(u+="?"+decodeURIComponent($.param(e))),ajaxify.go(u)}}),a.on("click",'[component="category/list"] [data-cid]',function(){const l=a.find('[component="category/list"]'),u=$(this),e=u.find("a").attr("href");if(e&&e!=="#"&&e.length)return;const n=u.attr("data-cid"),t=u.find('[component="category/select/icon"]');return n!=="all"?(r.includes(n)?r.splice(r.indexOf(n),1):r.push(n),r.sort(function(s,h){return s-h}),t.toggleClass("invisible"),l.find('[data-cid="all"] i').toggleClass("invisible",!!r.length)):(a.find('[component="category/select/icon"]').addClass("invisible"),l.find('[data-cid="all"] i').removeClass("invisible"),r=[]),i.selectedCids=r,i.onSelect&&i.onSelect({cid:n,selectedCids:r.slice()}),!1})};function d(a,i){i.length>1?r({icon:"fa-plus",name:"[[unread:multiple-categories-selected]]",bgColor:"#ddd"}):i.length===1?v.get(`/categories/${i[0]}`,{}).then(r):r();function r(c){app.parseAndTranslate("partials/category/filter-dropdown-content",{selectedCategory:c},function(l){a.find("button").replaceWith($("<div/>").html(l).find("button"))})}}return f}.apply(m,y),p!==void 0&&(w.exports=p)},96349:(w,m,o)=>{var y,p;y=[o(29930),o(89336),o(49897)],p=function(C,v,E){const f={};return f.init=function(d,a){let i=null;a=a||{},a.privilege=a.privilege||"topics:read",a.states=a.states||["watching","tracking","notwatching","ignoring"],a.cacheList=a.hasOwnProperty("cacheList")?a.cacheList:!0;let r=[];Array.isArray(a.localCategories)&&(r=a.localCategories.map(n=>({...n}))),a.selectedCids=a.selectedCids||ajaxify.data.selectedCids||[];const c=d.find('[component="category-selector-search"]');if(!c.length)return;const l=c.parent('[component="category/dropdown"]').length>0||c.parent('[component="category-selector"]').length>0;d.on("show.bs.dropdown",function(){l&&(d.find(".dropdown-toggle").css({visibility:"hidden"}),c.removeClass("hidden"),c.css({"z-index":d.find(".dropdown-toggle").css("z-index")+1}));function n(){const t=c.find("input").val();t.length>1||!t&&!i?u(t,function(s){i=a.cacheList&&(i||s),e(s)}):!t&&i&&e(i)}c.on("click",function(t){t.preventDefault(),t.stopPropagation()}),c.find("input").val("").on("keyup",utils.debounce(n,300)),n()}),d.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||c.find("input").focus()}),d.on("hide.bs.dropdown",function(){l&&(d.find(".dropdown-toggle").css({visibility:"inherit"}),c.addClass("hidden")),c.off("click"),c.find("input").off("keyup")});function u(n,t){E.get("/search/categories",{search:n,query:utils.params(),parentCid:a.parentCid||0,selectedCids:a.selectedCids,privilege:a.privilege,states:a.states,showLinks:a.showLinks},function(s,{categories:h}){if(s)return C.error(s);t(r.concat(h))})}function e(n){const t=a.selectedCids.map(String);n.forEach(function(s){s.selected=t.includes(String(s.cid))}),app.parseAndTranslate(a.template,{categoryItems:n.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(s){d.find('[component="category/list"]').html(s.find('[component="category/list"]').html()),d.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!n.length);const h=v.Dropdown.getInstance(d.find(".dropdown-toggle").get(0));h&&h.update()})}},f}.apply(m,y),p!==void 0&&(w.exports=p)}}]);
