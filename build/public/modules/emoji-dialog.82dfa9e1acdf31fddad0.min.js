(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[25150,86706,6232,74953,97650,86924],{26940:(D,S,d)=>{D.exports=d(94510)},89596:(D,S,d)=>{D.exports=d(62590)},86924:(D,S,d)=>{D.exports=d(77300)},46243:(D,S,d)=>{D.exports=d(69627)},41088:(D,S,d)=>{"use strict";var T;T=function(){const R={};return R.apply=function(P){$(P).on("mousewheel",function(u){const o=this.scrollTop,i=this.scrollHeight,e=Math.round(this.getBoundingClientRect().height);if(u.originalEvent.deltaY<0&&o===0||u.originalEvent.deltaY>0&&e+o>=i)return!1})},R}.call(S,d,S,D),T!==void 0&&(D.exports=T)},94510:(D,S,d)=>{"use strict";var T,R;T=[d(89596)],R=function(P){var u={};return u.insertIntoTextarea=function(o,i){var e={context:this,textarea:o,value:i,preventDefault:!1};if($(window).trigger("action:composer.insertIntoTextarea",e),!e.preventDefault){var r=$(e.textarea),a=r.val(),n=r.parents('[component="composer"]');r.val(a.slice(0,e.textarea.selectionStart)+e.value+a.slice(e.textarea.selectionStart)),P.render(n)}},u.replaceSelectionInTextareaWith=function(o,i){var e={context:this,textarea:o,value:i,preventDefault:!1};if($(window).trigger("action:composer.replaceSelectionInTextareaWith",e),!e.preventDefault){var r=$(e.textarea),a=r.val(),n=r.parents('[component="composer"]');r.val(a.slice(0,e.textarea.selectionStart)+e.value+a.slice(e.textarea.selectionEnd)),P.render(n)}},u.wrapSelectionInTextareaWith=function(o,i,e){var r={context:this,textarea:o,leading:i,trailing:e,preventDefault:!1};if($(window).trigger("action:composer.wrapSelectionInTextareaWith",r),!r.preventDefault){e===void 0&&(e=i);var a=$(o),n=a.val(),h=/^(\s*)([\s\S]*?)(\s*)$/.exec(n.slice(o.selectionStart,o.selectionEnd));return h[2]||(h=[null,"",n.slice(o.selectionStart,o.selectionEnd),""]),a.val(n.slice(0,o.selectionStart)+h[1]+i+h[2]+e+h[3]+n.slice(o.selectionEnd)),[h[1].length,h[3].length]}},u.updateTextareaSelection=function(o,i,e){var r={context:this,textarea:o,start:i,end:e,preventDefault:!1};$(window).trigger("action:composer.updateTextareaSelection",r),!r.preventDefault&&(o.setSelectionRange(r.start,r.end),$(r.textarea).focus())},u.getBlockData=function(o,i,e){var r=o.value;i=i.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");var a=new RegExp(i,"g"),n,h=[],l;for(r=r.split(`
`).reduce(function(p,t){return p!==null||(p=e<=t.length?t:null,p===null&&(e-=t.length+1)),p},null);(n=a.exec(r))!==null;)h.push(n.index);return l={in:!!(h.reduce(function(p,t){return e>=t+2&&(p+=1),p},0)%2),atEnd:h.reduce(function(p,t){return p||e===t},!1)},l.atEnd=l.in?l.atEnd:!1,l},u}.apply(S,T),R!==void 0&&(D.exports=R)},62590:(D,S,d)=>{"use strict";var T,R;T=[d(91749)],R=function(P){var u={};return u.render=function(o,i){if(i=i||function(){},!o.find(".preview-container").is(":visible"))return i();var e=o.find("textarea");socket.emit("plugins.composer.renderPreview",e.val(),function(r,a){r||(a=$("<div>"+a+"</div>"),a.find("img:not(.not-responsive)").addClass("img-fluid"),o.find(".preview").html(a),P.fire("action:composer.preview",{postContainer:o,preview:a}),i())})},u.matchScroll=function(o){if(o.find(".preview-container").is(":visible")){var i=o.find("textarea"),e=o.find(".preview");if(i.length&&e.length){var r=i[0].scrollHeight-i.height();if(r===0)return;var a=i.scrollTop()/r;e.scrollTop(Math.max(e[0].scrollHeight-e.height(),0)*a)}}},u.handleToggler=function(o){const i=o.get(0);u.env=utils.findBootstrapEnvironment();const e=["xs","sm"].includes(u.env),r=i.querySelector('.formatting-bar [data-action="preview"]'),a=r.querySelector(".show-text"),n=r.querySelector(".hide-text"),h=localStorage.getItem("composer:previewToggled"),l=config["composer-default"].hidePreviewOnOpen==="on";let p=!e&&(h===null&&!l||h==="true");const t=i.querySelector(".preview-container"),s=i.querySelector(".write-container");if(!r)return;function y(E){e?(t.classList.toggle("hide",!1),s.classList.toggle("maximized",!1),t.classList.toggle("d-none",!E),t.classList.toggle("d-flex",E),t.classList.toggle("w-100",E),s.classList.toggle("d-flex",!E),s.classList.toggle("d-none",E),s.classList.toggle("w-100",!E)):(t.classList.toggle("hide",!E),s.classList.toggle("w-50",E),s.classList.toggle("w-100",!E),localStorage.setItem("composer:previewToggled",E)),a.classList.toggle("hide",E),n.classList.toggle("hide",!E),E&&u.render(o),u.matchScroll(o)}u.toggle=y,r.addEventListener("click",E=>{E.button===0&&(p=!p,y(p))}),y(p)},u}.apply(S,T),R!==void 0&&(D.exports=R)},77300:(D,S,d)=>{var T,R;T=[d,S,d(17459),d(81335),d(26940),d(41088),d(46243)],R=function(P,u,o,i,e,r,a){"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.toggleForInsert=u.toggle=u.init=u.dialogActions=void 0;var n=$("html");u.dialogActions={open:function(b){return n.addClass("emoji-insert"),b.addClass("open"),b.appendTo(document.fullscreenElement||"body"),utils.isTouchDevice()||b.find(".emoji-dialog-search").focus(),setTimeout(function(){$(document).off("click",h).on("click",h)},0),b},close:function(b){return $(document).off("click",h),n.removeClass("emoji-insert"),b.removeClass("open")}};function h(b){var A=$("#emoji-dialog");!$(b.target).is(".emoji-dialog *")&&A.length&&u.dialogActions.close(A)}var l={people:10,nature:9,food:8,activity:7,travel:6,objects:5,symbols:4,flags:3,regional:2,modifier:1,other:0};config.emojiCustomFirst&&(l.custom=100);var p=o.Translator.create();function t(b,A){return b<A?-1:b>A?1:0}function s(b){Promise.all([$.getJSON("".concat(a.base,"/emoji/categories.json?").concat(a.buster)),$.getJSON("".concat(a.base,"/emoji/packs.json?").concat(a.buster)),new Promise(function(A){(0,a.init)(A)})]).then(function(A){var w=A[0],_=A[1],g=Object.keys(w).map(function(v){var f=w[v].map(function(c){return a.table[c]});return{name:v,emojis:f.map(function(c){return{name:c.name,html:(0,a.buildEmoji)(c,!0)}}).sort(function(c,m){return t(c.name,m.name)})}}).sort(function(v,f){var c=l[v.name]||0,m=l[f.name]||0;return m-c});return(0,i.render)("partials/emoji-dialog",{categories:g,packs:_})}).then(function(A){return p.translate(A)}).then(function(A){var w=$(A).appendTo(document.fullscreenElement||"body");w.find(".emoji-dialog-search").on("input",function(c){var m=c.target.value;if(!m){w.find(".emoji-dialog-search-results").addClass("hidden"),w.find(".nav-tabs .emoji-dialog-search-results").next().find("a").tab("show");return}var C=(0,a.search)(m).slice(0,100).map(function(I){return'<a class="emoji-link" name="'.concat(I.name,'" href="#">').concat((0,a.buildEmoji)(I,!1),"</a>")}).join(`
`);w.find(".tab-pane.emoji-dialog-search-results").html(C),w.find(".emoji-dialog-search-results").removeClass("hidden"),w.find(".nav-tabs .emoji-dialog-search-results a").tab("show"),w.find(".emoji-dialog-search").focus()});var _=w.find(".emoji-tabs .tab-content");function g(c){var m=_[0].getBoundingClientRect(),C=Math.ceil(m.width*m.height/(40*40));c.find(".emoji-link img.defer").filter(function(I,j){if(I<=C)return!0;var x=j.getBoundingClientRect();return x.right>m.left&&x.left<m.right&&x.bottom>m.top&&x.top<m.bottom}).removeClass("defer").each(function(I,j){var x=j.getAttribute("data-src");j.setAttribute("src",x)})}var v=w.find(".emoji-tabs .nav-tabs a").click(function(c){c.preventDefault(),$(c.target).tab("show")}).on("show.bs.tab",function(c){g($(c.target.getAttribute("href")))}).eq(1);setTimeout(function(){return v.trigger("show.bs.tab")},10),_.on("scroll",function(){g(_.find(".tab-pane.active"))}),(0,r.apply)(_[0]);var f=function(){return u.dialogActions.close(w)};$(window).on(["action:composer.discard","action:composer.submit","action:composer.minimize","action:chat.minimize","action:chat.closed"].join(" "),f),w.find(".close").on("click",f),b(w)}).catch(function(A){console.error("Failed to initialize emoji dialog",A)})}u.init=s;function y(b,A){function w(g){if(g.hasClass("open")){u.dialogActions.close(g);return}g.off("click").on("click",".emoji-link",function(c){c.preventDefault();var m=c.currentTarget.name;A(c,m,g)});var v=b?b.getBoundingClientRect():{top:window.innerHeight/3,left:window.innerWidth/3},f={bottom:"auto",top:"auto",right:"auto",left:"auto"};v.top>440?f.top="".concat(v.top-400,"px"):f.top="".concat(v.top+40,"px"),v.left<window.innerWidth/2?f.left="".concat(v.left+40,"px"):f.left="".concat(v.left-400,"px"),g.css(f),u.dialogActions.open(g)}var _=$("#emoji-dialog");_.length?w(_):s(w)}u.toggle=y;function E(b,A,w,_){var g;_&&_.target?g=$(_.target):g=$(b).parents(".composer-container").find('[data-format="emoji-add-emoji"]'),g=g[0],y(g,function(v,f){var c=":".concat(f,": "),m=b.selectionStart,C=b.selectionEnd,I=C+c.length,j=m===C?I:m;(0,e.insertIntoTextarea)(b,c),(0,e.updateTextareaSelection)(b,j,I),$(b).trigger("input")})}u.toggleForInsert=E}.apply(S,T),R!==void 0&&(D.exports=R)},69627:function(D,S,d){var T,R,P=this&&this.__awaiter||function(o,i,e,r){function a(n){return n instanceof e?n:new e(function(h){h(n)})}return new(e||(e=Promise))(function(n,h){function l(s){try{t(r.next(s))}catch(y){h(y)}}function p(s){try{t(r.throw(s))}catch(y){h(y)}}function t(s){s.done?n(s.value):a(s.value).then(l,p)}t((r=r.apply(o,i||[])).next())})},u=this&&this.__generator||function(o,i){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},r,a,n,h;return h={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function l(t){return function(s){return p([t,s])}}function p(t){if(r)throw new TypeError("Generator is already executing.");for(;h&&(h=0,t[0]&&(e=0)),e;)try{if(r=1,a&&(n=t[0]&2?a.return:t[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,t[1])).done)return n;switch(a=0,n&&(t=[t[0]&2,n.value]),t[0]){case 0:case 1:n=t;break;case 4:return e.label++,{value:t[1],done:!1};case 5:e.label++,a=t[1],t=[0];continue;case 7:t=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(t[0]===6||t[0]===2)){e=0;continue}if(t[0]===3&&(!n||t[1]>n[0]&&t[1]<n[3])){e.label=t[1];break}if(t[0]===6&&e.label<n[1]){e.label=n[1],n=t;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(t);break}n[2]&&e.ops.pop(),e.trys.pop();continue}t=i.call(o,e)}catch(s){t=[6,s],a=0}finally{r=n=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}};T=[d,S],R=function(o,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.init=i.strategy=i.search=i.table=i.buildEmoji=i.buster=i.base=void 0;var e="".concat(config.assetBaseUrl,"/plugins/nodebb-plugin-emoji");i.base=e;var r=config["cache-buster"];i.buster=r;function a(l,p){var t=":".concat(l.name,":"),s=p?" defer":"";return l.image?`<img
      `.concat(p?"data-":"",'src="').concat(e,"/emoji/").concat(l.pack,"/").concat(l.image,"?").concat(r,`"
      class="not-responsive emoji emoji-`).concat(l.pack," emoji--").concat(l.name," ").concat(s,`"
      title="`).concat(t,`"
      alt="`).concat(l.character,`"
    />`):`<span
    class="emoji-`.concat(l.pack," emoji--").concat(l.name,`"
    title="`).concat(t,`"
  ><span>`).concat(l.character,"</span></span>")}i.buildEmoji=a,i.strategy={match:/\B:([^\s\n:]+)$/,search:function(l,p){p((0,i.search)(l.toLowerCase().replace(/[_-]/g,"")).slice(0,10))},index:1,replace:function(l){return":".concat(l.name,": ")},template:function(l){return"".concat(a(l)," ").concat(l.name)},cache:!0};var n;function h(l){var p=this;return n=n||Promise.all([new Promise(function(t,s){d.e(30363).then(function(){var y=[d(89713)];t.apply(null,y)}.bind(this)).catch(s.bind(this))}),new Promise(function(t,s){d.e(95983).then(function(){var y=[d(30593)];t.apply(null,y)}.bind(this)).catch(s.bind(this))}),new Promise(function(t,s){Promise.all([d.e(23662),d.e(65285),d.e(88189)]).then(function(){var y=[d(449)];t.apply(null,y)}.bind(this)).catch(s.bind(this))}),$.getJSON("".concat(e,"/emoji/table.json?").concat(r))]).then(function(t){var s=t[0],y=t[1],E=t[2],b=t[3];i.table=b;var A=Object.keys(i.table).map(function(g){var v=i.table[g];return{name:g,aliases:v.aliases,keywords:v.keywords,character:v.character,image:v.image,pack:v.pack}});function w(g,v){for(var f=v.length,c=0;c<f;c+=1)if(s(g,v[c]))return v[c];return null}function _(g){function v(f,c){var m=c*(1+y(g,f));return f.startsWith(g)?m-2:m}return A.filter(function(f){if(s(g,f.name))return f.score=v(f.name,1),!0;var c=w(g,f.aliases);if(c)return f.score=v(c,3),!0;var m=w(g,f.keywords);return m?(f.score=v(m,7),!0):!1}).sort(function(f,c){return f.score-c.score}).sort(function(f,c){var m=+f.name.startsWith(g),C=+c.name.startsWith(g);return C-m})}i.search=_,E.addButtonDispatch("emoji-add-emoji",function(g,v,f,c){new Promise(function(m,C){d.e(86924).then(function(){var I=[d(86924)];m.apply(null,I)}.bind(this)).catch(C.bind(this))}).then(function(m){var C=m.toggleForInsert;return C(g,v,f,c)})})}).catch(function(t){return P(p,void 0,void 0,function(){var s,y;return u(this,function(E){switch(E.label){case 0:return s=Error("[[emoji:meta-load-failed]]"),console.error(s),[4,app.require("alerts")];case 1:throw y=E.sent(),y.error(s),t}})})}),l&&n.then(function(){return setTimeout(l,0)}),n}i.init=h}.apply(S,T),R!==void 0&&(D.exports=R)}}]);
