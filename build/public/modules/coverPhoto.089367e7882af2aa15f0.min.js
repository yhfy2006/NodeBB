(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[97082],{36684:(r,u,g)=>{"use strict";var l,f;l=[g(29930),g(18675)],f=function(c){const e={coverEl:null,saveFn:null};e.init=function(n,t,o,a){e.coverEl=n,e.saveFn=t,n.find(".upload").on("click",o),n.find(".resize").on("click",function(){i(n)}),n.find(".remove").on("click",a),n.on("dragover",e.onDragOver).on("drop",e.onDrop),n.find(".save").on("click",e.save),n.addClass("initialised")},e.onDragOver=function(n){n.stopPropagation(),n.preventDefault(),n.originalEvent.dataTransfer.dropEffect="copy"},e.onDrop=function(n){n.stopPropagation(),n.preventDefault();const t=n.originalEvent.dataTransfer.files,o=new FileReader;t.length&&t[0].type.match("image.*")&&(o.onload=function(a){e.coverEl.css("background-image","url("+a.target.result+")"),e.newCover=a.target.result},o.readAsDataURL(t[0]),i(e.coverEl))};function i(n){n.toggleClass("active",1).backgroundDraggable({axis:"y",units:"percent"}),c.alert({alert_id:"drag_start",title:"[[modules:cover.dragging-title]]",message:"[[modules:cover.dragging-message]]",timeout:5e3})}return e.save=function(){e.coverEl.addClass("saving"),e.saveFn(e.newCover||void 0,e.coverEl.css("background-position"),function(n){n?c.error(n):(e.coverEl.toggleClass("active",0),e.coverEl.backgroundDraggable("disable"),e.coverEl.off("dragover",e.onDragOver),e.coverEl.off("drop",e.onDrop),c.success("[[modules:cover.saved]]")),e.coverEl.removeClass("saving")})},e}.apply(u,l),f!==void 0&&(r.exports=f)},18675:()=>{(function(r){var u=r(window),g=function(e,i,n,t){if(arguments.length===3||t){if(n<e)return e;if(n>i)return i}return n},l=function(e){e.clientX=e.originalEvent.touches[0].clientX,e.clientY=e.originalEvent.touches[0].clientY},f=function(e){var i=(e.css("background-image").match(/^url\(['"]?(.*?)['"]?\)$/i)||[])[1];if(i){var n={width:0,height:0},t=new Image;return t.onload=function(){if(e.css("background-size")=="cover"){var o=e.innerWidth(),a=e.innerHeight(),h=o/a;imageAspectRatio=t.width/t.height,scale=1,imageAspectRatio>=h?scale=a/t.height:scale=o/t.width,n.width=t.width*scale,n.height=t.height*scale}else n.width=t.width,n.height=t.height},t.src=i,n}};function c(e,i){this.element=e,this.options=i,this.init()}c.prototype.init=function(){var e=r(this.element),i=(e.css("background-image").match(/^url\(['"]?(.*?)['"]?\)$/i)||[])[1],n=this.options;if(i){var t={width:0,height:0};(n.bound||n.units=="percent")&&(t=f(e)),e.on("mousedown.dbg touchstart.dbg",function(o){if(o.target===e[0]){if(o.preventDefault(),o.originalEvent.touches)l(o);else if(o.which!==1)return;var a=o.clientX,h=o.clientY,m=e.css("background-position").match(/(-?\d+).*?\s(-?\d+)/)||[],s=parseInt(m[1])||0,d=parseInt(m[2])||0;n.units=="percent"&&(s=Math.round(s/-200*t.width),d=Math.round(d/-200*t.height)),u.on("mousemove.dbg touchmove.dbg",function(v){v.preventDefault(),v.originalEvent.touches&&l(v);var p=v.clientX,b=v.clientY;n.units=="percent"?(s=n.axis==="y"?s:g(-t.width/2,0,s+p-a,n.bound),d=n.axis==="x"?d:g(-t.height/2,0,d+b-h,n.bound),e.css("background-position",s/t.width*-200+"% "+d/t.height*-200+"%")):(s=n.axis==="y"?s:g(e.innerWidth()-t.width,0,s+p-a,n.bound),d=n.axis==="x"?d:g(e.innerHeight()-t.height,0,d+b-h,n.bound),e.css("background-position",s+"px "+d+"px")),a=p,h=b}),u.on("mouseup.dbg touchend.dbg mouseleave.dbg",function(){n.done&&n.done(),u.off("mousemove.dbg touchmove.dbg"),u.off("mouseup.dbg touchend.dbg mouseleave.dbg")})}})}},c.prototype.disable=function(){var e=r(this.element);e.off("mousedown.dbg touchstart.dbg"),u.off("mousemove.dbg touchmove.dbg mouseup.dbg touchend.dbg mouseleave.dbg")},r.fn.backgroundDraggable=function(i){var i=i,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=r(this);if(typeof i>"u"||typeof i=="object"){i=r.extend({},r.fn.backgroundDraggable.defaults,i);var o=new c(this,i);t.data("dbg",o)}else if(typeof i=="string"&&t.data("dbg")){var o=t.data("dbg");c.prototype[i].apply(o,n)}})},r.fn.backgroundDraggable.defaults={bound:!0,axis:void 0,units:"pixels"}})(jQuery)}}]);
