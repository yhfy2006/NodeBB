"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[47282,99127,34271,1091,49897,6574],{49897:(b,m,o)=>{o.r(m),o.d(m,{del:()=>r,get:()=>a,head:()=>f,patch:()=>y,post:()=>d,put:()=>A});var g=o(91749),p=o.n(g),c=o(40027),O=o.n(c);const E=config.relative_path+"/api/v3";async function s(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:E+e.url,typeof n=="function"){i(e).then(t=>n(null,t),t=>n(t));return}try{return await i(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again.")return(0,c.confirm)("[[error:api.reauth-required]]",u=>{u&&ajaxify.go("login")});throw t}}async function i(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,g.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const t=await fetch(n,e),{headers:u}=t,v=u.get("content-type"),h=v&&v.startsWith("application/json");let l;if(e.method!=="head"&&(h?l=await t.json():l=await t.text()),!t.ok)throw l?new Error(h?l.status.message:l):new Error(t.statusText);return h&&l&&l.hasOwnProperty("status")&&l.hasOwnProperty("response")?l.response:l}function a(e,n,t){return s({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},t)}function f(e,n,t){return s({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},t)}function d(e,n,t){return s({url:e,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function y(e,n,t){return s({url:e,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function A(e,n,t){return s({url:e,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function r(e,n,t){return s({url:e,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}},6574:(b,m,o)=>{var g,p;g=[o(91749),o(52473),o(49897),o(29930)],p=function(c,O,E,s){const i={};let a,f,d;i.showFlagModal=function(r){app.parseAndTranslate("modals/flag",r,function(e){a=e,a.on("hidden.bs.modal",function(){a.remove()}),f=a.find("#flag-post-commit"),d=a.find("#flag-reason-custom"),a.on("click",'input[name="flag-reason"]',function(){$(this).attr("id")==="flag-reason-other"?(d.removeAttr("disabled"),d.val().length||f.attr("disabled",!0)):(d.attr("disabled",!0),f.removeAttr("disabled"))}),f.on("click",function(){const n=$('input[name="flag-reason"]:checked');let t=n.val();n.attr("id")==="flag-reason-other"&&(t=d.val()),y(r.type,r.id,t)}),a.on("click","#flag-reason-other",function(){d.focus()}),a.modal("show"),c.fire("action:flag.showModal",{modalEl:a,type:r.type,id:r.id}),a.find("#flag-reason-custom").on("keyup blur change",A)})},i.resolve=function(r){E.put(`/flags/${r}`,{state:"resolved"}).then(()=>{s.success("[[flags:resolved]]"),c.fire("action:flag.resolved",{flagId:r})}).catch(s.error)};function y(r,e,n){if(!r||!e||!n)return;const t={type:r,id:e,reason:n};E.post("/flags",t,function(u,v){if(u)return s.error(u);if(a.modal("hide"),s.success("[[flags:modal-submit-success]]"),r==="post"){const h=O.get("post","pid",e);h.find('[component="post/flag"]').addClass("hidden").parent().attr("hidden",""),h.find('[component="post/already-flagged"]').removeClass("hidden").parent().attr("hidden",null)}c.fire("action:flag.create",{flagId:v,data:t})})}function A(){a.find("#flag-reason-custom").val()?f.removeAttr("disabled"):f.attr("disabled",!0)}return i}.apply(m,g),p!==void 0&&(b.exports=p)}}]);
