"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[98463],{24187:(l,a,p)=>{var f,u;f=[p(64061)],u=function(){const n={};n.show=function(e,s){const t=e.hasOwnProperty("fileSize")&&e.fileSize!==void 0?parseInt(e.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:e.hasOwnProperty("showHelp")&&e.showHelp!==void 0?e.showHelp:!0,fileSize:t,title:e.title||"[[global:upload-file]]",description:e.description||"",button:e.button||"[[global:upload]]",accept:e.accept?e.accept.replace(/,/g,"&#44; "):""},function(r){r.modal("show"),r.on("hidden.bs.modal",function(){r.remove()});const i=r.find("#uploadForm");i.attr("action",e.route),i.find("#params").val(JSON.stringify(e.params)),r.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),i.submit()}),i.submit(function(){return b(r,t,s),!1})})},n.hideAlerts=function(e){$(e).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function b(e,s,t){o(e,"status","[[uploads:uploading-file]]"),e.find("#upload-progress-bar").css("width","0%"),e.find("#upload-progress-box").show().removeClass("hide");const r=e.find("#fileInput");if(!r.val())return o(e,"error","[[uploads:select-file-to-upload]]");if(!m(r[0],s))return o(e,"error","[[error:file-too-big, "+s+"]]");n.ajaxSubmit(e,t)}function o(e,s,t){n.hideAlerts(e),s==="error"&&e.find("#fileUploadSubmitBtn").removeClass("disabled"),t=t.replace(/&amp;#44/g,"&#44"),e.find("#alert-"+s).translateText(t).removeClass("hide")}n.ajaxSubmit=function(e,s){e.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(r){r=c(r),o(e,"error",r.responseJSON?.status?.message||r.responseJSON?.error||`[[error:upload-error-fallback, ${r.status} ${r.statusText}]]`)},uploadProgress:function(r,i,h,d){e.find("#upload-progress-bar").css("width",d+"%")},success:function(r){let i=c(r);r.hasOwnProperty("response")&&r.hasOwnProperty("status")&&r.status.code==="ok"&&(i=r.response.images),s(i[0].url),o(e,"success","[[uploads:upload-success]]"),setTimeout(function(){n.hideAlerts(e),e.modal("hide")},750)}})};function c(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return{error:"[[error:parse-error]]"}}return e}function m(e,s){return window.FileReader&&s?e.files[0].size<=s*1e3:!0}return n}.apply(a,f),u!==void 0&&(l.exports=u)}}]);
