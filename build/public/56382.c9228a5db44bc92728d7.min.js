(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[56382,98772,4347,68783],{92762:(y,_,g)=>{y.exports=g(94252)},72573:(y,_,g)=>{y.exports=g(59367)},52543:(y,_,g)=>{y.exports=g(28721)},94252:(y,_)=>{"use strict";var g,b;g=[],b=function(){const h={};return h.showAlert=async function(p,m){const v=p.find('[component="composer/post-queue/alert"]');if(!config.postQueue||app.user.isAdmin||app.user.isGlobalMod||app.user.isMod){v.remove();return}const x=await socket.emit("plugins.composer.shouldQueue",{postData:m});v.toggleClass("show",x),v.toggleClass("pe-none",!x)},h.onChangeCategory=async function(p,m){config.postQueue&&h.showAlert(p,m)},h}.apply(_,g),b!==void 0&&(y.exports=b)},59367:(y,_,g)=>{"use strict";var b,h;b=[g(81335),g(40027),g(29930),g(17459)],h=function(p,m,v,x){const f={},n={timestamp:0,open:!1,edit:!1,posts:{}};let A=[],i,r,e,l;const o={el:null,defaultText:"",activeText:""},a={el:null,icon:null,defaultText:"",activeText:""};let s,u;$(window).on("action:composer.activate",W),f.init=function(t,c){n.timestamp=0,n.posts=c,x.translateKeys(["[[topic:composer.post-later]]","[[modules:composer.change-schedule-date]]"]).then(d=>{o.defaultText=d[0],o.activeText=d[1]}),A=t[0].querySelectorAll(".display-scheduler"),i=t[0].querySelectorAll(".display-scheduler i"),o.el=t[0].querySelector(".dropdown-item.display-scheduler"),r=t[0].querySelector(".dropdown-item.cancel-scheduling"),e=t.find('[component="composer/submit/container"]'),l=t.find('[component="composer/submit/options/container"]'),a.el=t[0].querySelector(".composer-submit:not(.btn-sm)"),a.icon=a.el.querySelector("i"),a.defaultText=a.el.lastChild.textContent,a.activeText=a.el.getAttribute("data-text-variant"),r.addEventListener("click",k),A.forEach(d=>d.addEventListener("click",T))},f.getTimestamp=function(){return!f.isActive()||isNaN(n.timestamp)?0:n.timestamp},f.isActive=function(){return n.timestamp>0},f.isOpen=function(){return n.open},f.reset=function(){n.timestamp=0},f.onChangeCategory=function(t){O(t.privileges["topics:schedule"]),E(!1);const c=t.privileges["topics:schedule"]||l.attr("data-submit-options")>0;e.find(".composer-submit").toggleClass("rounded-1",!c),l.toggleClass("hidden",!c),f.reset()};async function T(){const t=await p.render("modals/topic-scheduler");m.dialog({message:t,title:"[[modules:composer.schedule-for]]",className:"topic-scheduler",onShown:w,onHidden:C,onEscape:!0,buttons:{cancel:{label:n.timestamp?"[[modules:composer.cancel-scheduling]]":"[[modules:bootbox.cancel]]",className:(n.timestamp?"btn-warning":"btn-outline-secondary")+(n.edit?" hidden":""),callback:k},set:{label:"[[modules:composer.set-schedule-date]]",className:"btn-primary",callback:L}}})}function w(t){n.open=!0;const c=t.target.querySelector(".datetime-picker");s=c.querySelector('input[type="date"]'),u=c.querySelector('input[type="time"]'),I()}function C(){n.open=!1}function W(t,{post_uuid:c}){n.edit=!1;const d=n.posts[c];d&&d.isMain&&d.timestamp>Date.now()&&(n.timestamp=d.timestamp,n.edit=!0,E())}function I(){const t=new Date,c=new Date(t.getTime()-t.getTimezoneOffset()*6e4).toJSON();if(s.setAttribute("min",c.slice(0,10)),u.setAttribute("min",c.slice(11,-8)),f.isActive()){const d=new Date(n.timestamp-t.getTimezoneOffset()*6e4).toJSON();s.value=d.slice(0,10),u.value=d.slice(11,-8)}}function L(){const t=s.value&&u.value,c=new Date(`${s.value} ${u.value}`).getTime();if(!t||isNaN(c)||c<Date.now()){n.timestamp=0;const d=c<Date.now()?"[[error:scheduling-to-past]]":"[[error:invalid-schedule-date]]";return v.alert({type:"danger",timeout:3e3,title:"",alert_id:"post_error",message:d}),!1}n.timestamp||E(!0),n.timestamp=c}function k(){n.timestamp&&(E(!1),n.timestamp=0)}function E(t=!0){i.forEach(c=>c.classList.toggle("active",t)),a.icon&&(a.icon.classList.toggle("fa-check",!t),a.icon.classList.toggle("fa-clock-o",t)),o.el&&(o.el.textContent=t?o.activeText:o.defaultText,r.classList.toggle("hidden",!t)),a.el.lastChild.textContent=t?a.activeText:a.defaultText}function O(t){A.forEach(c=>c.classList.toggle("hidden",!t))}return f}.apply(_,b),h!==void 0&&(y.exports=h)},28721:(y,_,g)=>{"use strict";var b,h;b=[g(29930)],h=function(p){var m={},v,x;m.init=function(i,r){var e=i.find(".tags");if(e.length){v=ajaxify.data.hasOwnProperty("minTags")?ajaxify.data.minTags:config.minimumTagsPerTopic,x=ajaxify.data.hasOwnProperty("maxTags")?ajaxify.data.maxTags:config.maximumTagsPerTopic,e.tagsinput({tagClass:"badge bg-info rounded-1",confirmKeys:[13,44],trimValue:!0});var l=i.find(".bootstrap-tagsinput input");f(i,r,ajaxify.data),app.loadJQueryUI(function(){l.autocomplete({delay:100,position:{my:"left bottom",at:"left top",collision:"flip"},appendTo:i.find(".bootstrap-tagsinput"),open:function(){$(this).autocomplete("widget").css("z-index",2e4)},source:function(s,u){socket.emit("topics.autocompleteTags",{query:s.term,cid:r.cid},function(T,w){if(T)return p.error(T);w&&u(w),$(".ui-autocomplete a").attr("data-ajaxify","false")})},select:function(){n(l)}}),A(r.tags,e),e.on("beforeItemAdd",function(s){var u=x&&x<=m.getTags(i.attr("data-uuid")).length,T=utils.cleanUpTag(s.item,config.maximumTagLength),w=T!==s.item;if(s.cancel=w||s.item.length<config.minimumTagLength||s.item.length>config.maximumTagLength||u,s.item.length<config.minimumTagLength)return p.error("[[error:tag-too-short, "+config.minimumTagLength+"]]");if(s.item.length>config.maximumTagLength)return p.error("[[error:tag-too-long, "+config.maximumTagLength+"]]");if(u)return p.error("[[error:too-many-tags, "+x+"]]");w&&e.tagsinput("add",T)});var o=!1,a=!1;e.on("itemRemoved",function(s){if(a){a=!1;return}s.item&&socket.emit("topics.canRemoveTag",{tag:s.item},function(u,T){if(u)return p.error(u);T||(p.error("[[error:cant-remove-system-tag]]"),o=!0,e.tagsinput("add",s.item))})}),e.on("itemAdded",function(s){if(o){o=!1;return}var u=r.hasOwnProperty("cid")?r.cid:ajaxify.data.cid;socket.emit("topics.isTagAllowed",{tag:s.item,cid:u||0},function(T,w){if(T)return p.error(T);if(!w)return a=!0,e.tagsinput("remove",s.item);$(window).trigger("action:tag.added",{cid:u,tagEl:e,tag:s.item}),l.length&&l.autocomplete("close")})})}),l.attr("tabIndex",e.attr("tabIndex")),l.on("blur",function(){n(l)}),$('[component="composer/tag/dropdown"]').on("click","li",function(){var o=$(this).attr("data-tag");return o&&A([o],e),!1})}},m.isEnoughTags=function(i){return m.getTags(i).length>=v},m.minTagCount=function(){return v},m.onChangeCategory=function(i,r,e,l){var o=i.find('[component="composer/tag/dropdown"]');o.length&&(f(i,r,l),o.toggleClass("hidden",!l.tagWhitelist||!l.tagWhitelist.length),l.tagWhitelist&&app.parseAndTranslate("composer","tagWhitelist",{tagWhitelist:l.tagWhitelist},function(a){o.find(".dropdown-menu").html(a)}))};function f(i,r,e){var l=i.find(".tags"),o=i.find(".bootstrap-tagsinput input");o.length&&(e.hasOwnProperty("minTags")&&(v=e.minTags),e.hasOwnProperty("maxTags")&&(x=e.maxTags),e.tagWhitelist&&e.tagWhitelist.length?(o.attr("readonly",""),o.attr("placeholder",""),l.tagsinput("items").slice().forEach(function(a){e.tagWhitelist.indexOf(a)===-1&&l.tagsinput("remove",a)})):(o.removeAttr("readonly"),o.attr("placeholder",i.find("input.tags").attr("placeholder"))),i.find(".tags-container").toggleClass("haswhitelist",!!(e.tagWhitelist&&e.tagWhitelist.length)),i.find(".tags-container").toggleClass("hidden",e.privileges&&e.privileges.hasOwnProperty("topics:tag")&&!e.privileges["topics:tag"]||x===0&&!r&&!r.tags&&!r.tags.length),e.privileges&&e.privileges.hasOwnProperty("topics:tag")&&!e.privileges["topics:tag"]&&l.tagsinput("removeAll"),$(window).trigger("action:tag.toggleInput",{postContainer:i,tagWhitelist:e.tagWhitelist,tagsInput:o}))}function n(i){var r=jQuery.Event("keypress");r.which=13,r.keyCode=13,setTimeout(function(){i.trigger(r)},100)}function A(i,r){if(i&&i.length)for(var e=0;e<i.length;++e)r.tagsinput("add",i[e])}return m.getTags=function(i){return $('.composer[data-uuid="'+i+'"] .tags').tagsinput("items")},m}.apply(_,b),h!==void 0&&(y.exports=h)}}]);
